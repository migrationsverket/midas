import{d as Y,$ as ce,a as se}from"./utils-CNuNn3SH.js";import{r as fe}from"./index-BioRXBMu.js";import{r as P,c as de,e as ue}from"./iframe-oSJ7vU37.js";import{A as pe,c as me}from"./useFocusRing-CI3WD0pn.js";import{f as q}from"./Button--BVoLS35.js";import{$ as K}from"./useResizeObserver-BmiWR_Gj.js";import{$ as ge}from"./useControlledState-Cm_RGzvR.js";function Oe(t,e=!0){let[l,n]=P.useState(!0),o=l&&e;return Y(()=>{if(o&&t.current&&"getAnimations"in t.current)for(let r of t.current.getAnimations())r instanceof CSSTransition&&r.cancel()},[t,o]),le(t,o,P.useCallback(()=>n(!1),[])),o}function Ne(t,e){let[l,n]=P.useState(e?"open":"closed");switch(l){case"open":e||n("exiting");break;case"closed":case"exiting":e&&n("open");break}let o=l==="exiting";return le(t,o,P.useCallback(()=>{n(r=>r==="exiting"?"closed":r)},[])),o}function le(t,e,l){Y(()=>{if(e&&t.current){if(!("getAnimations"in t.current)){l();return}let n=t.current.getAnimations();if(n.length===0){l();return}let o=!1;return Promise.all(n.map(r=>r.finished)).then(()=>{o||fe.flushSync(()=>{l()})}).catch(()=>{}),()=>{o=!0}}},[t,e,l])}const z={top:"top",bottom:"top",left:"left",right:"left"},Z={top:"bottom",bottom:"top",left:"right",right:"left"},ve={top:"left",left:"top"},J={top:"height",left:"width"},oe={width:"totalWidth",height:"totalHeight"},X={};let C=typeof document<"u"?window.visualViewport:null;function Q(t){let e=0,l=0,n=0,o=0,r=0,c=0,i={};var $;let f=(($=C==null?void 0:C.scale)!==null&&$!==void 0?$:1)>1;if(t.tagName==="BODY"){let d=document.documentElement;n=d.clientWidth,o=d.clientHeight;var u;e=(u=C==null?void 0:C.width)!==null&&u!==void 0?u:n;var v;l=(v=C==null?void 0:C.height)!==null&&v!==void 0?v:o,i.top=d.scrollTop||t.scrollTop,i.left=d.scrollLeft||t.scrollLeft,C&&(r=C.offsetTop,c=C.offsetLeft)}else({width:e,height:l,top:r,left:c}=B(t)),i.top=t.scrollTop,i.left=t.scrollLeft,n=e,o=l;if(pe()&&(t.tagName==="BODY"||t.tagName==="HTML")&&f){i.top=0,i.left=0;var p;r=(p=C==null?void 0:C.pageTop)!==null&&p!==void 0?p:0;var a;c=(a=C==null?void 0:C.pageLeft)!==null&&a!==void 0?a:0}return{width:e,height:l,totalWidth:n,totalHeight:o,scroll:i,top:r,left:c}}function $e(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function W(t,e,l,n,o,r,c){var i;let $=(i=o.scroll[t])!==null&&i!==void 0?i:0,f=n[J[t]],u=n.scroll[z[t]]+r,v=f+n.scroll[z[t]]-r,p=e-$+c[t]-n[z[t]],a=e-$+l+c[t]-n[z[t]];return p<u?u-p:a>v?Math.max(v-a,u-p):0}function he(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function D(t){if(X[t])return X[t];let[e,l]=t.split(" "),n=z[e]||"right",o=ve[n];z[l]||(l="center");let r=J[n],c=J[o];return X[t]={placement:e,crossPlacement:l,axis:n,crossAxis:o,size:r,crossSize:c},X[t]}function G(t,e,l,n,o,r,c,i,$,f){let{placement:u,crossPlacement:v,axis:p,crossAxis:a,size:d,crossSize:h}=n,s={};var m;s[a]=(m=t[a])!==null&&m!==void 0?m:0;var g,w,H,S;v==="center"?s[a]+=(((g=t[h])!==null&&g!==void 0?g:0)-((w=l[h])!==null&&w!==void 0?w:0))/2:v!==a&&(s[a]+=((H=t[h])!==null&&H!==void 0?H:0)-((S=l[h])!==null&&S!==void 0?S:0)),s[a]+=r;const x=t[a]-l[h]+$+f,y=t[a]+t[h]-$-f;if(s[a]=q(s[a],x,y),u===p){const I=i?c[d]:e[oe[d]];s[Z[p]]=Math.floor(I-t[p]+o)}else s[p]=Math.floor(t[p]+t[d]+o);return s}function xe(t,e,l,n,o,r,c,i){const $=n?l.height:e[oe.height];var f;let u=t.top!=null?l.top+t.top:l.top+($-((f=t.bottom)!==null&&f!==void 0?f:0)-c);var v,p,a,d,h,s;let m=i!=="top"?Math.max(0,e.height+e.top+((v=e.scroll.top)!==null&&v!==void 0?v:0)-u-(((p=o.top)!==null&&p!==void 0?p:0)+((a=o.bottom)!==null&&a!==void 0?a:0)+r)):Math.max(0,u+c-(e.top+((d=e.scroll.top)!==null&&d!==void 0?d:0))-(((h=o.top)!==null&&h!==void 0?h:0)+((s=o.bottom)!==null&&s!==void 0?s:0)+r));return Math.min(e.height-r*2,m)}function V(t,e,l,n,o,r){let{placement:c,axis:i,size:$}=r;var f,u;if(c===i)return Math.max(0,l[i]-t[i]-((f=t.scroll[i])!==null&&f!==void 0?f:0)+e[i]-((u=n[i])!==null&&u!==void 0?u:0)-n[Z[i]]-o);var v;return Math.max(0,t[$]+t[i]+t.scroll[i]-e[i]-l[i]-l[$]-((v=n[i])!==null&&v!==void 0?v:0)-n[Z[i]]-o)}function be(t,e,l,n,o,r,c,i,$,f,u,v,p,a,d,h){let s=D(t),{size:m,crossAxis:g,crossSize:w,placement:H,crossPlacement:S}=s,x=G(e,i,l,s,u,v,f,p,d,h),y=u,I=V(i,f,e,o,r+u,s);if(c&&n[m]>I){let U=D(`${Z[H]} ${S}`),ae=G(e,i,l,U,u,v,f,p,d,h);V(i,f,e,o,r+u,U)>I&&(s=U,x=ae,y=u)}let _="bottom";s.axis==="top"?s.placement==="top"?_="top":s.placement==="bottom"&&(_="bottom"):s.crossAxis==="top"&&(s.crossPlacement==="top"?_="bottom":s.crossPlacement==="bottom"&&(_="top"));let E=W(g,x[g],l[w],i,$,r,f);x[g]+=E;let T=xe(x,i,f,p,o,r,l.height,_);a&&a<T&&(T=a),l.height=Math.min(l.height,T),x=G(e,i,l,s,y,v,f,p,d,h),E=W(g,x[g],l[w],i,$,r,f),x[g]+=E;let R={},k=e[g]+.5*e[w]-x[g]-o[z[g]];const A=d/2+h;var O,N,M,L;const F=z[g]==="left"?((O=o.left)!==null&&O!==void 0?O:0)+((N=o.right)!==null&&N!==void 0?N:0):((M=o.top)!==null&&M!==void 0?M:0)+((L=o.bottom)!==null&&L!==void 0?L:0),j=l[w]-F-d/2-h,ne=e[g]+d/2-(x[g]+o[z[g]]),re=e[g]+e[w]-d/2-(x[g]+o[z[g]]),ie=q(k,ne,re);return R[g]=q(ie,A,j),{position:x,maxHeight:T,arrowOffsetLeft:R.left,arrowOffsetTop:R.top,placement:s.placement}}function Ee(t){let{placement:e,targetNode:l,overlayNode:n,scrollNode:o,padding:r,shouldFlip:c,boundaryElement:i,offset:$,crossOffset:f,maxHeight:u,arrowSize:v=0,arrowBoundaryOffset:p=0}=t,a=n instanceof HTMLElement?we(n):document.documentElement,d=a===document.documentElement;const h=window.getComputedStyle(a).position;let s=!!h&&h!=="static",m=d?B(l):ee(l,a);if(!d){let{marginTop:R,marginLeft:k}=window.getComputedStyle(l);m.top+=parseInt(R,10)||0,m.left+=parseInt(k,10)||0}let g=B(n),w=he(n);var H,S;g.width+=((H=w.left)!==null&&H!==void 0?H:0)+((S=w.right)!==null&&S!==void 0?S:0);var x,y;g.height+=((x=w.top)!==null&&x!==void 0?x:0)+((y=w.bottom)!==null&&y!==void 0?y:0);let I=$e(o),_=Q(i),E=Q(a),T=i.tagName==="BODY"?B(a):ee(a,i);return a.tagName==="HTML"&&i.tagName==="BODY"&&(E.scroll.top=0,E.scroll.left=0),be(e,m,g,I,w,r,c,_,E,T,$,f,s,u,v,p)}function B(t){let{top:e,left:l,width:n,height:o}=t.getBoundingClientRect(),{scrollTop:r,scrollLeft:c,clientTop:i,clientLeft:$}=document.documentElement;return{top:e+r-i,left:l+c-$,width:n,height:o}}function ee(t,e){let l=window.getComputedStyle(t),n;if(l.position==="fixed"){let{top:o,left:r,width:c,height:i}=t.getBoundingClientRect();n={top:o,left:r,width:c,height:i}}else{n=B(t);let o=B(e),r=window.getComputedStyle(e);o.top+=(parseInt(r.borderTopWidth,10)||0)-e.scrollTop,o.left+=(parseInt(r.borderLeftWidth,10)||0)-e.scrollLeft,n.top-=o.top,n.left-=o.left}return n.top-=parseInt(l.marginTop,10)||0,n.left-=parseInt(l.marginLeft,10)||0,n}function we(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!te(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!te(e);)e=e.parentElement;return e||document.documentElement}function te(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const Ce=new WeakMap;function Pe(t){let{triggerRef:e,isOpen:l,onClose:n}=t;P.useEffect(()=>{if(!l||n===null)return;let o=r=>{let c=r.target;if(!e.current||c instanceof Node&&!c.contains(e.current)||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;let i=n||Ce.get(e.current);i&&i()};return window.addEventListener("scroll",o,!0),()=>{window.removeEventListener("scroll",o,!0)}},[l,n,e])}let b=typeof document<"u"?window.visualViewport:null;function Fe(t){let{direction:e}=de(),{arrowSize:l=0,targetRef:n,overlayRef:o,scrollRef:r=o,placement:c="bottom",containerPadding:i=12,shouldFlip:$=!0,boundaryElement:f=typeof document<"u"?document.body:null,offset:u=0,crossOffset:v=0,shouldUpdatePosition:p=!0,isOpen:a=!0,onClose:d,maxHeight:h,arrowBoundaryOffset:s=0}=t,[m,g]=P.useState(null),w=[p,c,o.current,n.current,r.current,i,$,f,u,v,a,e,h,s,l],H=P.useRef(b==null?void 0:b.scale);P.useEffect(()=>{a&&(H.current=b==null?void 0:b.scale)},[a]);let S=P.useCallback(()=>{if(p===!1||!a||!o.current||!n.current||!f||(b==null?void 0:b.scale)!==H.current)return;let E=null;if(r.current&&r.current.contains(document.activeElement)){var T;let L=(T=document.activeElement)===null||T===void 0?void 0:T.getBoundingClientRect(),F=r.current.getBoundingClientRect();var R;if(E={type:"top",offset:((R=L==null?void 0:L.top)!==null&&R!==void 0?R:0)-F.top},E.offset>F.height/2){E.type="bottom";var k;E.offset=((k=L==null?void 0:L.bottom)!==null&&k!==void 0?k:0)-F.bottom}}let A=o.current;if(!h&&o.current){var O;A.style.top="0px",A.style.bottom="";var N;A.style.maxHeight=((N=(O=window.visualViewport)===null||O===void 0?void 0:O.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let M=Ee({placement:Le(c,e),overlayNode:o.current,targetNode:n.current,scrollNode:r.current||o.current,padding:i,shouldFlip:$,boundaryElement:f,offset:u,crossOffset:v,maxHeight:h,arrowSize:l,arrowBoundaryOffset:s});if(M.position){if(A.style.top="",A.style.bottom="",A.style.left="",A.style.right="",Object.keys(M.position).forEach(L=>A.style[L]=M.position[L]+"px"),A.style.maxHeight=M.maxHeight!=null?M.maxHeight+"px":"",E&&document.activeElement&&r.current){let L=document.activeElement.getBoundingClientRect(),F=r.current.getBoundingClientRect(),j=L[E.type]-F[E.type];r.current.scrollTop+=j-E.offset}g(M)}},w);Y(S,w),Se(S),K({ref:o,onResize:S}),K({ref:n,onResize:S});let x=P.useRef(!1);Y(()=>{let E,T=()=>{x.current=!0,clearTimeout(E),E=setTimeout(()=>{x.current=!1},500),S()},R=()=>{x.current&&T()};return b==null||b.addEventListener("resize",T),b==null||b.addEventListener("scroll",R),()=>{b==null||b.removeEventListener("resize",T),b==null||b.removeEventListener("scroll",R)}},[S]);let y=P.useCallback(()=>{x.current||d==null||d()},[d,x]);Pe({triggerRef:n,isOpen:a,onClose:d&&y});var I,_;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...m==null?void 0:m.position,maxHeight:(I=m==null?void 0:m.maxHeight)!==null&&I!==void 0?I:"100vh"}},placement:(_=m==null?void 0:m.placement)!==null&&_!==void 0?_:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:m==null?void 0:m.arrowOffsetLeft,top:m==null?void 0:m.arrowOffsetTop}},updatePosition:S}}function Se(t){Y(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function Le(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}const Te=P.createContext({});function Be(){var t;return(t=P.useContext(Te))!==null&&t!==void 0?t:{}}function Ye(t){let[e,l]=ge(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const n=P.useCallback(()=>{l(!0)},[l]),o=P.useCallback(()=>{l(!1)},[l]),r=P.useCallback(()=>{l(!e)},[l,e]);return{isOpen:e,setOpen:l,open:n,close:o,toggle:r}}const He=P.createContext({placement:"bottom"}),Xe=P.forwardRef(function(e,l){[e,l]=ce(e,l,He);let n=e.placement,o={position:"absolute",transform:n==="top"||n==="bottom"?"translateX(-50%)":"translateY(-50%)"};n!=null&&(o[n]="100%");let r=se({...e,defaultClassName:"react-aria-OverlayArrow",values:{placement:n}});r.style&&Object.keys(r.style).forEach(i=>r.style[i]===void 0&&delete r.style[i]);let c=me(e);return ue.createElement("div",{...c,...r,style:{...o,...r.style},ref:l,"data-placement":n})});export{Be as $,Ye as a,Ne as b,Fe as c,Oe as d,He as e,Xe as f,Ce as g};
