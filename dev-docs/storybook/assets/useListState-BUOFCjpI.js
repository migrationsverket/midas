import{$ as M,a as x,b as m}from"./SelectionManager-KcAQnQDa.js";import{r as f}from"./iframe-CJt1zD7T.js";class ${*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(l){let e=this.keyMap.get(l);var t;return e&&(t=e.prevKey)!==null&&t!==void 0?t:null}getKeyAfter(l){let e=this.keyMap.get(l);var t;return e&&(t=e.nextKey)!==null&&t!==void 0?t:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(l){var e;return(e=this.keyMap.get(l))!==null&&e!==void 0?e:null}at(l){const e=[...this.getKeys()];return this.getItem(e[l])}getChildren(l){let e=this.keyMap.get(l);return(e==null?void 0:e.childNodes)||[]}constructor(l){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=l;let e=n=>{if(this.keyMap.set(n.key,n),n.childNodes&&n.type==="section")for(let o of n.childNodes)e(o)};for(let n of l)e(n);let t=null,y=0;for(let[n,o]of this.keyMap)t?(t.nextKey=n,o.prevKey=t.key):(this.firstKey=n,o.prevKey=void 0),o.type==="item"&&(o.index=y++),t=o,t.nextKey=void 0;var s;this.lastKey=(s=t==null?void 0:t.key)!==null&&s!==void 0?s:null}}function C(i){let{filter:l,layoutDelegate:e}=i,t=M(i),y=f.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),s=f.useCallback(K=>l?new $(l(K)):new $(K),[l]),n=f.useMemo(()=>({suppressTextValueWarning:i.suppressTextValueWarning}),[i.suppressTextValueWarning]),o=x(i,s,n),v=f.useMemo(()=>new m(o,t,{layoutDelegate:e}),[o,t,e]);return k(o,v),{collection:o,disabledKeys:y,selectionManager:v}}function D(i,l){let e=f.useMemo(()=>l?i.collection.UNSTABLE_filter(l):i.collection,[i.collection,l]),t=i.selectionManager.withCollection(e);return k(e,t),{collection:e,selectionManager:t,disabledKeys:i.disabledKeys}}function k(i,l){const e=f.useRef(null);f.useEffect(()=>{if(l.focusedKey!=null&&!i.getItem(l.focusedKey)&&e.current){const u=e.current.getItem(l.focusedKey),h=[...e.current.getKeys()].map(c=>{const r=e.current.getItem(c);return(r==null?void 0:r.type)==="item"?r:null}).filter(c=>c!==null),d=[...i.getKeys()].map(c=>{const r=i.getItem(c);return(r==null?void 0:r.type)==="item"?r:null}).filter(c=>c!==null);var t,y;const g=((t=h==null?void 0:h.length)!==null&&t!==void 0?t:0)-((y=d==null?void 0:d.length)!==null&&y!==void 0?y:0);var s,n,o;let a=Math.min(g>1?Math.max(((s=u==null?void 0:u.index)!==null&&s!==void 0?s:0)-g+1,0):(n=u==null?void 0:u.index)!==null&&n!==void 0?n:0,((o=d==null?void 0:d.length)!==null&&o!==void 0?o:0)-1),b=null,p=!1;for(;a>=0;){if(!l.isDisabled(d[a].key)){b=d[a];break}if(a<d.length-1&&!p)a++;else{p=!0;var v,K;a>((v=u==null?void 0:u.index)!==null&&v!==void 0?v:0)&&(a=(K=u==null?void 0:u.index)!==null&&K!==void 0?K:0),a--}}l.setFocusedKey(b?b.key:null)}e.current=i},[i,l])}export{C as $,D as a,$ as b};
