---
title: Tanstack Table
description: Implementation av Tanstack Table
---

import { FilteringExample, ColumnVisibilityExample, ColumnDndExample, SortingExample } from '@site/src/components/examples'

# Tanstack Table

När du behöver mer avancerade funktioner för tabeller rekommenderar vi att du använder Tanstack Table. Det är ett
kraftfullt "headless"-verktyg, vilket innebär att det inte renderar någon markup eller stilar åt dig. Detta ger dig
full kontroll över tabellens utseende, och vi har tillhandahållit stilar för att säkerställa att den matchar Midas utseende och känsla.

:::info
Stilarna för Tanstack Table är just nu i en tidig version och är ett arbete som pågår. Tanstack Table är inte en del av kärnbiblioteket i Midas, vilket innebär att supporten är begränsad. Vi är öppna för kodbidrag till vårt [repo](https://github.com/migrationsverket/midas) och tar gärna emot förslag på stilar som saknas när du implementerar Tanstack Table.
:::

## När du ska använda Tanstack Table

Använd Tanstack Table när du behöver funktioner som:

- Paginering
- Sortering
- Filtrering
- Radmarkering
- Kolumnordning
- Och mycket mer!

För enklare tabeller som inte kräver denna funktionalitet kan du använda den [grundläggande Midas-tabellkomponenten](/components/table).

## Komma igång

För att använda Tanstack Table med Midas-stilar måste du först installera de nödvändiga beroendena:

```bash
npm install @tanstack/react-table
```

Importera sedan Midas-stilarna för tabellen:

```css
@import '@midas-ds/table-styles/tanstack-table.css';
```

Använd class `midas-tanstack-table`:

```tsx
<table className={'midas-tanstack-table'}>...</table>
```

Här är ett minimalt exempel för att komma igång:

```tsx
import { useReactTable, getCoreRowModel, flexRender, ColumnDef } from '@tanstack/react-table'
import '@midas-ds/table-styles/tanstack-table.css'

type Person = {
  name: string
  age: number
}

const columns: ColumnDef<Person>[] = [
  { accessorKey: 'name', header: 'Namn' },
  { accessorKey: 'age', header: 'Ålder' },
]

const data: Person[] = [
  { name: 'Anna', age: 28 },
  { name: 'Erik', age: 35 },
]

function MyTable() {
  const table = useReactTable({
    data,
    columns,
    getCoreRowModel: getCoreRowModel(),
  })

  return (
    <table className='midas-tanstack-table'>
      <thead>
        {table.getHeaderGroups().map(headerGroup => (
          <tr key={headerGroup.id}>
            {headerGroup.headers.map(header => (
              <th key={header.id}>{flexRender(header.column.columnDef.header, header.getContext())}</th>
            ))}
          </tr>
        ))}
      </thead>
      <tbody>
        {table.getRowModel().rows.map(row => (
          <tr key={row.id}>
            {row.getVisibleCells().map(cell => (
              <td key={cell.id}>{flexRender(cell.column.columnDef.cell, cell.getContext())}</td>
            ))}
          </tr>
        ))}
      </tbody>
    </table>
  )
}
```

## Användbara länkar

Här är några resurser som hjälper dig att komma igång med TanStack Table:

- [**TanStack Table v8 Docs**](https://tanstack.com/table/v8/docs/introduction): Den officiella dokumentationen är den bästa platsen att lära sig om alla funktioner och hur man använder dem.
- [**Exempel**](https://tanstack.com/table/v8/docs/framework/react/examples/basic): En stor samling exempel som visar hur man implementerar olika funktioner.

## Exempel

### Sortering

Tanstack Table har inbyggt stöd för sortering med `getSortedRowModel`. Klicka på kolumnrubrikerna för att sortera tabellen.

<SortingExample />

I detta exempel används:

- `sorting` state för att hålla reda på vilka kolumner som är sorterade och i vilken riktning
- `getSortedRowModel()` för att hantera sorteringen
- `column.getToggleSortingHandler()` för att växla sorteringsriktning vid klick
- `column.getIsSorted()` för att visa rätt sorteringsikon
- `ArrowUp`, `ArrowDown`, och `ArrowUpDown` från `lucide-react` som sorteringsindikatorer

**Viktigt att notera:** Sorteringsikonen (`ArrowUpDown`) är dold som standard och visas med låg opacitet vid hover. När en kolumn är sorterad visas `ArrowUp` eller `ArrowDown` istället. CSS-stilarna appliceras i komponenten:

```css
.sort-icon-neutral {
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
}
.sortable-header:hover .sort-icon-neutral {
  opacity: 0.4;
}
.sortable-header {
  cursor: pointer;
  user-select: none;
}
```

Läs mer om sortering i [Tanstack Table's dokumentation](https://tanstack.com/table/v8/docs/guide/sorting).

### Filtrering

Tanstack Table har inbyggt stöd för filtrering med `getFilteredRowModel`. Du kan använda alla standardformulärkomponenter från Midas för att skapa filterkontrollen.

<FilteringExample />

I detta exempel används:

- `globalFilter` för textsökning över flera kolumner
- `columnFilters` för att filtrera på specifika kolumner
- `getFilteredRowModel()` för att hantera filtreringen

Läs mer om filtrering i [Tanstack Table's dokumentation](https://tanstack.com/table/v8/docs/guide/filters).

### Kolumnsynlighet

Tanstack Table gör det enkelt att låta användare välja vilka kolumner som ska visas med `columnVisibility` state.

```jsx
{
  table.getAllLeafColumns().map(column => (
    <Checkbox
      key={column.id}
      isSelected={column.getIsVisible()}
      onChange={isSelected => column.toggleVisibility(isSelected)}
    >
      {typeof column.columnDef.header === 'string' ? column.columnDef.header : column.id}
    </Checkbox>
  ))
}
```

<ColumnVisibilityExample />

I detta exempel används:

- `columnVisibility` state för att hålla reda på vilka kolumner som är synliga
- `column.getIsVisible()` för att kontrollera om en kolumn är synlig
- `column.getToggleVisibilityHandler()` för att växla synlighet

Läs mer om kolumnsynlighet i [Tanstack Table's dokumentation](https://tanstack.com/table/v8/docs/guide/column-visibility).

### Drag and Drop-kolumner

Med hjälp av `@dnd-kit` kan du låta användare ordna om kolumner genom att dra och släppa dem. Detta ger en intuitiv och användarvänlig upplevelse för att anpassa tabellens layout.

Först, installera de nödvändiga beroendena:

```bash
npm install @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities @dnd-kit/modifiers
```

<ColumnDndExample />

I detta exempel används:

- `columnOrder` state för att hålla reda på ordningen av kolumnerna
- `DndContext` för att hantera drag and drop-funktionalitet
- `SortableContext` för att göra kolumner sorterbara
- `useSortable` hook för att göra individuella kolumner draggbara
- `arrayMove` från `@dnd-kit/sortable` för att ordna om kolumnerna
- `GripVertical` från `lucide-react` som drag-ikon som visas vid hover

**Viktigt att notera:** Drag-ikonen är dold som standard och visas bara när du hovrar över kolumnrubriken. Detta görs med CSS där ikonen har `opacity: 0` och övergår till `opacity: 1` vid hover. Se till att CSS-stilarna appliceras i komponenten för att få hover-effekten att fungera:

```css
.drag-handle {
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
}
.midas-tanstack-table th:hover .drag-handle {
  opacity: 1 !important;
}
```

Läs mer om column ordering i [Tanstack Table's dokumentation](https://tanstack.com/table/v8/docs/guide/column-ordering).
