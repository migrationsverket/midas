---
sidebar_label: 'Utveckling'
---

# Bidra till komponentbiblioteket

Att komma ig√•ng och bidra med kod till Midas √§r enkelt!

## ü§ù Gemenskapsdriven utveckling

Midas komponentbibliotek √§r **gemenskapsdriven** - det √§r ett strategiskt m√•l att biblioteket produceras av och f√∂r anv√§ndarcommunityn. Ett litet core-team ansvarar f√∂r att hantera projektet och s√§kerst√§lla kvalitet, men **bidrag fr√•n anv√§ndare √§r mer √§n v√§lkomna**.

Ett av v√•ra viktigaste m√•l √§r att erbjuda en s√• bra **developer experience (DX)** som m√∂jligt. F√∂r att uppn√• detta beh√∂ver vi er feedback, era id√©er och era bidrag. Genom att vara gemenskapsdriven s√§kerst√§ller vi att biblioteket m√∂ter verkliga behov och utmaningar som ni st√∂ter p√• i era projekt.

**Hur du kan bidra:**
- Rapportera buggar och f√∂resl√• f√∂rb√§ttringar
- Bidra med kod f√∂r nya komponenter eller funktionalitet
- F√∂rb√§ttra dokumentation
- Delta i diskussioner och code reviews
- Dela din erfarenhet av att anv√§nda Midas

Din feedback och ditt engagemang √§r avg√∂rande f√∂r att g√∂ra Midas b√§ttre. Tveka inte att h√∂ra av dig!

## üõ†Ô∏è Kom ig√•ng

Node version >22 kr√§vs. Installera [Nx](https://nx.dev) globalt: `npm install --global nx@latest`

### Nx

Midas √§r ett monorepo som hanteras med [Nx](https://nx.dev). Det inneb√§r att vi har flera olika projekt i samma repo, till exempel komponentbiblioteket, dokumentationswebben och andra verktyg. Varje projekt har sitt eget scope och kan hanteras individuellt. Du kan k√∂ra `nx graph` f√∂r att se en visuell representation av hur projekten √§r relaterade till varandra. Eftersom vissa projekt √§r beroende av andra, kan en √§ndring i ett projekt inneb√§ra att ett annat projekt ocks√• beh√∂ver en ny version. Till exempel, om `theme` uppdateras, s√• kommer `components` som √§r beroende av `theme` ocks√• att f√• en ny version.

### Starta Storybook

```bash
nx serve storybook
```

### Komponentbibliotek

Alla komponenter ligger under `/packages/components` och exporteras som ett npm-paket [`@midas-ds/components`](https://www.npmjs.com/package/@midas-ds/components).

### Tester

```bash
nx test components
```

Mer info finns p√• [sidan om tester](../tests).

### Dokumentationswebb

Dokumentationswebben ligger i `apps/docs` och √§r byggd med [Docusaurus](https://docusaurus.io/).

```bash
nx serve docs    # K√∂r lokalt
nx build docs    # Produktionsbygge
```

#### API

Vid ett produktionsbygge samlas information om komponenternas typescript-typer in och visas med hj√§lp av en tabell under rubriken API p√• varje komponentsida.
F√∂r snabbare uppstart √§r detta inaktiverat per default i `serve`-kommandot, men du kan aktivera det om du beh√∂ver se API-tabellerna under utveckling:

```bash
DOCUSAURUS_HIDE_API=false nx serve docs
```

### Testa lokalt end-to-end

F√∂r att testa komponentbiblioteket i en annan app kan du publicera det till ett lokalt npm-registry:

```bash
nx run @midas-ds/source:release:local:dev
```

Detta startar ett lokalt Verdaccio-registry och publicerar alla paket. Du kan sedan installera dem i ett testprojekt:

```bash
npm install @midas-ds/components@latest --registry=http://localhost:4873/
```

Mer information finns i `tools/release-local/README.md`.

## üåø Arbetsfl√∂de versionshantering

Vi anv√§nder en enkel branchstrategi med en `main`-branch som alltid ska vara i ett deploybart skick. Utveckling sker i feature- eller bugfix-brancher som sedan mergas in i `main`. Vi anv√§nder inte `develop` eller andra liknande brancher f√∂r att h√•lla det enkelt och f√∂r att passa ett arbetss√§tt med kontinuerlig integration och leverans (CI/CD).

Ett exempel p√• hur det kan se ut i praktiken:

```mermaid
---
config:
  logLevel: 'debug'
  theme: 'neutral'
  gitGraph:
    showBranches: true
---
gitGraph
  commit tag: "theme@4.1.4"
  commit id: "8db8ba0b0a"
  branch feature/new-button
  commit id: "81eb8978a9"
  commit id: "6aef7a733f"
  checkout main
  branch bugfix/button-color
  commit id: "6560249c6d"
  checkout feature/new-button
  commit id: "446b0bb972"
  checkout main
  merge bugfix/button-color
  checkout feature/new-button
  commit id: "b682194518"
  checkout main
  merge feature/new-button
  commit tag: "components@14.1.0"
  commit id: "a27c4f41d9"
  commit id: "5dec5b5dd3"
```

### Branch

Brancher namnges enligt `[feature|bugfix|hotfix|docs|refactor|chore|test]/[scope]/`, till exempel `feature/button`. Scope √§r valfritt men om det anv√§nds ska det referera till ett av projekten i monorepot, till exempel `components`, `docs` eller `theme`.

### Commit

Commits g√∂rs enligt [conventional commits](https://www.conventionalcommits.org/en/v1.0.0/#summary). Anv√§nd engelska,
**imperativ form**, definiera type `feat|docs|fix|refactor|test|chore|ops...` f√∂r att avg√∂ra vilken versions√§ndring du vill g√∂ra och scope `(project, component)` som rubrik f√∂r changelog.

**Viktigt**: Scope b√∂rjar alltid med ett av Nx-projekten (`components`, `theme`, `docs`, etc.) f√∂r att versionshanteringen ska fungera korrekt. Komponenter eller features anges som andra parametern efter kommatecken.

Se `.commitlintrc.js` f√∂r till√•tna types och scopes.

**Exempel:**

```bash
feat(components, button): add new button variant   # Minor bump f√∂r components
fix(theme): fix button hover color                 # Patch f√∂r theme
docs: update contribution guide                    # Ingen bump

# Med body f√∂r mer kontext
fix(theme): prevent red color on button hover

Introduce new css variable to automatically
select style based on input type
```

:::info
Innan du skapar en PR, st√§da g√§rna commit-historiken med `git rebase -i` om du har m√•nga commits i din feature branch. [Guide till git rebase](https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase).
:::

## üèóÔ∏è Designfilosofi och arkitektur

Midas designsystem f√∂ljer principer fr√•n Clean Code och Clean Architecture f√∂r att s√§kerst√§lla h√∂g kvalitet, underh√•llbarhet och l√•ngsiktig stabilitet.

### ‚ú® Clean Code-principer

Vi str√§var efter ren, l√§sbar och underh√•llbar kod:

- **Sm√• funktioner och komponenter**: Varje komponent har ett tydligt, avgr√§nsat ansvar (Single Responsibility Principle)
- **Beskrivande namn**: Funktioner, variabler och komponenter har namn som tydligt beskriver vad de g√∂r
- **Testbar kod**: Kod struktureras f√∂r att vara enkel att testa
- **DRY (Don't Repeat Yourself)**: Undvik kodduplicering genom √•teranv√§ndning och abstraktion
- **Inkrementella f√∂rb√§ttringar**: L√§mna koden b√§ttre √§n du hittade den - fixa g√§rna problem du ser √§ven om de inte √§r en del av din uppgift
- **Stateless komponenter**: Komponenter √§r i m√∂jlig m√•n stateless och st√∂djer designsystemet p√• ett generiskt s√§tt

### üèõÔ∏è Clean Architecture-principer

Vi till√§mpar principer fr√•n clean architecture f√∂r att skapa ett underh√•llbart och stabilt komponentbibliotek:

- **Separera styling fr√•n beteende**: Anv√§nd headless-bibliotek f√∂r logik och tillg√§nglighet, applicera endast visuell stil
- **Minimera beroenden**: H√•ll komponenter l√∂st kopplade och undvik on√∂diga beroenden mellan dem
- **Testbarhet**: Komponenter √§r enkla att testa isolerat utan omfattande setup
- **Stabilitet √∂ver flexibilitet**: V√§lj stabila, v√§lunderh√•llna beroenden framf√∂r att bygga egen komplexitet

### üì¶ Beroendestrategi: Headless-bibliotek

#### React Aria Components (RAC) - F√∂rstahandsval

Komponenter byggs **i f√∂rsta hand** p√• [React Aria Components](https://react-spectrum.adobe.com/react-aria/getting-started.html). React Aria tillhandah√•ller:

- **Tillg√§nglighet**: Fullst√§ndigt st√∂d f√∂r WCAG, sk√§rml√§sare och tangentbordsnavigation
- **Plattformsst√∂d**: Touch, mouse och keyboard fungerar s√∂ml√∂st
- **Produktionstestad**: V√§ltestad kod fr√•n Adobe som anv√§nds i stora produktionsmilj√∂er
- **Internationalisering**: Inbyggt st√∂d f√∂r olika spr√•k och lokalisering

**Viktigt**: F√∂lj React Aria's API och m√∂nster s√• n√§ra som m√∂jligt. Undvik att avvika f√∂r mycket fr√•n originalet d√• det:
- F√∂rsv√•rar uppgraderingar n√§r React Aria uppdaterar sitt API
- √ñkar underh√•llsb√∂rdan f√∂r teamet
- Riskerar att vi bygger egen komplexitet som redan √§r l√∂st

**Best practice**: Om du beh√∂ver anpassa beteende, fr√•ga dig f√∂rst om React Aria redan har en l√∂sning via props, composition eller hooks.

#### Alternativa headless-bibliotek

N√§r funktionalitet **inte finns** i React Aria Components, v√§lj andra v√§lunderh√•llna headless-bibliotek.

**Exempel p√• bibliotek vi redan anv√§nder:**
- **[TanStack Table](https://tanstack.com/table)**: F√∂r avancerad tabellhantering
- **[React Select](https://react-select.com/)**: F√∂r komplexa select-komponenter

**Kriterier f√∂r att v√§lja ett bibliotek:**
- V√§lunderh√•llet och aktivt utvecklat
- Headless (ingen inbyggd styling)
- Stort community och bra dokumentation
- TypeScript-st√∂d
- Stabilt API med tydlig versionshantering
- Produktionstestat och anv√§nds av m√•nga projekt

Tveka inte att f√∂resl√• andra v√§lunderh√•llna headless-bibliotek om de passar anv√§ndarfallet b√§ttre.

#### Undvik custom-l√∂sningar

:::warning
Bygg inte egen logik f√∂r tangentbordshantering, focus management, ARIA eller accessibility-funktionalitet. Custom-l√∂sningar √§r sv√•ra att f√• r√§tt, √∂kar underh√•llsb√∂rdan dramatiskt och riskerar att introducera tillg√§nglighetsbrister.
:::

**N√§r √§r custom OK?** Endast f√∂r ren visuell styling eller sm√•, v√§ldefinierade utilities som inte existerar i headless-bibliotek.

## üî® Bygga komponenter

### Styleguide

Generellt, anv√§nd √∂vriga komponenter som referens n√§r nya l√§ggs till. React Aria √§r en bra inspiration f√∂r namngivning
och struktur, b√•de via deras ostylade komponentbibliotek och via sin designsystemsimplementation
[React Spectrum](https://github.com/adobe/react-spectrum/tree/main/packages/%40react-spectrum).

- **Formatera enligt [Prettier](https://prettier.io/) standard**
- **F√∂lj existerande patterns**: Se hur liknande komponenter √§r strukturerade

### Skapa stories

Alla states b√∂r finnas representerade som stories i Storybook. Storybook √§r i f√∂rsta hand ett internt
verktyg f√∂r UX och utvecklare i designsystemet men ocks√• en publikt exponerad referens med API och visuell
representation av komponenterna.

### Skriv enhetstester

Eftersom tillg√§nglighet √§r ett av designsystemets viktigaste fokusomr√•den √§r det viktigt att vi regressionstestar och testar
s√• stor del av m√∂jliga states av alla komponenter p√• enhetsniv√•. MIDAS anv√§nder prim√§rt
[Storybook som testplattform](https://storybook.js.org/docs/writing-tests). De stories du skapat f√∂r komponenter kan du nu anv√§nda som utg√•ngspunkt f√∂r dina tester.
L√§s mer om [hur vi f√∂rh√•ller oss till tester av v√•ra komponenter](../tests).

### Dokumentation

Komponenten dokumenteras p√• dokumentationswebben med l√§mpliga exempel, beskrivning och properties. Normalt plockas
properties upp fr√•n komponenten via [react-docgen-typescript](https://github.com/styleguidist/react-docgen-typescript)
men om det har inf√∂rts nya types eller interfaces kan de beh√∂va specificeras enligt [JSDoc](https://jsdoc.app/).

---

## üöÄ Release

Release sker automatiskt via CI/CD n√§r √§ndringar mergas till `main`-branchen.

### Hur det fungerar

1. **Automatiska versioner**: N√§r en pull request mergas till `main` analyserar Nx Release alla commits sedan senaste release och r√§knar fram r√§tt version baserat p√• conventional commits.

2. **Publicering**: Om n√•gon package f√•r en ny version publiceras den automatiskt till npm.

3. **Changelog och taggar**: Changelog uppdateras automatiskt och nya git-taggar skapas enligt formatet `nx-project@version`.

4. **Dokumentation**: Dokumentationswebben byggs och publiceras automatiskt med de senaste √§ndringarna.

### Vad du beh√∂ver g√∂ra

- **F√∂lj conventional commits**: Dina commits f√∂ljer conventional commits-standarden, eftersom det avg√∂r vilken versions√§ndring som sker (major, minor, patch).
- **Merge till main**: N√§r din pull request godk√§nns och mergas till `main` sker resten automatiskt.

:::info
Du beh√∂ver inte k√∂ra n√•gra manuella release-kommandon. CI/CD-pipelinen hanterar hela releasen automatiskt.
:::
