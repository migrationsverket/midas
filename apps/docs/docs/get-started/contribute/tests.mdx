---
sidebar_label: 'Tester'
sidebar_position: 3
---

# 游빍 Tester

Tester i Midas utg칬rs fr칛mst av _komponenttester_ med hj칛lp av [Vitest Component Testing](https://vitest.dev/guide/browser/component-testing).
Vi g칬r ocks친 automatiska [_tillg칛nglighetstester_ i Storybook](https://storybook.js.org/docs/writing-tests/accessibility-testing), _snapshottester_ k칬rs i Chromatic.

## Komponenttester

Midas anv칛nder [Storybook](https://storybook.js.org), med hj칛lp av [portable stories](https://storybook.js.org/docs/api/portable-stories/portable-stories-vitest#composestories) kan vi anv칛nda en renderad story som utg친ngspunkt f칬r v친ra tester.

### K칬r komponenttester

```bash
nx test components                         # Lokal installation
docker compose exec docs nx test components # Docker
```

### Skriva komponenttester

Mycket kan testas p친 v친ra komponenter, och mycket kanske redan testas av de bibliotek vi utg친r ifr친n.
F칬rs칬k skriva ett test som kompletterar redan skrivna tester, kom ih친g att ditt test kommer beh칬va underh친llas i framtiden.

#### Buggr칛ttning med TDD

Om du r칛ttar en bugg erbjuds du ett unikt tillf칛lle att skriva ett test som 친terskapar din bug, f칬rhoppningsvis kommer vi d친 inte att 친terinf칬ra buggen.

```tsx title="TextField.spec.tsx"
it('should be impossible to exceed the max length', async () => {
  // Rendera din story
  const { getByRole } = await render(<Primary maxLength={3} />)

  // Interagera med userEvent
  await userEvent.tab()
  await userEvent.keyboard('abcd')

  // Skriv minst en f칬rv칛ntning med expect
  await expect.element(getByRole('textbox')).toHaveDisplayValue('abc')
})
```

Nu kan du 친tg칛rda din bug, n칛r du 칛r klar b칬r ditt test passera.

## Tillg칛nglighetstester

Med [@storybook/addon-a11y](https://storybook.js.org/docs/writing-tests/accessibility-testing) utf칬rs tillg칛nglighetstester med [axe](https://www.deque.com/axe/) p친 varje komponent, dessa testas i v친ra workflows med kommandot:

```bash
nx a11y storybook                         # Lokal installation
docker compose exec docs nx a11y storybook # Docker
```

Automatiserade tillg칛nglighetstester f친ngar upp en stor del av brister gentemot [WCAG](https://www.w3.org/WAI/standards-guidelines/wcag/)-standarden men kan sj칛lvklart kompletteras.

F칬r att kontrollera tillg칛ngligheten i dark-mode eller forced-colors:

```bash
nx run storybook:a11y-dark-mode      # Dark mode
nx run storybook:a11y-forced-colors  # Forced colors
```

F칬r Docker, l칛gg till `docker compose exec docs` f칬re kommandot.

## Snapshottester

Vi anv칛nder [Chromatic](https://chromatic.com) f칬r att k칬ra snapshottester som j칛mf칬r visuella 칛ndringar i komponenter.
Chromatic utg친r fr친n v친r Storybook och tar snapshots p친 samtliga stories.

### Trigga snapshottester

Snapshottester k칬rs automatiskt vid push till f칬ljande brancher:

- `main`
- brancher som startar med `feature`
- brancher som startar med `feat`
- brancher som startar med `fix`
- brancher som startar med `bugfix`

### Hoppa 칬ver stories

F칬r att reducera antalet snapshots b칬r vi bara ta en snap per tillst친nd i en komponent, v칛nligen anv칛nd f칬ljande kod om du vill att chromatic ska hoppa 칬ver din story:

```tsx
export const PrimaryWithAnotherLabel: Story = {
  args: {
    label: 'Just another label',
  },
  parameters: {
    chromatic: {
      disableSnapshot: true,
    },
  },
  // ...
}
```
