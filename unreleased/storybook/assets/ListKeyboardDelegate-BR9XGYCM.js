import{r as u,c}from"./iframe-CKDWBnzr.js";import{c as g}from"./SelectionManager-DB-HO5Vc.js";import{$ as a}from"./scrollIntoView-Dsrcj58z.js";const K=u.createContext(null),x=u.createContext(null);let s=new Map;function m(n){let{locale:t}=c(),e=t+(n?Object.entries(n).sort((l,o)=>l[0]<o[0]?-1:1).join():"");if(s.has(e))return s.get(e);let i=new Intl.Collator(t,n);return s.set(e,i),i}class h{getItemRect(t){let e=this.ref.current;if(!e)return null;let i=t!=null?g(this.ref,t):null;if(!i)return null;let l=e.getBoundingClientRect(),o=i.getBoundingClientRect();return{x:o.left-l.left+e.scrollLeft,y:o.top-l.top+e.scrollTop,width:o.width,height:o.height}}getContentSize(){let t=this.ref.current;var e,i;return{width:(e=t==null?void 0:t.scrollWidth)!==null&&e!==void 0?e:0,height:(i=t==null?void 0:t.scrollHeight)!==null&&i!==void 0?i:0}}getVisibleRect(){let t=this.ref.current;var e,i,l,o;return{x:(e=t==null?void 0:t.scrollLeft)!==null&&e!==void 0?e:0,y:(i=t==null?void 0:t.scrollTop)!==null&&i!==void 0?i:0,width:(l=t==null?void 0:t.offsetWidth)!==null&&l!==void 0?l:0,height:(o=t==null?void 0:t.offsetHeight)!==null&&o!==void 0?o:0}}constructor(t){this.ref=t}}class b{isDisabled(t){var e;return this.disabledBehavior==="all"&&(((e=t.props)===null||e===void 0?void 0:e.isDisabled)||this.disabledKeys.has(t.key))}findNextNonDisabled(t,e){let i=t;for(;i!=null;){let l=this.collection.getItem(i);if((l==null?void 0:l.type)==="item"&&!this.isDisabled(l))return i;i=e(i)}return null}getNextKey(t){let e=t;return e=this.collection.getKeyAfter(e),this.findNextNonDisabled(e,i=>this.collection.getKeyAfter(i))}getPreviousKey(t){let e=t;return e=this.collection.getKeyBefore(e),this.findNextNonDisabled(e,i=>this.collection.getKeyBefore(i))}findKey(t,e,i){let l=t,o=this.layoutDelegate.getItemRect(l);if(!o||l==null)return null;let r=o;do{if(l=e(l),l==null)break;o=this.layoutDelegate.getItemRect(l)}while(o&&i(r,o)&&l!=null);return l}isSameRow(t,e){return t.y===e.y||t.x!==e.x}isSameColumn(t,e){return t.x===e.x||t.y!==e.y}getKeyBelow(t){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(t,e=>this.getNextKey(e),this.isSameRow):this.getNextKey(t)}getKeyAbove(t){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(t,e=>this.getPreviousKey(e),this.isSameRow):this.getPreviousKey(t)}getNextColumn(t,e){return e?this.getPreviousKey(t):this.getNextKey(t)}getKeyRightOf(t){let e=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[e]?(t=this.layoutDelegate[e](t),this.findNextNonDisabled(t,i=>this.layoutDelegate[e](i))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(t,this.direction==="rtl"):this.findKey(t,i=>this.getNextColumn(i,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(t,this.direction==="rtl"):null}getKeyLeftOf(t){let e=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[e]?(t=this.layoutDelegate[e](t),this.findNextNonDisabled(t,i=>this.layoutDelegate[e](i))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(t,this.direction==="ltr"):this.findKey(t,i=>this.getNextColumn(i,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(t,this.direction==="ltr"):null}getFirstKey(){let t=this.collection.getFirstKey();return this.findNextNonDisabled(t,e=>this.collection.getKeyAfter(e))}getLastKey(){let t=this.collection.getLastKey();return this.findNextNonDisabled(t,e=>this.collection.getKeyBefore(e))}getKeyPageAbove(t){let e=this.ref.current,i=this.layoutDelegate.getItemRect(t);if(!i)return null;if(e&&!a(e))return this.getFirstKey();let l=t;if(this.orientation==="horizontal"){let o=Math.max(0,i.x+i.width-this.layoutDelegate.getVisibleRect().width);for(;i&&i.x>o&&l!=null;)l=this.getKeyAbove(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}else{let o=Math.max(0,i.y+i.height-this.layoutDelegate.getVisibleRect().height);for(;i&&i.y>o&&l!=null;)l=this.getKeyAbove(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}return l??this.getFirstKey()}getKeyPageBelow(t){let e=this.ref.current,i=this.layoutDelegate.getItemRect(t);if(!i)return null;if(e&&!a(e))return this.getLastKey();let l=t;if(this.orientation==="horizontal"){let o=Math.min(this.layoutDelegate.getContentSize().width,i.y-i.width+this.layoutDelegate.getVisibleRect().width);for(;i&&i.x<o&&l!=null;)l=this.getKeyBelow(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}else{let o=Math.min(this.layoutDelegate.getContentSize().height,i.y-i.height+this.layoutDelegate.getVisibleRect().height);for(;i&&i.y<o&&l!=null;)l=this.getKeyBelow(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}return l??this.getLastKey()}getKeyForSearch(t,e){if(!this.collator)return null;let i=this.collection,l=e||this.getFirstKey();for(;l!=null;){let o=i.getItem(l);if(!o)return null;let r=o.textValue.slice(0,t.length);if(o.textValue&&this.collator.compare(r,t)===0)return l;l=this.getNextKey(l)}return null}constructor(...t){if(t.length===1){let e=t[0];this.collection=e.collection,this.ref=e.ref,this.collator=e.collator,this.disabledKeys=e.disabledKeys||new Set,this.disabledBehavior=e.disabledBehavior||"all",this.orientation=e.orientation||"vertical",this.direction=e.direction,this.layout=e.layout||"stack",this.layoutDelegate=e.layoutDelegate||new h(e.ref)}else this.collection=t[0],this.disabledKeys=t[1],this.ref=t[2],this.collator=t[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new h(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}export{m as $,x as a,K as b,b as c,h as d};
