import{$ as Z,a as ee,b as N,c as te,d as oe}from"./Collection-DyipXQ6z.js";import{o as A,f as ae,h as G,d as H,E as W,G as ne,H as re,I as de,a as J,J as q,B as le,$ as ie,k as R,K as se,b as ce,c as T,t as j,r as ue}from"./useFocusable-Ca924fmk.js";import{$ as _,a as fe,b as pe,c as Q}from"./DragAndDrop-sISFPnlb.js";import{$ as be,a as $e,b as ge,c as he,d as ve}from"./Separator-DMYMef74.js";import{a as me}from"./Text-BkfI_mlu.js";import{r as l,R as u}from"./index-BbAIUH2N.js";import{$ as xe}from"./useListState-wnqPBjd-.js";import{$ as Pe}from"./context-DeC-Ug1U.js";import{$ as De}from"./useCollator-COdvugSF.js";import{$ as ye}from"./ListKeyboardDelegate-DmPpmGaI.js";import{c as Se}from"./useField-DkY56YAB.js";import{c as ke}from"./SelectionManager-CGvOaT5j.js";import{a as Fe}from"./FocusScope-C4P3cAwe.js";const K=new WeakMap;function Ce(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function we(t,e){let n=K.get(t);if(!n)throw new Error("Unknown list");return`${n.id}-option-${Ce(e)}`}function Ee(t,e,n){let o=A(t,{labelable:!0}),d=t.selectionBehavior||"toggle",r=t.linkBehavior||(d==="replace"?"action":"override");d==="toggle"&&r==="action"&&(r="override");let{listProps:a}=be({...t,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:i}=ae({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),s=G(t.id);K.set(e,{id:s,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:r});let{labelProps:p,fieldProps:b}=Se({...t,id:s,labelElementType:"span"});return{labelProps:p,listBoxProps:H(o,i,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...H(b,a)})}}function He(t,e,n){var o,d;let{key:r}=t,a=K.get(e);var i;let s=(i=t.isDisabled)!==null&&i!==void 0?i:e.selectionManager.isDisabled(r);var p;let b=(p=t.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(r);var h;let f=(h=t.shouldSelectOnPressUp)!==null&&h!==void 0?h:a==null?void 0:a.shouldSelectOnPressUp;var v;let S=(v=t.shouldFocusOnHover)!==null&&v!==void 0?v:a==null?void 0:a.shouldFocusOnHover;var g;let $=(g=t.shouldUseVirtualFocus)!==null&&g!==void 0?g:a==null?void 0:a.shouldUseVirtualFocus;var P;let D=(P=t.isVirtualized)!==null&&P!==void 0?P:a==null?void 0:a.isVirtualized,F=W(),B=W(),y={role:"option","aria-disabled":s||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?b:void 0};ne()&&re()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=F,y["aria-describedby"]=B);let c=e.collection.getItem(r);if(D){let x=Number(c==null?void 0:c.index);y["aria-posinset"]=Number.isNaN(x)?void 0:x+1,y["aria-setsize"]=$e(e.collection)}let m=a!=null&&a.onAction?()=>{var x;return a==null||(x=a.onAction)===null||x===void 0?void 0:x.call(a,r)}:void 0,k=we(e,r),{itemProps:C,isPressed:M,isFocused:w,hasAction:U,allowsSelection:I}=ke({selectionManager:e.selectionManager,key:r,ref:n,shouldSelectOnPressUp:f,allowsDifferentPressOrigin:f&&S,isVirtualized:D,shouldUseVirtualFocus:$,isDisabled:s,onAction:m||!(c==null||(o=c.props)===null||o===void 0)&&o.onAction?de(c==null||(d=c.props)===null||d===void 0?void 0:d.onAction,m):void 0,linkBehavior:a==null?void 0:a.linkBehavior,id:k}),{hoverProps:V}=J({isDisabled:s||!S,onHoverStart(){q()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),E=A(c==null?void 0:c.props);delete E.id;let O=le(c==null?void 0:c.props);return{optionProps:{...y,...H(E,C,V,O),id:k},labelProps:{id:F},descriptionProps:{id:B},isFocused:w,isFocusVisible:w&&q(),isSelected:b,isDisabled:s,isPressed:M,allowsSelection:I,hasAction:U}}function Be(t){let{heading:e,"aria-label":n}=t,o=G();return{itemProps:{role:"presentation"},headingProps:e?{id:o,role:"presentation"}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?o:void 0}}}const X=l.createContext(null),L=l.createContext(null),Qe=l.forwardRef(function(e,n){[e,n]=ie(e,n,X);let o=l.useContext(L);return o?u.createElement(Y,{state:o,props:e,listBoxRef:n}):u.createElement(Z,{content:u.createElement(ee,e)},d=>u.createElement(Me,{props:e,listBoxRef:n,collection:d}))});function Me({props:t,listBoxRef:e,collection:n}){t={...t,collection:n,children:null,items:null};let{layoutDelegate:o}=l.useContext(N),{filterFn:d,collectionProps:r,collectionRef:a}=l.useContext(ge)||{};e=R(l.useMemo(()=>se(e,a!==void 0?a:null),[a,e]));let i=l.useMemo(()=>d?n.filter(d):n,[n,d]),s=xe({...t,collection:i,layoutDelegate:o});return u.createElement(Y,{state:s,props:{...t,...r},listBoxRef:e})}function Y({state:t,props:e,listBoxRef:n}){let{dragAndDropHooks:o,layout:d="stack",orientation:r="vertical"}=e,{collection:a,selectionManager:i}=t,s=!!(o!=null&&o.useDraggableCollectionState),p=!!(o!=null&&o.useDroppableCollectionState),{direction:b}=Pe(),{disabledBehavior:h,disabledKeys:f}=i,v=De({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:g,dropTargetDelegate:$,CollectionRoot:P}=l.useContext(N),D=l.useMemo(()=>e.keyboardDelegate||new ye({collection:a,collator:v,ref:n,disabledKeys:f,disabledBehavior:h,layout:d,orientation:r,direction:b,layoutDelegate:g}),[a,v,n,h,f,r,b,e.keyboardDelegate,d,g]),{listBoxProps:F}=Ee({...e,shouldSelectOnPressUp:s||e.shouldSelectOnPressUp,keyboardDelegate:D,isVirtualized:S},t,n),B=l.useRef(s),y=l.useRef(p);l.useEffect(()=>{B.current!==s&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),y.current!==p&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[s,p]);let c,m,k,C=!1,M=null,w=l.useRef(null);if(s&&o){c=o.useDraggableCollectionState({collection:a,selectionManager:i,preview:o.renderDragPreview?w:void 0}),o.useDraggableCollection({},c,n);let z=o.DragPreview;M=o.renderDragPreview?u.createElement(z,{ref:w},o.renderDragPreview):null}if(p&&o){m=o.useDroppableCollectionState({collection:a,selectionManager:i});let z=o.dropTargetDelegate||$||new o.ListDropTargetDelegate(a,n,{orientation:r,layout:d,direction:b});k=o.useDroppableCollection({keyboardDelegate:D,dropTargetDelegate:z},m,n),C=m.isDropTarget({type:"root"})}let{focusProps:U,isFocused:I,isFocusVisible:V}=ce(),E={isDropTarget:C,isEmpty:t.collection.size===0,isFocused:I,isFocusVisible:V,layout:e.layout||"stack",state:t},O=T({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:E}),x=null;return t.collection.size===0&&e.renderEmptyState&&(x=u.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(E))),u.createElement(Fe,null,u.createElement("div",{...A(e),...H(F,U,k==null?void 0:k.collectionProps),...O,ref:n,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":C||void 0,"data-empty":t.collection.size===0||void 0,"data-focused":I||void 0,"data-focus-visible":V||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},u.createElement(j,{values:[[X,e],[L,t],[_,{dragAndDropHooks:o,dragState:c,dropState:m}],[he,{elementType:"div"}],[fe,{render:Ve}],[te,{name:"ListBoxSection",render:Ie}]]},u.createElement(P,{collection:a,scrollRef:n,persistedKeys:pe(i,o,m),renderDropIndicator:Q(o,m)})),x,M))}function Ie(t,e,n,o="react-aria-ListBoxSection"){let d=l.useContext(L),{dragAndDropHooks:r,dropState:a}=l.useContext(_),{CollectionBranch:i}=l.useContext(N),[s,p]=ue();var b;let{headingProps:h,groupProps:f}=Be({heading:p,"aria-label":(b=t["aria-label"])!==null&&b!==void 0?b:void 0}),v=T({defaultClassName:o,className:t.className,style:t.style,values:{}});return u.createElement("section",{...A(t),...f,...v,ref:e},u.createElement(ve.Provider,{value:{...h,ref:s}},u.createElement(i,{collection:d.collection,parent:n,renderDropIndicator:Q(r,a)})))}const Xe=oe("item",function(e,n,o){let d=R(n),r=l.useContext(L),{dragAndDropHooks:a,dragState:i,dropState:s}=l.useContext(_),{optionProps:p,labelProps:b,descriptionProps:h,...f}=He({key:o.key,"aria-label":e==null?void 0:e["aria-label"]},r,d),{hoverProps:v,isHovered:S}=J({isDisabled:!f.allowsSelection&&!f.hasAction,onHoverStart:o.props.onHoverStart,onHoverChange:o.props.onHoverChange,onHoverEnd:o.props.onHoverEnd}),g=null;i&&a&&(g=a.useDraggableItem({key:o.key},i));let $=null;s&&a&&($=a.useDroppableItem({target:{type:"item",key:o.key,dropPosition:"on"}},s,d));let P=i&&i.isDragging(o.key),D=T({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...f,isHovered:S,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!i,isDragging:P,isDropTarget:$==null?void 0:$.isDropTarget}});l.useEffect(()=>{o.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[o.textValue]);let F=e.href?"a":"div";return u.createElement(F,{...H(p,v,g==null?void 0:g.dragProps,$==null?void 0:$.dropProps),...D,ref:d,"data-allows-dragging":!!i||void 0,"data-selected":f.isSelected||void 0,"data-disabled":f.isDisabled||void 0,"data-hovered":S||void 0,"data-focused":f.isFocused||void 0,"data-focus-visible":f.isFocusVisible||void 0,"data-pressed":f.isPressed||void 0,"data-dragging":P||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},u.createElement(j,{values:[[me,{slots:{label:b,description:h}}]]},D.children))});function Ve(t,e){e=R(e);let{dragAndDropHooks:n,dropState:o}=l.useContext(_),{dropIndicatorProps:d,isHidden:r,isDropTarget:a}=n.useDropIndicator(t,o,e);return r?null:u.createElement(Te,{...t,dropIndicatorProps:d,isDropTarget:a,ref:e})}function Ae(t,e){let{dropIndicatorProps:n,isDropTarget:o,...d}=t,r=T({...d,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:o}});return u.createElement("div",{...n,...r,role:"option",ref:e,"data-drop-target":o||void 0})}const Te=l.forwardRef(Ae);export{Ee as $,He as a,Be as b,K as c,we as d,X as e,L as f,Qe as g,Xe as h};
