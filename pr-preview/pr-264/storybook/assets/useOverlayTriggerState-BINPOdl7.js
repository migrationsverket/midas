import{G as ae,g as j}from"./useFocusable-DMGkbK-i.js";import{r as I}from"./index-BbAIUH2N.js";import{$ as fe}from"./context-D5CBVWAD.js";import{$ as de}from"./useControlledState-DGyHFLi9.js";function se(){return typeof window.ResizeObserver<"u"}function K(t){const{ref:e,box:n,onResize:o}=t;I.useEffect(()=>{let l=e==null?void 0:e.current;if(l)if(se()){const i=new window.ResizeObserver(f=>{f.length&&o()});return i.observe(l,{box:n}),()=>{l&&i.unobserve(l)}}else return window.addEventListener("resize",o,!1),()=>{window.removeEventListener("resize",o,!1)}},[o,e,n])}function q(t,e=-1/0,n=1/0){return Math.min(Math.max(t,e),n)}const y={top:"top",bottom:"top",left:"left",right:"left"},X={top:"bottom",bottom:"top",left:"right",right:"left"},ce={top:"left",left:"top"},J={top:"height",left:"width"},ne={width:"totalWidth",height:"totalHeight"},Y={};let C=typeof document<"u"?window.visualViewport:null;function Q(t){let e=0,n=0,o=0,l=0,i=0,f=0,r={};var h;let s=((h=C==null?void 0:C.scale)!==null&&h!==void 0?h:1)>1;if(t.tagName==="BODY"){let c=document.documentElement;o=c.clientWidth,l=c.clientHeight;var u;e=(u=C==null?void 0:C.width)!==null&&u!==void 0?u:o;var $;n=($=C==null?void 0:C.height)!==null&&$!==void 0?$:l,r.top=c.scrollTop||t.scrollTop,r.left=c.scrollLeft||t.scrollLeft,C&&(i=C.offsetTop,f=C.offsetLeft)}else({width:e,height:n,top:i,left:f}=B(t)),r.top=t.scrollTop,r.left=t.scrollLeft,o=e,l=n;if(ae()&&(t.tagName==="BODY"||t.tagName==="HTML")&&s){r.top=0,r.left=0;var p;i=(p=C==null?void 0:C.pageTop)!==null&&p!==void 0?p:0;var a;f=(a=C==null?void 0:C.pageLeft)!==null&&a!==void 0?a:0}return{width:e,height:n,totalWidth:o,totalHeight:l,scroll:r,top:i,left:f}}function ue(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function W(t,e,n,o,l,i,f){var r;let h=(r=l.scroll[t])!==null&&r!==void 0?r:0,s=o[J[t]],u=o.scroll[y[t]]+i,$=s+o.scroll[y[t]]-i,p=e-h+f[t]-o[y[t]],a=e-h+n+f[t]-o[y[t]];return p<u?u-p:a>$?Math.max($-a,u-p):0}function pe(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function V(t){if(Y[t])return Y[t];let[e,n]=t.split(" "),o=y[e]||"right",l=ce[o];y[n]||(n="center");let i=J[o],f=J[l];return Y[t]={placement:e,crossPlacement:n,axis:o,crossAxis:l,size:i,crossSize:f},Y[t]}function U(t,e,n,o,l,i,f,r,h,s){let{placement:u,crossPlacement:$,axis:p,crossAxis:a,size:c,crossSize:v}=o,d={};var m;d[a]=(m=t[a])!==null&&m!==void 0?m:0;var g,E,R,L;$==="center"?d[a]+=(((g=t[v])!==null&&g!==void 0?g:0)-((E=n[v])!==null&&E!==void 0?E:0))/2:$!==a&&(d[a]+=((R=t[v])!==null&&R!==void 0?R:0)-((L=n[v])!==null&&L!==void 0?L:0)),d[a]+=i;const b=t[a]-n[v]+h+s,_=t[a]+t[v]-h-s;if(d[a]=q(d[a],b,_),u===p){const M=r?f[c]:e[ne[c]];d[X[p]]=Math.floor(M-t[p]+l)}else d[p]=Math.floor(t[p]+t[c]+l);return d}function me(t,e,n,o,l,i,f,r){const h=o?n.height:e[ne.height];var s;let u=t.top!=null?n.top+t.top:n.top+(h-((s=t.bottom)!==null&&s!==void 0?s:0)-f);var $,p,a,c,v,d;let m=r!=="top"?Math.max(0,e.height+e.top+(($=e.scroll.top)!==null&&$!==void 0?$:0)-u-(((p=l.top)!==null&&p!==void 0?p:0)+((a=l.bottom)!==null&&a!==void 0?a:0)+i)):Math.max(0,u+f-(e.top+((c=e.scroll.top)!==null&&c!==void 0?c:0))-(((v=l.top)!==null&&v!==void 0?v:0)+((d=l.bottom)!==null&&d!==void 0?d:0)+i));return Math.min(e.height-i*2,m)}function D(t,e,n,o,l,i){let{placement:f,axis:r,size:h}=i;var s,u;if(f===r)return Math.max(0,n[r]-t[r]-((s=t.scroll[r])!==null&&s!==void 0?s:0)+e[r]-((u=o[r])!==null&&u!==void 0?u:0)-o[X[r]]-l);var $;return Math.max(0,t[h]+t[r]+t.scroll[r]-e[r]-n[r]-n[h]-(($=o[r])!==null&&$!==void 0?$:0)-o[X[r]]-l)}function ge(t,e,n,o,l,i,f,r,h,s,u,$,p,a,c,v){let d=V(t),{size:m,crossAxis:g,crossSize:E,placement:R,crossPlacement:L}=d,b=U(e,r,n,d,u,$,s,p,c,v),_=u,M=D(r,s,e,l,i+u,d);if(f&&o[m]>M){let G=V(`${X[R]} ${L}`),ie=U(e,r,n,G,u,$,s,p,c,v);D(r,s,e,l,i+u,G)>M&&(d=G,b=ie,_=u)}let H="bottom";d.axis==="top"?d.placement==="top"?H="top":d.placement==="bottom"&&(H="bottom"):d.crossAxis==="top"&&(d.crossPlacement==="top"?H="bottom":d.crossPlacement==="bottom"&&(H="top"));let w=W(g,b[g],n[E],r,h,i,s);b[g]+=w;let T=me(b,r,s,p,l,i,n.height,H);a&&a<T&&(T=a),n.height=Math.min(n.height,T),b=U(e,r,n,d,_,$,s,p,c,v),w=W(g,b[g],n[E],r,h,i,s),b[g]+=w;let z={},O=e[g]+.5*e[E]-b[g]-l[y[g]];const S=c/2+v;var k,N,A,P;const F=y[g]==="left"?((k=l.left)!==null&&k!==void 0?k:0)+((N=l.right)!==null&&N!==void 0?N:0):((A=l.top)!==null&&A!==void 0?A:0)+((P=l.bottom)!==null&&P!==void 0?P:0),Z=n[E]-F-c/2-v,le=e[g]+c/2-(b[g]+l[y[g]]),oe=e[g]+e[E]-c/2-(b[g]+l[y[g]]),re=q(O,le,oe);return z[g]=q(re,S,Z),{position:b,maxHeight:T,arrowOffsetLeft:z.left,arrowOffsetTop:z.top,placement:d.placement}}function $e(t){let{placement:e,targetNode:n,overlayNode:o,scrollNode:l,padding:i,shouldFlip:f,boundaryElement:r,offset:h,crossOffset:s,maxHeight:u,arrowSize:$=0,arrowBoundaryOffset:p=0}=t,a=o instanceof HTMLElement?he(o):document.documentElement,c=a===document.documentElement;const v=window.getComputedStyle(a).position;let d=!!v&&v!=="static",m=c?B(n):ee(n,a);if(!c){let{marginTop:z,marginLeft:O}=window.getComputedStyle(n);m.top+=parseInt(z,10)||0,m.left+=parseInt(O,10)||0}let g=B(o),E=pe(o);var R,L;g.width+=((R=E.left)!==null&&R!==void 0?R:0)+((L=E.right)!==null&&L!==void 0?L:0);var b,_;g.height+=((b=E.top)!==null&&b!==void 0?b:0)+((_=E.bottom)!==null&&_!==void 0?_:0);let M=ue(l),H=Q(r),w=Q(a),T=r.tagName==="BODY"?B(a):ee(a,r);return a.tagName==="HTML"&&r.tagName==="BODY"&&(w.scroll.top=0,w.scroll.left=0),ge(e,m,g,M,E,i,f,H,w,T,h,s,d,u,$,p)}function B(t){let{top:e,left:n,width:o,height:l}=t.getBoundingClientRect(),{scrollTop:i,scrollLeft:f,clientTop:r,clientLeft:h}=document.documentElement;return{top:e+i-r,left:n+f-h,width:o,height:l}}function ee(t,e){let n=window.getComputedStyle(t),o;if(n.position==="fixed"){let{top:l,left:i,width:f,height:r}=t.getBoundingClientRect();o={top:l,left:i,width:f,height:r}}else{o=B(t);let l=B(e),i=window.getComputedStyle(e);l.top+=(parseInt(i.borderTopWidth,10)||0)-e.scrollTop,l.left+=(parseInt(i.borderLeftWidth,10)||0)-e.scrollLeft,o.top-=l.top,o.left-=l.left}return o.top-=parseInt(n.marginTop,10)||0,o.left-=parseInt(n.marginLeft,10)||0,o}function he(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!te(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!te(e);)e=e.parentElement;return e||document.documentElement}function te(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const ve=new WeakMap;function be(t){let{triggerRef:e,isOpen:n,onClose:o}=t;I.useEffect(()=>{if(!n||o===null)return;let l=i=>{let f=i.target;if(!e.current||f instanceof Node&&!f.contains(e.current)||i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement)return;let r=o||ve.get(e.current);r&&r()};return window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("scroll",l,!0)}},[n,o,e])}let x=typeof document<"u"?window.visualViewport:null;function Re(t){let{direction:e}=fe(),{arrowSize:n=0,targetRef:o,overlayRef:l,scrollRef:i=l,placement:f="bottom",containerPadding:r=12,shouldFlip:h=!0,boundaryElement:s=typeof document<"u"?document.body:null,offset:u=0,crossOffset:$=0,shouldUpdatePosition:p=!0,isOpen:a=!0,onClose:c,maxHeight:v,arrowBoundaryOffset:d=0}=t,[m,g]=I.useState(null),E=[p,f,l.current,o.current,i.current,r,h,s,u,$,a,e,v,d,n],R=I.useRef(x==null?void 0:x.scale);I.useEffect(()=>{a&&(R.current=x==null?void 0:x.scale)},[a]);let L=I.useCallback(()=>{if(p===!1||!a||!l.current||!o.current||!s||(x==null?void 0:x.scale)!==R.current)return;let w=null;if(i.current&&i.current.contains(document.activeElement)){var T;let P=(T=document.activeElement)===null||T===void 0?void 0:T.getBoundingClientRect(),F=i.current.getBoundingClientRect();var z;if(w={type:"top",offset:((z=P==null?void 0:P.top)!==null&&z!==void 0?z:0)-F.top},w.offset>F.height/2){w.type="bottom";var O;w.offset=((O=P==null?void 0:P.bottom)!==null&&O!==void 0?O:0)-F.bottom}}let S=l.current;if(!v&&l.current){var k;S.style.top="0px",S.style.bottom="";var N;S.style.maxHeight=((N=(k=window.visualViewport)===null||k===void 0?void 0:k.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let A=$e({placement:we(f,e),overlayNode:l.current,targetNode:o.current,scrollNode:i.current||l.current,padding:r,shouldFlip:h,boundaryElement:s,offset:u,crossOffset:$,maxHeight:v,arrowSize:n,arrowBoundaryOffset:d});if(A.position){if(S.style.top="",S.style.bottom="",S.style.left="",S.style.right="",Object.keys(A.position).forEach(P=>S.style[P]=A.position[P]+"px"),S.style.maxHeight=A.maxHeight!=null?A.maxHeight+"px":"",w&&document.activeElement&&i.current){let P=document.activeElement.getBoundingClientRect(),F=i.current.getBoundingClientRect(),Z=P[w.type]-F[w.type];i.current.scrollTop+=Z-w.offset}g(A)}},E);j(L,E),xe(L),K({ref:l,onResize:L}),K({ref:o,onResize:L});let b=I.useRef(!1);j(()=>{let w,T=()=>{b.current=!0,clearTimeout(w),w=setTimeout(()=>{b.current=!1},500),L()},z=()=>{b.current&&T()};return x==null||x.addEventListener("resize",T),x==null||x.addEventListener("scroll",z),()=>{x==null||x.removeEventListener("resize",T),x==null||x.removeEventListener("scroll",z)}},[L]);let _=I.useCallback(()=>{b.current||c==null||c()},[c,b]);be({triggerRef:o,isOpen:a,onClose:c&&_});var M,H;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...m==null?void 0:m.position,maxHeight:(M=m==null?void 0:m.maxHeight)!==null&&M!==void 0?M:"100vh"}},placement:(H=m==null?void 0:m.placement)!==null&&H!==void 0?H:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:m==null?void 0:m.arrowOffsetLeft,top:m==null?void 0:m.arrowOffsetTop}},updatePosition:L}}function xe(t){j(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function we(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function ze(t){let[e,n]=de(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const o=I.useCallback(()=>{n(!0)},[n]),l=I.useCallback(()=>{n(!1)},[n]),i=I.useCallback(()=>{n(!e)},[n,e]);return{isOpen:e,setOpen:n,open:o,close:l,toggle:i}}export{ze as $,Re as a,K as b,ve as c};
