import{$ as x,b as M,e as R,k as L,f as y,j as z}from"./utils-Dj64B4Ck.js";import{b as H,c as I,d as A,e as B,f as g,g as F,h as N}from"./Dialog-BkMCqRU4.js";import{b as O}from"./useFocusRing-CYwfk9cE.js";import{$ as V}from"./scrollIntoView-CtWAMHuk.js";import{c as v}from"./SelectionManager-CCLf1y3R.js";import{q as C,r as o,R as $}from"./iframe-Chekwr6M.js";import{$ as E,a as P}from"./animation-mznppo_U.js";import{a as W}from"./OverlayArrow-C_kKr4TA.js";let l=typeof document<"u"&&window.visualViewport;function j(){let t=C(),[e,i]=o.useState(()=>t?{width:0,height:0}:w());return o.useEffect(()=>{let a=()=>{l&&l.scale>1||i(d=>{let n=w();return n.width===d.width&&n.height===d.height?d:n})},r,f=d=>{l&&l.scale>1||v(d.target)&&(r=requestAnimationFrame(()=>{(!document.activeElement||!v(document.activeElement))&&i(n=>{let s={width:window.innerWidth,height:window.innerHeight};return s.width===n.width&&s.height===n.height?n:s})}))};return window.addEventListener("blur",f,!0),l?l.addEventListener("resize",a):window.addEventListener("resize",a),()=>{cancelAnimationFrame(r),window.removeEventListener("blur",f,!0),l?l.removeEventListener("resize",a):window.removeEventListener("resize",a)}},[]),e}function w(){return{width:l?l.width*l.scale:window.innerWidth,height:l?l.height*l.scale:window.innerHeight}}function q(t,e,i){let{overlayProps:a,underlayProps:r}=H({...t,isOpen:e.isOpen,onClose:e.close},i);return I({isDisabled:!e.isOpen}),A(),o.useEffect(()=>{if(e.isOpen&&i.current)return B([i.current],{shouldUseInert:!0})},[e.isOpen,i]),{modalProps:x(a),underlayProps:r}}const U=o.createContext(null),h=o.createContext(null),te=o.forwardRef(function(e,i){if(o.useContext(h))return $.createElement(p,{...e,modalRef:i},e.children);let{isDismissable:r,isKeyboardDismissDisabled:f,isOpen:d,defaultOpen:n,onOpenChange:s,children:c,isEntering:u,isExiting:m,UNSTABLE_portalContainer:b,shouldCloseOnInteractOutside:S,...D}=e;return $.createElement(K,{isDismissable:r,isKeyboardDismissDisabled:f,isOpen:d,defaultOpen:n,onOpenChange:s,isEntering:u,isExiting:m,UNSTABLE_portalContainer:b,shouldCloseOnInteractOutside:S},$.createElement(p,{...D,modalRef:i},c))});function k(t,e){[t,e]=M(t,e,U);let i=o.useContext(g),a=W(t),r=t.isOpen!=null||t.defaultOpen!=null||!i?a:i,f=R(e),d=o.useRef(null),n=E(f,r.isOpen),s=E(d,r.isOpen),c=n||s||t.isExiting||!1,u=C();return!r.isOpen&&!c||u?null:$.createElement(T,{...t,state:r,isExiting:c,overlayRef:f,modalRef:d})}const K=o.forwardRef(k);function T({UNSTABLE_portalContainer:t,...e}){let i=e.modalRef,{state:a}=e,{modalProps:r,underlayProps:f}=q(e,a,i),d=P(e.overlayRef)||e.isEntering||!1,n=y({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:d,isExiting:e.isExiting,state:a}}),s=j(),c;if(typeof document<"u"){let m=V(document.body)?document.body:document.scrollingElement||document.documentElement,b=m.getBoundingClientRect().height%1;c=m.scrollHeight-b}let u={...n.style,"--visual-viewport-height":s.height+"px","--page-height":c!==void 0?c+"px":void 0};return $.createElement(N,{isExiting:e.isExiting,portalContainer:t},$.createElement("div",{...x(O(e,{global:!0}),f),...n,style:u,ref:e.overlayRef,"data-entering":d||void 0,"data-exiting":e.isExiting||void 0},$.createElement(z,{values:[[h,{modalProps:r,modalRef:i,isExiting:e.isExiting,isDismissable:e.isDismissable}],[g,a]]},n.children)))}function p(t){let{modalProps:e,modalRef:i,isExiting:a,isDismissable:r}=o.useContext(h),f=o.useContext(g),d=o.useMemo(()=>L(t.modalRef,i),[t.modalRef,i]),n=R(d),s=P(n),c=y({...t,defaultClassName:"react-aria-Modal",values:{isEntering:s,isExiting:a,state:f}});return $.createElement("div",{...x(O(t,{global:!0}),e),...c,ref:n,"data-entering":s||void 0,"data-exiting":a||void 0},r&&$.createElement(F,{onDismiss:f.close}),c.children)}export{K as $,te as a};
