import{o as ee,p as V,q as S,r as m,s as te,t as re,u as ne,v as L,w as oe,j as ie,x as le}from"./useFocusRing-EcsuLChJ.js";import{d as g,f as ae,a as ue,$ as ce}from"./utils-BjmDDRvF.js";import{r as p,e as y}from"./iframe-eh8mAhOf.js";import{r as B}from"./index-BsAkrju0.js";class de{get currentNode(){return this._currentNode}set currentNode(e){if(!V(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const t=[];let n=e,o=e;for(this._currentNode=e;n&&n!==this.root;)if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const a=n,i=this._doc.createTreeWalker(a,this.whatToShow,{acceptNode:this._acceptNode});t.push(i),i.currentNode=o,this._currentSetFor.add(i),n=o=a.host}else n=n.parentNode;const l=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});t.push(l),l.currentNode=o,this._currentSetFor.add(l),this._walkerStack=t}get doc(){return this._doc}firstChild(){let e=this.currentNode,t=this.nextNode();return V(e,t)?(t&&(this.currentNode=t),t):(this.currentNode=e,null)}lastChild(){let t=this._walkerStack[0].lastChild();return t&&(this.currentNode=t),t}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var t;let o;if(typeof this.filter=="function"?o=this.filter(e):!((t=this.filter)===null||t===void 0)&&t.acceptNode&&(o=this.filter.acceptNode(e)),o===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let l=this.nextNode();return l&&(this.currentNode=l),l}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let n=this.nextNode();return n&&(this.currentNode=n),n}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let o=this.previousNode();return o&&(this.currentNode=o),o}else return null;return null}const t=e.previousNode();if(t){if(t.shadowRoot){var n;let l;if(typeof this.filter=="function"?l=this.filter(t):!((n=this.filter)===null||n===void 0)&&n.acceptNode&&(l=this.filter.acceptNode(t)),l===NodeFilter.FILTER_ACCEPT)return t&&(this.currentNode=t),t;let a=this.lastChild();return a&&(this.currentNode=a),a}return t&&(this.currentNode=t),t}else if(this._walkerStack.length>1){this._walkerStack.shift();let o=this.previousNode();return o&&(this.currentNode=o),o}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,t,n,o){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=a=>{if(a.nodeType===Node.ELEMENT_NODE){const b=a.shadowRoot;if(b){const u=this._doc.createTreeWalker(b,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(u),NodeFilter.FILTER_ACCEPT}else{var i;if(typeof this.filter=="function")return this.filter(a);if(!((i=this.filter)===null||i===void 0)&&i.acceptNode)return this.filter.acceptNode(a);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=t,this.filter=o??null,this.whatToShow=n??NodeFilter.SHOW_ALL,this._currentNode=t,this._walkerStack.unshift(e.createTreeWalker(t,n,this._acceptNode));const l=t.shadowRoot;if(l){const a=this._doc.createTreeWalker(l,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(a)}}}function se(r,e,t,n){return ee()?new de(r,e,t,n):r.createTreeWalker(e,t,n)}const J=y.createContext(null),K="react-aria-focus-scope-restore";let v=null;function ge(r){let{children:e,contain:t,restoreFocus:n,autoFocus:o}=r,l=p.useRef(null),a=p.useRef(null),i=p.useRef([]),{parentNode:b}=p.useContext(J)||{},u=p.useMemo(()=>new q({scopeRef:i}),[i]);g(()=>{let f=b||N.root;if(N.getTreeNode(f.scopeRef)&&v&&!I(v,f.scopeRef)){let s=N.getTreeNode(v);s&&(f=s)}f.addChild(u),N.addNode(u)},[u,b]),g(()=>{let f=N.getTreeNode(i);f&&(f.contain=!!t)},[t]),g(()=>{var f;let s=(f=l.current)===null||f===void 0?void 0:f.nextSibling,h=[],x=k=>k.stopPropagation();for(;s&&s!==a.current;)h.push(s),s.addEventListener(K,x),s=s.nextSibling;return i.current=h,()=>{for(let k of h)k.removeEventListener(K,x)}},[e]),Ne(i,n,t),he(i,t),pe(i,n,t),ve(i,o),p.useEffect(()=>{const f=S(m(i.current?i.current[0]:void 0));let s=null;if(T(f,i.current)){for(let h of N.traverse())h.scopeRef&&T(f,h.scopeRef.current)&&(s=h);s===N.getTreeNode(i)&&(v=s.scopeRef)}},[i]),g(()=>()=>{var f,s,h;let x=(h=(s=N.getTreeNode(i))===null||s===void 0||(f=s.parent)===null||f===void 0?void 0:f.scopeRef)!==null&&h!==void 0?h:null;(i===v||I(i,v))&&(!x||N.getTreeNode(x))&&(v=x),N.removeTreeNode(i)},[i]);let d=p.useMemo(()=>fe(i),[]),c=p.useMemo(()=>({focusManager:d,parentNode:u}),[u,d]);return y.createElement(J.Provider,{value:c},y.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:l}),e,y.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:a}))}function fe(r){return{focusNext(e={}){let t=r.current,{from:n,tabbable:o,wrap:l,accept:a}=e;var i;let b=n||S(m((i=t[0])!==null&&i!==void 0?i:void 0)),u=t[0].previousElementSibling,d=C(t),c=w(d,{tabbable:o,accept:a},t);c.currentNode=T(b,t)?b:u;let f=c.nextNode();return!f&&l&&(c.currentNode=u,f=c.nextNode()),f&&$(f,!0),f},focusPrevious(e={}){let t=r.current,{from:n,tabbable:o,wrap:l,accept:a}=e;var i;let b=n||S(m((i=t[0])!==null&&i!==void 0?i:void 0)),u=t[t.length-1].nextElementSibling,d=C(t),c=w(d,{tabbable:o,accept:a},t);c.currentNode=T(b,t)?b:u;let f=c.previousNode();return!f&&l&&(c.currentNode=u,f=c.previousNode()),f&&$(f,!0),f},focusFirst(e={}){let t=r.current,{tabbable:n,accept:o}=e,l=C(t),a=w(l,{tabbable:n,accept:o},t);a.currentNode=t[0].previousElementSibling;let i=a.nextNode();return i&&$(i,!0),i},focusLast(e={}){let t=r.current,{tabbable:n,accept:o}=e,l=C(t),a=w(l,{tabbable:n,accept:o},t);a.currentNode=t[t.length-1].nextElementSibling;let i=a.previousNode();return i&&$(i,!0),i}}}function C(r){return r[0].parentElement}function A(r){let e=N.getTreeNode(v);for(;e&&e.scopeRef!==r;){if(e.contain)return!1;e=e.parent}return!0}function be(r){if(r.checked)return!0;let e=[];if(!r.form)e=[...m(r).querySelectorAll(`input[type="radio"][name="${CSS.escape(r.name)}"]`)].filter(l=>!l.form);else{var t,n;let l=(n=r.form)===null||n===void 0||(t=n.elements)===null||t===void 0?void 0:t.namedItem(r.name);e=[...l??[]]}return e?!e.some(l=>l.checked):!1}function he(r,e){let t=p.useRef(void 0),n=p.useRef(void 0);g(()=>{let o=r.current;if(!e){n.current&&(cancelAnimationFrame(n.current),n.current=void 0);return}const l=m(o?o[0]:void 0);let a=u=>{if(u.key!=="Tab"||u.altKey||u.ctrlKey||u.metaKey||!A(r)||u.isComposing)return;let d=S(l),c=r.current;if(!c||!T(d,c))return;let f=C(c),s=w(f,{tabbable:!0},c);if(!d)return;s.currentNode=d;let h=u.shiftKey?s.previousNode():s.nextNode();h||(s.currentNode=u.shiftKey?c[c.length-1].nextElementSibling:c[0].previousElementSibling,h=u.shiftKey?s.previousNode():s.nextNode()),u.preventDefault(),h&&$(h,!0)},i=u=>{(!v||I(v,r))&&T(L(u),r.current)?(v=r,t.current=L(u)):A(r)&&!R(L(u),r)?t.current?t.current.focus():v&&v.current&&W(v.current):A(r)&&(t.current=L(u))},b=u=>{n.current&&cancelAnimationFrame(n.current),n.current=requestAnimationFrame(()=>{let d=le(),c=(d==="virtual"||d===null)&&oe()&&ie(),f=S(l);if(!c&&f&&A(r)&&!R(f,r)){v=r;let h=L(u);if(h&&h.isConnected){var s;t.current=h,(s=t.current)===null||s===void 0||s.focus()}else v.current&&W(v.current)}})};return l.addEventListener("keydown",a,!1),l.addEventListener("focusin",i,!1),o==null||o.forEach(u=>u.addEventListener("focusin",i,!1)),o==null||o.forEach(u=>u.addEventListener("focusout",b,!1)),()=>{l.removeEventListener("keydown",a,!1),l.removeEventListener("focusin",i,!1),o==null||o.forEach(u=>u.removeEventListener("focusin",i,!1)),o==null||o.forEach(u=>u.removeEventListener("focusout",b,!1))}},[r,e]),g(()=>()=>{n.current&&cancelAnimationFrame(n.current)},[n])}function G(r){return R(r)}function T(r,e){return!r||!e?!1:e.some(t=>t.contains(r))}function R(r,e=null){if(r instanceof Element&&r.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:t}of N.traverse(N.getTreeNode(e)))if(t&&T(r,t.current))return!0;return!1}function Se(r){return R(r,v)}function I(r,e){var t;let n=(t=N.getTreeNode(e))===null||t===void 0?void 0:t.parent;for(;n;){if(n.scopeRef===r)return!0;n=n.parent}return!1}function $(r,e=!1){if(r!=null&&!e)try{ne(r)}catch{}else if(r!=null)try{r.focus()}catch{}}function X(r,e=!0){let t=r[0].previousElementSibling,n=C(r),o=w(n,{tabbable:e},r);o.currentNode=t;let l=o.nextNode();return e&&!l&&(n=C(r),o=w(n,{tabbable:!1},r),o.currentNode=t,l=o.nextNode()),l}function W(r,e=!0){$(X(r,e))}function ve(r,e){const t=y.useRef(e);p.useEffect(()=>{if(t.current){v=r;const n=m(r.current?r.current[0]:void 0);!T(S(n),v.current)&&r.current&&W(r.current)}t.current=!1},[r])}function Ne(r,e,t){g(()=>{if(e||t)return;let n=r.current;const o=m(n?n[0]:void 0);let l=a=>{let i=L(a);T(i,r.current)?v=r:G(i)||(v=null)};return o.addEventListener("focusin",l,!1),n==null||n.forEach(a=>a.addEventListener("focusin",l,!1)),()=>{o.removeEventListener("focusin",l,!1),n==null||n.forEach(a=>a.removeEventListener("focusin",l,!1))}},[r,e,t])}function H(r){let e=N.getTreeNode(v);for(;e&&e.scopeRef!==r;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===r}function pe(r,e,t){const n=p.useRef(typeof document<"u"?S(m(r.current?r.current[0]:void 0)):null);g(()=>{let o=r.current;const l=m(o?o[0]:void 0);if(!e||t)return;let a=()=>{(!v||I(v,r))&&T(S(l),r.current)&&(v=r)};return l.addEventListener("focusin",a,!1),o==null||o.forEach(i=>i.addEventListener("focusin",a,!1)),()=>{l.removeEventListener("focusin",a,!1),o==null||o.forEach(i=>i.removeEventListener("focusin",a,!1))}},[r,t]),g(()=>{const o=m(r.current?r.current[0]:void 0);if(!e)return;let l=a=>{if(a.key!=="Tab"||a.altKey||a.ctrlKey||a.metaKey||!A(r)||a.isComposing)return;let i=o.activeElement;if(!R(i,r)||!H(r))return;let b=N.getTreeNode(r);if(!b)return;let u=b.nodeToRestore,d=w(o.body,{tabbable:!0});d.currentNode=i;let c=a.shiftKey?d.previousNode():d.nextNode();if((!u||!u.isConnected||u===o.body)&&(u=void 0,b.nodeToRestore=void 0),(!c||!R(c,r))&&u){d.currentNode=u;do c=a.shiftKey?d.previousNode():d.nextNode();while(R(c,r));a.preventDefault(),a.stopPropagation(),c?$(c,!0):G(u)?$(u,!0):i.blur()}};return t||o.addEventListener("keydown",l,!0),()=>{t||o.removeEventListener("keydown",l,!0)}},[r,e,t]),g(()=>{const o=m(r.current?r.current[0]:void 0);if(!e)return;let l=N.getTreeNode(r);if(l){var a;return l.nodeToRestore=(a=n.current)!==null&&a!==void 0?a:void 0,()=>{let i=N.getTreeNode(r);if(!i)return;let b=i.nodeToRestore,u=S(o);if(e&&b&&(u&&R(u,r)||u===o.body&&H(r))){let d=N.clone();requestAnimationFrame(()=>{if(o.activeElement===o.body){let c=d.getTreeNode(r);for(;c;){if(c.nodeToRestore&&c.nodeToRestore.isConnected){j(c.nodeToRestore);return}c=c.parent}for(c=d.getTreeNode(r);c;){if(c.scopeRef&&c.scopeRef.current&&N.getTreeNode(c.scopeRef)){let f=X(c.scopeRef.current,!0);j(f);return}c=c.parent}}})}}}},[r,e])}function j(r){r.dispatchEvent(new CustomEvent(K,{bubbles:!0,cancelable:!0}))&&$(r)}function w(r,e,t){let n=e!=null&&e.tabbable?te:re,o=(r==null?void 0:r.nodeType)===Node.ELEMENT_NODE?r:null,l=m(o),a=se(l,r||l,NodeFilter.SHOW_ELEMENT,{acceptNode(i){var b;return!(e==null||(b=e.from)===null||b===void 0)&&b.contains(i)||e!=null&&e.tabbable&&i.tagName==="INPUT"&&i.getAttribute("type")==="radio"&&(!be(i)||a.currentNode.tagName==="INPUT"&&a.currentNode.type==="radio"&&a.currentNode.name===i.name)?NodeFilter.FILTER_REJECT:n(i)&&(!t||T(i,t))&&(!(e!=null&&e.accept)||e.accept(i))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(a.currentNode=e.from),a}function ke(r,e={}){return{focusNext(t={}){let n=r.current;if(!n)return null;let{from:o,tabbable:l=e.tabbable,wrap:a=e.wrap,accept:i=e.accept}=t,b=o||S(m(n)),u=w(n,{tabbable:l,accept:i});n.contains(b)&&(u.currentNode=b);let d=u.nextNode();return!d&&a&&(u.currentNode=n,d=u.nextNode()),d&&$(d,!0),d},focusPrevious(t=e){let n=r.current;if(!n)return null;let{from:o,tabbable:l=e.tabbable,wrap:a=e.wrap,accept:i=e.accept}=t,b=o||S(m(n)),u=w(n,{tabbable:l,accept:i});if(n.contains(b))u.currentNode=b;else{let c=D(u);return c&&$(c,!0),c??null}let d=u.previousNode();if(!d&&a){u.currentNode=n;let c=D(u);if(!c)return null;d=c}return d&&$(d,!0),d??null},focusFirst(t=e){let n=r.current;if(!n)return null;let{tabbable:o=e.tabbable,accept:l=e.accept}=t,i=w(n,{tabbable:o,accept:l}).nextNode();return i&&$(i,!0),i},focusLast(t=e){let n=r.current;if(!n)return null;let{tabbable:o=e.tabbable,accept:l=e.accept}=t,a=w(n,{tabbable:o,accept:l}),i=D(a);return i&&$(i,!0),i??null}}}function D(r){let e,t;do t=r.lastChild(),t&&(e=t);while(t);return e}class z{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,t,n){let o=this.fastMap.get(t??null);if(!o)return;let l=new q({scopeRef:e});o.addChild(l),l.parent=o,this.fastMap.set(e,l),n&&(l.nodeToRestore=n)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let t=this.fastMap.get(e);if(!t)return;let n=t.parent;for(let l of this.traverse())l!==t&&t.nodeToRestore&&l.nodeToRestore&&t.scopeRef&&t.scopeRef.current&&T(l.nodeToRestore,t.scopeRef.current)&&(l.nodeToRestore=t.nodeToRestore);let o=t.children;n&&(n.removeChild(t),o.size>0&&o.forEach(l=>n&&n.addChild(l))),this.fastMap.delete(t.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let t of e.children)yield*this.traverse(t)}clone(){var e;let t=new z;var n;for(let o of this.traverse())t.addTreeNode(o.scopeRef,(n=(e=o.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&n!==void 0?n:null,o.nodeToRestore);return t}constructor(){this.fastMap=new Map,this.root=new q({scopeRef:null}),this.fastMap.set(null,this.root)}}class q{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}let N=new z;const Y=p.createContext(null);function Re(r){let e=p.useRef({});return y.createElement(Y.Provider,{value:e},r.children)}const $e=p.forwardRef(function(e,t){let{name:n,isVisible:o=!0,children:l,className:a,style:i,...b}=e,[u,d]=p.useState(o?"visible":"hidden"),c=p.useContext(Y);if(!c)throw new Error("<SharedElement> must be rendered inside a <SharedElementTransition>");o&&u==="hidden"&&d("visible"),t=ae(t),g(()=>{let s=t.current,h=c.current,x=h[n],k=null;if(s&&o&&x){d("visible");let F=s.getAnimations(),M=x.style.map(([E,P])=>{let Q=s.style[E];if(E==="translate"){let U=x.rect,_=s.getBoundingClientRect(),Z=U.left-(_==null?void 0:_.left),O=U.top-(_==null?void 0:_.top);s.style.translate=`${Z}px ${O}px`}else s.style[E]=P;return[E,Q]});for(let E of s.getAnimations())F.includes(E)||E.cancel();k=requestAnimationFrame(()=>{k=null;for(let[E,P]of M)s.style[E]=P}),delete h[n]}else s&&o&&!x?(queueMicrotask(()=>B.flushSync(()=>d("entering"))),k=requestAnimationFrame(()=>{k=null,d("visible")})):s&&!o&&queueMicrotask(()=>{h[n]?(delete h[n],B.flushSync(()=>d("exiting")),Promise.all(s.getAnimations().map(F=>F.finished)).then(()=>d("hidden")).catch(()=>{})):d("hidden")});return()=>{if(k!=null&&cancelAnimationFrame(k),s&&s.isConnected&&!s.hasAttribute("data-exiting")){let F=window.getComputedStyle(s);if(F.transitionProperty!=="none"){let M=F.transitionProperty.split(/\s*,\s*/);h[n]={rect:s.getBoundingClientRect(),style:M.map(E=>[E,F[E]])}}}}},[t,c,n,o]);let f=ue({children:l,className:a,style:i,values:{isEntering:u==="entering",isExiting:u==="exiting"}});return u==="hidden"?null:y.createElement("div",{...b,...f,ref:t,"data-entering":u==="entering"||void 0,"data-exiting":u==="exiting"||void 0})}),me=p.createContext({isSelected:!1}),ye=p.forwardRef(function(e,t){[e,t]=ce(e,t,me);let{isSelected:n,...o}=e;return y.createElement($e,{...o,ref:t,className:e.className||"react-aria-SelectionIndicator",name:"SelectionIndicator",isVisible:n})});export{w as $,me as a,ge as b,Re as c,ke as d,ye as e,Se as f};
