import{$ as ne,a as re,b as N,c as de,d as le,e as ie}from"./Collection-Af87zMws.js";import{c as Q,$ as H,e as G,m as se,a as ce,h as R,n as ue,b as A,l as X,j as fe,o as $e}from"./utils-Dv9Ux5aE.js";import{$ as T,a as be,b as pe,c as Y}from"./DragAndDrop-sISFPnlb.js";import{$ as ge,a as me,b as xe,c as he,d as ve}from"./Separator-CXf_HK-9.js";import{a as Pe}from"./Text-D0cNLqf0.js";import{$ as _}from"./filterDOMProps-BSfnXAP7.js";import{r as l,R as f}from"./index-BbAIUH2N.js";import{$ as De,a as ye}from"./useListState-BjXgCBdD.js";import{$ as Se}from"./context-oTIQb5ND.js";import{$ as ke}from"./useCollator-5m9ED1_d.js";import{$ as Fe}from"./ListKeyboardDelegate-CS8_-y6Q.js";import{c as Ce,r as we,s as Ee,a as Z,t as J,$ as He}from"./useFocusRing-CPQALXIu.js";import{$ as Me}from"./useLabel-BAqrTMfP.js";import{c as Be}from"./usePress-pM6mZWXi.js";import{d as Ve}from"./SelectionManager-amPxWGCO.js";import{a as Ie}from"./FocusScope-C0EWTSbR.js";const K=new WeakMap;function Ae(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function Te(o,e){let a=K.get(o);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Ae(e)}`}function _e(o,e,a){let n=_(o,{labelable:!0}),d=o.selectionBehavior||"toggle",r=o.linkBehavior||(d==="replace"?"action":"override");d==="toggle"&&r==="action"&&(r="override");let{listProps:t}=ge({...o,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:s}=Ce({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),b=Q(o.id);K.set(e,{id:b,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:r});let{labelProps:$,fieldProps:c}=Me({...o,id:b,labelElementType:"span"});return{labelProps:$,listBoxProps:H(n,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...H(c,t)})}}function Le(o,e,a){var n,d;let{key:r}=o,t=K.get(e);var s;let b=(s=o.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(r);var $;let c=($=o.isSelected)!==null&&$!==void 0?$:e.selectionManager.isSelected(r);var g;let i=(g=o.shouldSelectOnPressUp)!==null&&g!==void 0?g:t==null?void 0:t.shouldSelectOnPressUp;var m;let h=(m=o.shouldFocusOnHover)!==null&&m!==void 0?m:t==null?void 0:t.shouldFocusOnHover;var x;let p=(x=o.shouldUseVirtualFocus)!==null&&x!==void 0?x:t==null?void 0:t.shouldUseVirtualFocus;var v;let S=(v=o.isVirtualized)!==null&&v!==void 0?v:t==null?void 0:t.isVirtualized,k=G(),M=G(),y={role:"option","aria-disabled":b||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};we()&&Ee()||(y["aria-label"]=o["aria-label"],y["aria-labelledby"]=k,y["aria-describedby"]=M);let u=e.collection.getItem(r);if(S){let D=Number(u==null?void 0:u.index);y["aria-posinset"]=Number.isNaN(D)?void 0:D+1,y["aria-setsize"]=me(e.collection)}let B=t!=null&&t.onAction?()=>{var D;return t==null||(D=t.onAction)===null||D===void 0?void 0:D.call(t,r)}:void 0,V=Te(e,r),{itemProps:U,isPressed:C,isFocused:P,hasAction:F,allowsSelection:w}=Ve({selectionManager:e.selectionManager,key:r,ref:a,shouldSelectOnPressUp:i,allowsDifferentPressOrigin:i&&h,isVirtualized:S,shouldUseVirtualFocus:p,isDisabled:b,onAction:B||!(u==null||(n=u.props)===null||n===void 0)&&n.onAction?se(u==null||(d=u.props)===null||d===void 0?void 0:d.onAction,B):void 0,linkBehavior:t==null?void 0:t.linkBehavior,id:V}),{hoverProps:I}=Z({isDisabled:b||!h,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),E=_(u==null?void 0:u.props);delete E.id;let O=Be(u==null?void 0:u.props);return{optionProps:{...y,...H(E,U,I,O),id:V},labelProps:{id:k},descriptionProps:{id:M},isFocused:P,isFocusVisible:P&&e.selectionManager.isFocused&&J(),isSelected:c,isDisabled:b,isPressed:C,allowsSelection:w,hasAction:F}}function Ue(o){let{heading:e,"aria-label":a}=o,n=Q();return{itemProps:{role:"presentation"},headingProps:e?{id:n,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?n:void 0}}}const ee=l.createContext(null),L=l.createContext(null),dt=l.forwardRef(function(e,a){[e,a]=ce(e,a,ee);let n=l.useContext(L);return n?f.createElement(te,{state:n,props:e,listBoxRef:a}):f.createElement(ne,{content:f.createElement(re,e)},d=>f.createElement(Oe,{props:e,listBoxRef:a,collection:d}))});function Oe({props:o,listBoxRef:e,collection:a}){o={...o,collection:a,children:null,items:null};let{layoutDelegate:n}=l.useContext(N),d=De({...o,layoutDelegate:n});return f.createElement(te,{state:d,props:o,listBoxRef:e})}function te({state:o,props:e,listBoxRef:a}){let{filter:n,collectionProps:d,collectionRef:r}=l.useContext(xe)||{};e=l.useMemo(()=>d?{...e,...d}:e,[e,d]);let{dragAndDropHooks:t,layout:s="stack",orientation:b="vertical"}=e;a=R(l.useMemo(()=>ue(a,r!==void 0?r:null),[r,a]));let $=ye(o,n),{collection:c,selectionManager:g}=$,i=!!(t!=null&&t.useDraggableCollectionState),m=!!(t!=null&&t.useDroppableCollectionState),{direction:h}=Se(),{disabledBehavior:x,disabledKeys:p}=g,v=ke({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:k,dropTargetDelegate:M,CollectionRoot:y}=l.useContext(N),u=l.useMemo(()=>e.keyboardDelegate||new Fe({collection:c,collator:v,ref:a,disabledKeys:p,disabledBehavior:x,layout:s,orientation:b,direction:h,layoutDelegate:k}),[c,v,a,x,p,b,h,e.keyboardDelegate,s,k]),{listBoxProps:B}=_e({...e,shouldSelectOnPressUp:i||e.shouldSelectOnPressUp,keyboardDelegate:u,isVirtualized:S},$,a),V=l.useRef(i),U=l.useRef(m);l.useEffect(()=>{V.current!==i&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),U.current!==m&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[i,m]);let C,P,F,w=!1,I=null,E=l.useRef(null);if(i&&t){C=t.useDraggableCollectionState({collection:c,selectionManager:g,preview:t.renderDragPreview?E:void 0}),t.useDraggableCollection({},C,a);let z=t.DragPreview;I=t.renderDragPreview?f.createElement(z,{ref:E},t.renderDragPreview):null}if(m&&t){P=t.useDroppableCollectionState({collection:c,selectionManager:g});let z=t.dropTargetDelegate||M||new t.ListDropTargetDelegate(c,a,{orientation:b,layout:s,direction:h});F=t.useDroppableCollection({keyboardDelegate:u,dropTargetDelegate:z},P,a),w=P.isDropTarget({type:"root"})}let{focusProps:O,isFocused:D,isFocusVisible:W}=He(),j={isDropTarget:w,isEmpty:$.collection.size===0,isFocused:D,isFocusVisible:W,layout:e.layout||"stack",state:$},ae=A({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:j}),q=null;return $.collection.size===0&&e.renderEmptyState&&(q=f.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(j))),f.createElement(Ie,null,f.createElement("div",{..._(e),...H(B,O,F==null?void 0:F.collectionProps),...ae,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":$.collection.size===0||void 0,"data-focused":D||void 0,"data-focus-visible":W||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},f.createElement(X,{values:[[ee,e],[L,$],[T,{dragAndDropHooks:t,dragState:C,dropState:P}],[he,{elementType:"div"}],[be,{render:ze}],[de,{name:"ListBoxSection",render:oe}]]},f.createElement(y,{collection:c,scrollRef:a,persistedKeys:pe(g,t,P),renderDropIndicator:Y(t,P)})),q,I))}function oe(o,e,a,n="react-aria-ListBoxSection"){let d=l.useContext(L),{dragAndDropHooks:r,dropState:t}=l.useContext(T),{CollectionBranch:s}=l.useContext(N),[b,$]=fe();var c;let{headingProps:g,groupProps:i}=Ue({heading:$,"aria-label":(c=o["aria-label"])!==null&&c!==void 0?c:void 0}),m=A({defaultClassName:n,className:o.className,style:o.style,values:{}});return f.createElement("section",{..._(o),...i,...m,ref:e},f.createElement(ve.Provider,{value:{...g,ref:b}},f.createElement(s,{collection:d.collection,parent:a,renderDropIndicator:Y(r,t)})))}const lt=le("section",oe),it=ie("item",function(e,a,n){let d=R(a),r=l.useContext(L),{dragAndDropHooks:t,dragState:s,dropState:b}=l.useContext(T),{optionProps:$,labelProps:c,descriptionProps:g,...i}=Le({key:n.key,"aria-label":e==null?void 0:e["aria-label"]},r,d),{hoverProps:m,isHovered:h}=Z({isDisabled:!i.allowsSelection&&!i.hasAction,onHoverStart:n.props.onHoverStart,onHoverChange:n.props.onHoverChange,onHoverEnd:n.props.onHoverEnd}),x=null;s&&t&&(x=t.useDraggableItem({key:n.key},s));let p=null;b&&t&&(p=t.useDroppableItem({target:{type:"item",key:n.key,dropPosition:"on"}},b,d));let v=s&&s.isDragging(n.key),S=A({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...i,isHovered:h,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!s,isDragging:v,isDropTarget:p==null?void 0:p.isDropTarget}});l.useEffect(()=>{n.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[n.textValue]);let k=e.href?"a":"div";return f.createElement(k,{...H($,m,x==null?void 0:x.dragProps,p==null?void 0:p.dropProps),...S,ref:d,"data-allows-dragging":!!s||void 0,"data-selected":i.isSelected||void 0,"data-disabled":i.isDisabled||void 0,"data-hovered":h||void 0,"data-focused":i.isFocused||void 0,"data-focus-visible":i.isFocusVisible||void 0,"data-pressed":i.isPressed||void 0,"data-dragging":v||void 0,"data-drop-target":(p==null?void 0:p.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},f.createElement(X,{values:[[Pe,{slots:{[$e]:c,label:c,description:g}}]]},S.children))});function ze(o,e){e=R(e);let{dragAndDropHooks:a,dropState:n}=l.useContext(T),{dropIndicatorProps:d,isHidden:r,isDropTarget:t}=a.useDropIndicator(o,n,e);return r?null:f.createElement(Re,{...o,dropIndicatorProps:d,isDropTarget:t,ref:e})}function Ne(o,e){let{dropIndicatorProps:a,isDropTarget:n,...d}=o,r=A({...d,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:n}});return f.createElement("div",{...a,...r,role:"option",ref:e,"data-drop-target":n||void 0})}const Re=l.forwardRef(Ne);export{_e as $,Le as a,Ue as b,K as c,Te as d,ee as e,L as f,dt as g,it as h,lt as i};
