import{j as $,c as P,$ as v,g as E,n as h,s as D,D as x}from"./useFocusable-l7NaYEdB.js";import{r as l,R as s}from"./index-BbAIUH2N.js";import{a as w}from"./Button-CcMfRhGg.js";import{$ as S}from"./RSPContexts-CeCCo7XS.js";import{$ as N,b as A,d as I,c as k}from"./useDialog-BjNAMupN.js";import{r as M}from"./index-i7ZvCR4f.js";import{a as B}from"./Hidden-CwiKxbZj.js";import{a as H,b as K,$ as _,c as y}from"./useOverlayTriggerState-BEd1C1PF.js";function L(r,e=!0){let[n,t]=l.useState(!0),a=n&&e;return $(()=>{if(a&&r.current&&"getAnimations"in r.current)for(let i of r.current.getAnimations())i instanceof CSSTransition&&i.cancel()},[r,a]),C(r,a,l.useCallback(()=>t(!1),[])),a}function T(r,e){let[n,t]=l.useState(e?"open":"closed");switch(n){case"open":e||t("exiting");break;case"closed":case"exiting":e&&t("open");break}let a=n==="exiting";return C(r,a,l.useCallback(()=>{t(i=>i==="exiting"?"closed":i)},[])),a}function C(r,e,n){$(()=>{if(e&&r.current){if(!("getAnimations"in r.current)){n();return}let t=r.current.getAnimations();if(t.length===0){n();return}let a=!1;return Promise.all(t.map(i=>i.finished)).then(()=>{a||M.flushSync(()=>{n()})}).catch(()=>{}),()=>{a=!0}}},[r,e,n])}function W(r,e){let{triggerRef:n,popoverRef:t,isNonModal:a,isKeyboardDismissDisabled:i,shouldCloseOnInteractOutside:o,...d}=r,{overlayProps:c,underlayProps:b}=H({isOpen:e.isOpen&&!d["data-react-aria-top-layer"],onClose:e.close,shouldCloseOnBlur:!0,isDismissable:!a,isKeyboardDismissDisabled:i,shouldCloseOnInteractOutside:o},t),{overlayProps:m,arrowProps:f,placement:u}=K({...d,targetRef:n,overlayRef:t,isOpen:e.isOpen,onClose:a?e.close:null});return N({isDisabled:a||!e.isOpen}),$(()=>{if(e.isOpen&&!a&&t.current)return A([t.current])},[a,e.isOpen,t]),{popoverProps:P(c,m),arrowProps:f,underlayProps:b,placement:u}}const j=l.createContext({placement:"bottom"}),z=l.createContext(null),ee=l.forwardRef(function(e,n){[e,n]=v(e,n,z);let t=l.useContext(O),a=_(e),i=e.isOpen!=null||e.defaultOpen!=null||!t?a:t,o=T(n,i.isOpen)||e.isExiting||!1;if(B()){let c=e.children;return typeof c=="function"&&(c=c({trigger:e.trigger||null,placement:"bottom",isEntering:!1,isExiting:!1,defaultChildren:null})),s.createElement(s.Fragment,null,c)}return i&&!i.isOpen&&!o?null:s.createElement(F,{...e,triggerRef:e.triggerRef,state:i,popoverRef:n,isExiting:o})});function F({state:r,isExiting:e,UNSTABLE_portalContainer:n,...t}){let a=l.useRef(null),[i,o]=l.useState(0);$(()=>{a.current&&r.isOpen&&o(a.current.getBoundingClientRect().width)},[r.isOpen,a]);var d;let{popoverProps:c,underlayProps:b,arrowProps:m,placement:f}=W({...t,offset:(d=t.offset)!==null&&d!==void 0?d:8,arrowSize:i},r),u=t.popoverRef,p=L(u,!!f)||t.isEntering||!1,g=E({...t,defaultClassName:"react-aria-Popover",values:{trigger:t.trigger||null,placement:f,isEntering:p,isExiting:e}}),R={...c.style,...g.style};return s.createElement(I,{...t,isExiting:e,portalContainer:n},!t.isNonModal&&r.isOpen&&s.createElement("div",{"data-testid":"underlay",...b,style:{position:"fixed",inset:0}}),s.createElement("div",{...P(h(t),c),...g,ref:u,slot:t.slot||void 0,style:R,"data-trigger":t.trigger,"data-placement":f,"data-entering":p||void 0,"data-exiting":e||void 0},!t.isNonModal&&s.createElement(y,{onDismiss:r.close}),s.createElement(j.Provider,{value:{...m,placement:f,ref:a}},g.children),s.createElement(y,{onDismiss:r.close})))}const U=l.createContext(null),O=l.createContext(null),te=l.forwardRef(function(e,n){let t=e["aria-labelledby"];[e,n]=v(e,n,U);let{dialogProps:a,titleProps:i}=k({...e,"aria-labelledby":t},n),o=l.useContext(O);!a["aria-label"]&&!a["aria-labelledby"]&&(e["aria-labelledby"]?a["aria-labelledby"]=e["aria-labelledby"]:console.warn('If a Dialog does not contain a <Heading slot="title">, it must have an aria-label or aria-labelledby attribute for accessibility.'));let d=E({defaultClassName:"react-aria-Dialog",className:e.className,style:e.style,children:e.children,values:{close:(o==null?void 0:o.close)||(()=>{})}});return s.createElement("section",{...h(e),...a,...d,ref:n,slot:e.slot||void 0},s.createElement(D,{values:[[S,{slots:{[x]:{},title:{...i,level:2}}}],[w,{slots:{[x]:{},close:{onPress:()=>o==null?void 0:o.close()}}}]]},d.children))});export{O as $,z as a,ee as b,U as c,te as d};
