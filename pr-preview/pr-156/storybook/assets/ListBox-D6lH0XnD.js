import{$ as te,c as ae,d as re,a as z,e as le}from"./Collection-D2MgYaM2.js";import{n as A,a as ie,k as G,b as M,v as R,F as de,G as ne,D as se,d as j,H as W,p as ce,h as J,f as T,y as Q,c as ue,e as fe,B as be}from"./useFocusable-CUvAewCR.js";import{a as X,$ as _,b as pe,c as $e,d as Y}from"./DragAndDrop-ieluuKp3.js";import{r as n,R as u}from"./index-ClcD9ViR.js";import{e as ge,a as ve}from"./Text-CUSXFwf2.js";import{d as he,e as xe,f as De}from"./SelectionManager-Bf1YJvgz.js";import{$ as Z}from"./useCollator-ZDMRt11h.js";import{$ as Pe}from"./useListState-B3RSIWo1.js";import{$ as me}from"./context-C9cAOQ0o.js";import{a as ye}from"./FocusScope-Do-PkUts.js";const N=new WeakMap;function Se(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function ke(e,o){let r=N.get(e);if(!r)throw new Error("Unknown list");return`${r.id}-option-${Se(o)}`}function Be(e){let{selectionManager:o,collection:r,disabledKeys:t,ref:i,keyboardDelegate:l,layoutDelegate:a}=e,d=Z({usage:"search",sensitivity:"base"}),s=o.disabledBehavior,f=n.useMemo(()=>l||new X({collection:r,disabledKeys:t,disabledBehavior:s,ref:i,collator:d,layoutDelegate:a}),[l,a,r,t,i,d,s]),{collectionProps:b}=he({...e,ref:i,selectionManager:o,keyboardDelegate:f});return{listProps:b}}function Fe(e,o,r){let t=A(e,{labelable:!0}),i=e.selectionBehavior||"toggle",l=e.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&l==="action"&&(l="override");let{listProps:a}=Be({...e,ref:r,selectionManager:o.selectionManager,collection:o.collection,disabledKeys:o.disabledKeys,linkBehavior:l}),{focusWithinProps:d}=ie({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),s=G(e.id);N.set(o,{id:s,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:l});let{labelProps:f,fieldProps:b}=ge({...e,id:s,labelElementType:"span"});return{labelProps:f,listBoxProps:M(t,d,o.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...M(b,a)})}}const q=new WeakMap;function we(e){let o=q.get(e);if(o!=null)return o;let r=0,t=i=>{for(let l of i)l.type==="section"?t(xe(l,e)):r++};return t(e),q.set(e,r),r}function Ce(e,o,r){var t,i;let{key:l}=e,a=N.get(o);var d;let s=(d=e.isDisabled)!==null&&d!==void 0?d:o.selectionManager.isDisabled(l);var f;let b=(f=e.isSelected)!==null&&f!==void 0?f:o.selectionManager.isSelected(l);var v;let p=(v=e.shouldSelectOnPressUp)!==null&&v!==void 0?v:a==null?void 0:a.shouldSelectOnPressUp;var h;let S=(h=e.shouldFocusOnHover)!==null&&h!==void 0?h:a==null?void 0:a.shouldFocusOnHover;var g;let $=(g=e.shouldUseVirtualFocus)!==null&&g!==void 0?g:a==null?void 0:a.shouldUseVirtualFocus;var D;let P=(D=e.isVirtualized)!==null&&D!==void 0?D:a==null?void 0:a.isVirtualized,k=R(),H=R(),m={role:"option","aria-disabled":s||void 0,"aria-selected":o.selectionManager.selectionMode!=="none"?b:void 0};de()&&ne()||(m["aria-label"]=e["aria-label"],m["aria-labelledby"]=k,m["aria-describedby"]=H);let c=o.collection.getItem(l);if(P){let y=Number(c==null?void 0:c.index);m["aria-posinset"]=Number.isNaN(y)?void 0:y+1,m["aria-setsize"]=we(o.collection)}let x=a!=null&&a.onAction?()=>{var y;return a==null||(y=a.onAction)===null||y===void 0?void 0:y.call(a,l)}:void 0,{itemProps:B,isPressed:F,isFocused:w,hasAction:E,allowsSelection:U}=De({selectionManager:o.selectionManager,key:l,ref:r,shouldSelectOnPressUp:p,allowsDifferentPressOrigin:p&&S,isVirtualized:P,shouldUseVirtualFocus:$,isDisabled:s,onAction:x||!(c==null||(t=c.props)===null||t===void 0)&&t.onAction?se(c==null||(i=c.props)===null||i===void 0?void 0:i.onAction,x):void 0,linkBehavior:a==null?void 0:a.linkBehavior}),{hoverProps:V}=j({isDisabled:s||!S,onHoverStart(){W()||(o.selectionManager.setFocused(!0),o.selectionManager.setFocusedKey(l))}}),C=A(c==null?void 0:c.props);delete C.id;let I=ce(c==null?void 0:c.props);return{optionProps:{...m,...M(C,B,V,I),id:ke(o,l)},labelProps:{id:k},descriptionProps:{id:H},isFocused:w,isFocusVisible:w&&W(),isSelected:b,isDisabled:s,isPressed:F,allowsSelection:U,hasAction:E}}function Me(e){let{heading:o,"aria-label":r}=e,t=G();return{itemProps:{role:"presentation"},headingProps:o?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":r,"aria-labelledby":o?t:void 0}}}const He=n.createContext({}),Ee=n.createContext({}),ee=n.createContext(null),L=n.createContext(null);function Ve(e,o){[e,o]=ue(e,o,ee);let r=n.useContext(L);return r?u.createElement(oe,{state:r,props:e,listBoxRef:o}):u.createElement(ae,{content:u.createElement(re,e)},t=>u.createElement(Ie,{props:e,listBoxRef:o,collection:t}))}function Ie({props:e,listBoxRef:o,collection:r}){e={...e,collection:r,children:null,items:null};let{layoutDelegate:t}=n.useContext(z),i=Pe({...e,layoutDelegate:t});return u.createElement(oe,{state:i,props:e,listBoxRef:o})}const Je=n.forwardRef(Ve);function oe({state:e,props:o,listBoxRef:r}){let{dragAndDropHooks:t,layout:i="stack",orientation:l="vertical"}=o,{collection:a,selectionManager:d}=e,s=!!(t!=null&&t.useDraggableCollectionState),f=!!(t!=null&&t.useDroppableCollectionState),{direction:b}=me(),{disabledBehavior:v,disabledKeys:p}=d,h=Z({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:g,dropTargetDelegate:$,CollectionRoot:D}=n.useContext(z),P=n.useMemo(()=>o.keyboardDelegate||new X({collection:a,collator:h,ref:r,disabledKeys:p,disabledBehavior:v,layout:i,orientation:l,direction:b,layoutDelegate:g}),[a,h,r,v,p,l,b,o.keyboardDelegate,i,g]),{listBoxProps:k}=Fe({...o,shouldSelectOnPressUp:s||o.shouldSelectOnPressUp,keyboardDelegate:P,isVirtualized:S},e,r),H=n.useRef(s),m=n.useRef(f);n.useEffect(()=>{H.current!==s&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),m.current!==f&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[s,f]);let c,x,B,F=!1,w=null,E=n.useRef(null);if(s&&t){c=t.useDraggableCollectionState({collection:a,selectionManager:d,preview:t.renderDragPreview?E:void 0}),t.useDraggableCollection({},c,r);let O=t.DragPreview;w=t.renderDragPreview?u.createElement(O,{ref:E},t.renderDragPreview):null}if(f&&t){x=t.useDroppableCollectionState({collection:a,selectionManager:d});let O=t.dropTargetDelegate||$||new t.ListDropTargetDelegate(a,r,{orientation:l,layout:i,direction:b});B=t.useDroppableCollection({keyboardDelegate:P,dropTargetDelegate:O},x,r),F=x.isDropTarget({type:"root"})}let{focusProps:U,isFocused:V,isFocusVisible:C}=fe(),I={isDropTarget:F,isEmpty:e.collection.size===0,isFocused:V,isFocusVisible:C,layout:o.layout||"stack",state:e},y=T({className:o.className,style:o.style,defaultClassName:"react-aria-ListBox",values:I}),K=null;return e.collection.size===0&&o.renderEmptyState&&(K=u.createElement("div",{role:"option",style:{display:"contents"}},o.renderEmptyState(I))),u.createElement(ye,null,u.createElement("div",{...A(o),...M(k,U,B==null?void 0:B.collectionProps),...y,ref:r,slot:o.slot||void 0,onScroll:o.onScroll,"data-drop-target":F||void 0,"data-empty":e.collection.size===0||void 0,"data-focused":V||void 0,"data-focus-visible":C||void 0,"data-layout":o.layout||"stack","data-orientation":o.orientation||"vertical"},u.createElement(Q,{values:[[ee,o],[L,e],[_,{dragAndDropHooks:t,dragState:c,dropState:x}],[Ee,{elementType:"div"}],[pe,{render:Te}],[le,{name:"ListBoxSection",render:Ae}]]},u.createElement(D,{collection:a,scrollRef:r,persistedKeys:$e(d,t,x),renderDropIndicator:Y(t,x)})),K,w))}function Ae(e,o,r,t="react-aria-ListBoxSection"){let i=n.useContext(L),{dragAndDropHooks:l,dropState:a}=n.useContext(_),{CollectionBranch:d}=n.useContext(z),[s,f]=be();var b;let{headingProps:v,groupProps:p}=Me({heading:f,"aria-label":(b=e["aria-label"])!==null&&b!==void 0?b:void 0}),h=T({defaultClassName:t,className:e.className,style:e.style,values:{}});return u.createElement("section",{...A(e),...p,...h,ref:o},u.createElement(He.Provider,{value:{...v,ref:s}},u.createElement(d,{collection:i.collection,parent:r,renderDropIndicator:Y(l,a)})))}const Qe=te("item",function(o,r,t){let i=J(r),l=n.useContext(L),{dragAndDropHooks:a,dragState:d,dropState:s}=n.useContext(_),{optionProps:f,labelProps:b,descriptionProps:v,...p}=Ce({key:t.key,"aria-label":o==null?void 0:o["aria-label"]},l,i),{hoverProps:h,isHovered:S}=j({isDisabled:!p.allowsSelection&&!p.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),g=null;d&&a&&(g=a.useDraggableItem({key:t.key},d));let $=null;s&&a&&($=a.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},s,i));let D=d&&d.isDragging(t.key),P=T({...o,id:void 0,children:o.children,defaultClassName:"react-aria-ListBoxItem",values:{...p,isHovered:S,selectionMode:l.selectionManager.selectionMode,selectionBehavior:l.selectionManager.selectionBehavior,allowsDragging:!!d,isDragging:D,isDropTarget:$==null?void 0:$.isDropTarget}});n.useEffect(()=>{t.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[t.textValue]);let k=o.href?"a":"div";return u.createElement(k,{...M(f,h,g==null?void 0:g.dragProps,$==null?void 0:$.dropProps),...P,ref:i,"data-allows-dragging":!!d||void 0,"data-selected":p.isSelected||void 0,"data-disabled":p.isDisabled||void 0,"data-hovered":S||void 0,"data-focused":p.isFocused||void 0,"data-focus-visible":p.isFocusVisible||void 0,"data-pressed":p.isPressed||void 0,"data-dragging":D||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":l.selectionManager.selectionMode==="none"?void 0:l.selectionManager.selectionMode},u.createElement(Q,{values:[[ve,{slots:{label:b,description:v}}]]},P.children))});function Te(e,o){o=J(o);let{dragAndDropHooks:r,dropState:t}=n.useContext(_),{dropIndicatorProps:i,isHidden:l,isDropTarget:a}=r.useDropIndicator(e,t,o);return l?null:u.createElement(Le,{...e,dropIndicatorProps:i,isDropTarget:a,ref:o})}function _e(e,o){let{dropIndicatorProps:r,isDropTarget:t,...i}=e,l=T({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return u.createElement("div",{...r,...l,role:"option",ref:o,"data-drop-target":t||void 0})}const Le=n.forwardRef(_e);export{L as $,ee as a,Je as b,Qe as c,N as d,we as e,ke as f,Be as g};
