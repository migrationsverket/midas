import{$ as ae,a as ne,b as N,c as re,d as de}from"./Collection-DSX7ksCA.js";import{l as Q,f as H,h as G,m as le,$ as ie,k as R,n as se,d as A,e as X,b as ce,o as ue}from"./utils-B5vVULSi.js";import{$ as T,a as fe,b as pe,c as Y}from"./DragAndDrop-sISFPnlb.js";import{$ as be,a as $e,b as ge,c as me,d as he}from"./Separator--jQ6KEKV.js";import{a as ve}from"./Text-BfWS687k.js";import{$ as _}from"./filterDOMProps-BSfnXAP7.js";import{r as l,R as f}from"./index-BbAIUH2N.js";import{$ as xe,a as Pe}from"./useListState-ld2-F_XG.js";import{$ as De}from"./context-B5OQOlVG.js";import{$ as ye}from"./useCollator-DECUsGSp.js";import{$ as Se}from"./ListKeyboardDelegate-C7MmOkhr.js";import{c as ke,p as Fe,q as Ce,$ as Z,r as J,a as we}from"./useFocusRing-7U1UHDTh.js";import{$ as Ee}from"./useLabel-XbSNQJBa.js";import{d as He}from"./focusSafely-DzEZeR8D.js";import{d as Me}from"./SelectionManager-CH_UAKbc.js";import{a as Be}from"./FocusScope-BDcaQnsV.js";const K=new WeakMap;function Ve(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function Ie(o,e){let a=K.get(o);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Ve(e)}`}function Ae(o,e,a){let n=_(o,{labelable:!0}),d=o.selectionBehavior||"toggle",r=o.linkBehavior||(d==="replace"?"action":"override");d==="toggle"&&r==="action"&&(r="override");let{listProps:t}=be({...o,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:s}=ke({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),b=Q(o.id);K.set(e,{id:b,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:r});let{labelProps:p,fieldProps:c}=Ee({...o,id:b,labelElementType:"span"});return{labelProps:p,listBoxProps:H(n,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...H(c,t)})}}function Te(o,e,a){var n,d;let{key:r}=o,t=K.get(e);var s;let b=(s=o.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(r);var p;let c=(p=o.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(r);var g;let i=(g=o.shouldSelectOnPressUp)!==null&&g!==void 0?g:t==null?void 0:t.shouldSelectOnPressUp;var m;let v=(m=o.shouldFocusOnHover)!==null&&m!==void 0?m:t==null?void 0:t.shouldFocusOnHover;var h;let $=(h=o.shouldUseVirtualFocus)!==null&&h!==void 0?h:t==null?void 0:t.shouldUseVirtualFocus;var x;let S=(x=o.isVirtualized)!==null&&x!==void 0?x:t==null?void 0:t.isVirtualized,k=G(),M=G(),y={role:"option","aria-disabled":b||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};Fe()&&Ce()||(y["aria-label"]=o["aria-label"],y["aria-labelledby"]=k,y["aria-describedby"]=M);let u=e.collection.getItem(r);if(S){let D=Number(u==null?void 0:u.index);y["aria-posinset"]=Number.isNaN(D)?void 0:D+1,y["aria-setsize"]=$e(e.collection)}let B=t!=null&&t.onAction?()=>{var D;return t==null||(D=t.onAction)===null||D===void 0?void 0:D.call(t,r)}:void 0,V=Ie(e,r),{itemProps:U,isPressed:C,isFocused:P,hasAction:F,allowsSelection:w}=Me({selectionManager:e.selectionManager,key:r,ref:a,shouldSelectOnPressUp:i,allowsDifferentPressOrigin:i&&v,isVirtualized:S,shouldUseVirtualFocus:$,isDisabled:b,onAction:B||!(u==null||(n=u.props)===null||n===void 0)&&n.onAction?le(u==null||(d=u.props)===null||d===void 0?void 0:d.onAction,B):void 0,linkBehavior:t==null?void 0:t.linkBehavior,id:V}),{hoverProps:I}=Z({isDisabled:b||!v,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),E=_(u==null?void 0:u.props);delete E.id;let O=He(u==null?void 0:u.props);return{optionProps:{...y,...H(E,U,I,O),id:V},labelProps:{id:k},descriptionProps:{id:M},isFocused:P,isFocusVisible:P&&e.selectionManager.isFocused&&J(),isSelected:c,isDisabled:b,isPressed:C,allowsSelection:w,hasAction:F}}function _e(o){let{heading:e,"aria-label":a}=o,n=Q();return{itemProps:{role:"presentation"},headingProps:e?{id:n,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?n:void 0}}}const ee=l.createContext(null),L=l.createContext(null),rt=l.forwardRef(function(e,a){[e,a]=ie(e,a,ee);let n=l.useContext(L);return n?f.createElement(te,{state:n,props:e,listBoxRef:a}):f.createElement(ae,{content:f.createElement(ne,e)},d=>f.createElement(Le,{props:e,listBoxRef:a,collection:d}))});function Le({props:o,listBoxRef:e,collection:a}){o={...o,collection:a,children:null,items:null};let{layoutDelegate:n}=l.useContext(N),d=xe({...o,layoutDelegate:n});return f.createElement(te,{state:d,props:o,listBoxRef:e})}function te({state:o,props:e,listBoxRef:a}){let{filter:n,collectionProps:d,collectionRef:r}=l.useContext(ge)||{};e=l.useMemo(()=>d?{...e,...d}:e,[e,d]);let{dragAndDropHooks:t,layout:s="stack",orientation:b="vertical"}=e;a=R(l.useMemo(()=>se(a,r!==void 0?r:null),[r,a]));let p=Pe(o,n),{collection:c,selectionManager:g}=p,i=!!(t!=null&&t.useDraggableCollectionState),m=!!(t!=null&&t.useDroppableCollectionState),{direction:v}=De(),{disabledBehavior:h,disabledKeys:$}=g,x=ye({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:k,dropTargetDelegate:M,CollectionRoot:y}=l.useContext(N),u=l.useMemo(()=>e.keyboardDelegate||new Se({collection:c,collator:x,ref:a,disabledKeys:$,disabledBehavior:h,layout:s,orientation:b,direction:v,layoutDelegate:k}),[c,x,a,h,$,b,v,e.keyboardDelegate,s,k]),{listBoxProps:B}=Ae({...e,shouldSelectOnPressUp:i||e.shouldSelectOnPressUp,keyboardDelegate:u,isVirtualized:S},p,a),V=l.useRef(i),U=l.useRef(m);l.useEffect(()=>{V.current!==i&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),U.current!==m&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[i,m]);let C,P,F,w=!1,I=null,E=l.useRef(null);if(i&&t){C=t.useDraggableCollectionState({collection:c,selectionManager:g,preview:t.renderDragPreview?E:void 0}),t.useDraggableCollection({},C,a);let z=t.DragPreview;I=t.renderDragPreview?f.createElement(z,{ref:E},t.renderDragPreview):null}if(m&&t){P=t.useDroppableCollectionState({collection:c,selectionManager:g});let z=t.dropTargetDelegate||M||new t.ListDropTargetDelegate(c,a,{orientation:b,layout:s,direction:v});F=t.useDroppableCollection({keyboardDelegate:u,dropTargetDelegate:z},P,a),w=P.isDropTarget({type:"root"})}let{focusProps:O,isFocused:D,isFocusVisible:W}=we(),q={isDropTarget:w,isEmpty:p.collection.size===0,isFocused:D,isFocusVisible:W,layout:e.layout||"stack",state:p},oe=A({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:q}),j=null;return p.collection.size===0&&e.renderEmptyState&&(j=f.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(q))),f.createElement(Be,null,f.createElement("div",{..._(e),...H(B,O,F==null?void 0:F.collectionProps),...oe,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":p.collection.size===0||void 0,"data-focused":D||void 0,"data-focus-visible":W||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},f.createElement(X,{values:[[ee,e],[L,p],[T,{dragAndDropHooks:t,dragState:C,dropState:P}],[me,{elementType:"div"}],[fe,{render:Oe}],[re,{name:"ListBoxSection",render:Ue}]]},f.createElement(y,{collection:c,scrollRef:a,persistedKeys:pe(g,t,P),renderDropIndicator:Y(t,P)})),j,I))}function Ue(o,e,a,n="react-aria-ListBoxSection"){let d=l.useContext(L),{dragAndDropHooks:r,dropState:t}=l.useContext(T),{CollectionBranch:s}=l.useContext(N),[b,p]=ce();var c;let{headingProps:g,groupProps:i}=_e({heading:p,"aria-label":(c=o["aria-label"])!==null&&c!==void 0?c:void 0}),m=A({defaultClassName:n,className:o.className,style:o.style,values:{}});return f.createElement("section",{..._(o),...i,...m,ref:e},f.createElement(he.Provider,{value:{...g,ref:b}},f.createElement(s,{collection:d.collection,parent:a,renderDropIndicator:Y(r,t)})))}const dt=de("item",function(e,a,n){let d=R(a),r=l.useContext(L),{dragAndDropHooks:t,dragState:s,dropState:b}=l.useContext(T),{optionProps:p,labelProps:c,descriptionProps:g,...i}=Te({key:n.key,"aria-label":e==null?void 0:e["aria-label"]},r,d),{hoverProps:m,isHovered:v}=Z({isDisabled:!i.allowsSelection&&!i.hasAction,onHoverStart:n.props.onHoverStart,onHoverChange:n.props.onHoverChange,onHoverEnd:n.props.onHoverEnd}),h=null;s&&t&&(h=t.useDraggableItem({key:n.key},s));let $=null;b&&t&&($=t.useDroppableItem({target:{type:"item",key:n.key,dropPosition:"on"}},b,d));let x=s&&s.isDragging(n.key),S=A({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...i,isHovered:v,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!s,isDragging:x,isDropTarget:$==null?void 0:$.isDropTarget}});l.useEffect(()=>{n.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[n.textValue]);let k=e.href?"a":"div";return f.createElement(k,{...H(p,m,h==null?void 0:h.dragProps,$==null?void 0:$.dropProps),...S,ref:d,"data-allows-dragging":!!s||void 0,"data-selected":i.isSelected||void 0,"data-disabled":i.isDisabled||void 0,"data-hovered":v||void 0,"data-focused":i.isFocused||void 0,"data-focus-visible":i.isFocusVisible||void 0,"data-pressed":i.isPressed||void 0,"data-dragging":x||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},f.createElement(X,{values:[[ve,{slots:{[ue]:c,label:c,description:g}}]]},S.children))});function Oe(o,e){e=R(e);let{dragAndDropHooks:a,dropState:n}=l.useContext(T),{dropIndicatorProps:d,isHidden:r,isDropTarget:t}=a.useDropIndicator(o,n,e);return r?null:f.createElement(Ne,{...o,dropIndicatorProps:d,isDropTarget:t,ref:e})}function ze(o,e){let{dropIndicatorProps:a,isDropTarget:n,...d}=o,r=A({...d,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:n}});return f.createElement("div",{...a,...r,role:"option",ref:e,"data-drop-target":n||void 0})}const Ne=l.forwardRef(ze);export{Ae as $,Te as a,_e as b,K as c,Ie as d,ee as e,L as f,rt as g,dt as h};
