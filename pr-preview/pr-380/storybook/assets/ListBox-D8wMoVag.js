import{$ as oe,a as ne,b as N,c as re,d as de}from"./Collection-8zswMZr2.js";import{h as Q,b as E,d as G,m as le,$ as ie,g as R,n as se,a as A,l as X,j as ce,o as ue}from"./utils-fGMpyvF6.js";import{$ as T,a as fe,b as be,c as Y}from"./DragAndDrop-sISFPnlb.js";import{$ as pe,a as $e,b as ge,c as he,d as me}from"./Separator-Dru5Rsd-.js";import{a as ve}from"./Text-CLHHKsvT.js";import{c as _,e as xe,z as Pe,A as De,$ as Z,B as J,j as ye,a as Se}from"./useFocusRing-D234eI5d.js";import{r as l,R as f}from"./index-BbAIUH2N.js";import{$ as ke,a as Fe}from"./useListState-DD0aXFW1.js";import{$ as Ce}from"./context-gwlhO1hg.js";import{$ as we}from"./useCollator-BwOLflG5.js";import{$ as Be}from"./ListKeyboardDelegate-Cy2OSJKs.js";import{$ as Ee}from"./Label-C7YJVz0K.js";import{d as He}from"./SelectionManager-CpQyjLx-.js";import{a as Me}from"./FocusScope-BTvUdKNZ.js";const K=new WeakMap;function Ve(a){return typeof a=="string"?a.replace(/\s*/g,""):""+a}function Ie(a,e){let o=K.get(a);if(!o)throw new Error("Unknown list");return`${o.id}-option-${Ve(e)}`}function Ae(a,e,o){let n=_(a,{labelable:!0}),d=a.selectionBehavior||"toggle",r=a.linkBehavior||(d==="replace"?"action":"override");d==="toggle"&&r==="action"&&(r="override");let{listProps:t}=pe({...a,ref:o,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:s}=xe({onFocusWithin:a.onFocus,onBlurWithin:a.onBlur,onFocusWithinChange:a.onFocusChange}),p=Q(a.id);K.set(e,{id:p,shouldUseVirtualFocus:a.shouldUseVirtualFocus,shouldSelectOnPressUp:a.shouldSelectOnPressUp,shouldFocusOnHover:a.shouldFocusOnHover,isVirtualized:a.isVirtualized,onAction:a.onAction,linkBehavior:r});let{labelProps:b,fieldProps:c}=Ee({...a,id:p,labelElementType:"span"});return{labelProps:b,listBoxProps:E(n,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...E(c,t)})}}function Te(a,e,o){var n,d;let{key:r}=a,t=K.get(e);var s;let p=(s=a.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(r);var b;let c=(b=a.isSelected)!==null&&b!==void 0?b:e.selectionManager.isSelected(r);var g;let i=(g=a.shouldSelectOnPressUp)!==null&&g!==void 0?g:t==null?void 0:t.shouldSelectOnPressUp;var h;let v=(h=a.shouldFocusOnHover)!==null&&h!==void 0?h:t==null?void 0:t.shouldFocusOnHover;var m;let $=(m=a.shouldUseVirtualFocus)!==null&&m!==void 0?m:t==null?void 0:t.shouldUseVirtualFocus;var x;let S=(x=a.isVirtualized)!==null&&x!==void 0?x:t==null?void 0:t.isVirtualized,k=G(),H=G(),y={role:"option","aria-disabled":p||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};Pe()&&De()||(y["aria-label"]=a["aria-label"],y["aria-labelledby"]=k,y["aria-describedby"]=H);let u=e.collection.getItem(r);if(S){let D=Number(u==null?void 0:u.index);y["aria-posinset"]=Number.isNaN(D)?void 0:D+1,y["aria-setsize"]=$e(e.collection)}let M=t!=null&&t.onAction?()=>{var D;return t==null||(D=t.onAction)===null||D===void 0?void 0:D.call(t,r)}:void 0,V=Ie(e,r),{itemProps:U,isPressed:C,isFocused:P,hasAction:F,allowsSelection:w}=He({selectionManager:e.selectionManager,key:r,ref:o,shouldSelectOnPressUp:i,allowsDifferentPressOrigin:i&&v,isVirtualized:S,shouldUseVirtualFocus:$,isDisabled:p,onAction:M||!(u==null||(n=u.props)===null||n===void 0)&&n.onAction?le(u==null||(d=u.props)===null||d===void 0?void 0:d.onAction,M):void 0,linkBehavior:t==null?void 0:t.linkBehavior,id:V}),{hoverProps:I}=Z({isDisabled:p||!v,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),B=_(u==null?void 0:u.props);delete B.id;let z=ye(u==null?void 0:u.props);return{optionProps:{...y,...E(B,U,I,z),id:V},labelProps:{id:k},descriptionProps:{id:H},isFocused:P,isFocusVisible:P&&e.selectionManager.isFocused&&J(),isSelected:c,isDisabled:p,isPressed:C,allowsSelection:w,hasAction:F}}function _e(a){let{heading:e,"aria-label":o}=a,n=Q();return{itemProps:{role:"presentation"},headingProps:e?{id:n,role:"presentation"}:{},groupProps:{role:"group","aria-label":o,"aria-labelledby":e?n:void 0}}}const ee=l.createContext(null),L=l.createContext(null),ot=l.forwardRef(function(e,o){[e,o]=ie(e,o,ee);let n=l.useContext(L);return n?f.createElement(te,{state:n,props:e,listBoxRef:o}):f.createElement(oe,{content:f.createElement(ne,e)},d=>f.createElement(Le,{props:e,listBoxRef:o,collection:d}))});function Le({props:a,listBoxRef:e,collection:o}){a={...a,collection:o,children:null,items:null};let{layoutDelegate:n}=l.useContext(N),d=ke({...a,layoutDelegate:n});return f.createElement(te,{state:d,props:a,listBoxRef:e})}function te({state:a,props:e,listBoxRef:o}){let{filter:n,collectionProps:d,collectionRef:r}=l.useContext(ge)||{};e=l.useMemo(()=>d?{...e,...d}:e,[e,d]);let{dragAndDropHooks:t,layout:s="stack",orientation:p="vertical"}=e;o=R(l.useMemo(()=>se(o,r!==void 0?r:null),[r,o]));let b=Fe(a,n),{collection:c,selectionManager:g}=b,i=!!(t!=null&&t.useDraggableCollectionState),h=!!(t!=null&&t.useDroppableCollectionState),{direction:v}=Ce(),{disabledBehavior:m,disabledKeys:$}=g,x=we({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:k,dropTargetDelegate:H,CollectionRoot:y}=l.useContext(N),u=l.useMemo(()=>e.keyboardDelegate||new Be({collection:c,collator:x,ref:o,disabledKeys:$,disabledBehavior:m,layout:s,orientation:p,direction:v,layoutDelegate:k}),[c,x,o,m,$,p,v,e.keyboardDelegate,s,k]),{listBoxProps:M}=Ae({...e,shouldSelectOnPressUp:i||e.shouldSelectOnPressUp,keyboardDelegate:u,isVirtualized:S},b,o),V=l.useRef(i),U=l.useRef(h);l.useEffect(()=>{V.current!==i&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),U.current!==h&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[i,h]);let C,P,F,w=!1,I=null,B=l.useRef(null);if(i&&t){C=t.useDraggableCollectionState({collection:c,selectionManager:g,preview:t.renderDragPreview?B:void 0}),t.useDraggableCollection({},C,o);let O=t.DragPreview;I=t.renderDragPreview?f.createElement(O,{ref:B},t.renderDragPreview):null}if(h&&t){P=t.useDroppableCollectionState({collection:c,selectionManager:g});let O=t.dropTargetDelegate||H||new t.ListDropTargetDelegate(c,o,{orientation:p,layout:s,direction:v});F=t.useDroppableCollection({keyboardDelegate:u,dropTargetDelegate:O},P,o),w=P.isDropTarget({type:"root"})}let{focusProps:z,isFocused:D,isFocusVisible:W}=Se(),j={isDropTarget:w,isEmpty:b.collection.size===0,isFocused:D,isFocusVisible:W,layout:e.layout||"stack",state:b},ae=A({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:j}),q=null;return b.collection.size===0&&e.renderEmptyState&&(q=f.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(j))),f.createElement(Me,null,f.createElement("div",{..._(e),...E(M,z,F==null?void 0:F.collectionProps),...ae,ref:o,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":b.collection.size===0||void 0,"data-focused":D||void 0,"data-focus-visible":W||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},f.createElement(X,{values:[[ee,e],[L,b],[T,{dragAndDropHooks:t,dragState:C,dropState:P}],[he,{elementType:"div"}],[fe,{render:ze}],[re,{name:"ListBoxSection",render:Ue}]]},f.createElement(y,{collection:c,scrollRef:o,persistedKeys:be(g,t,P),renderDropIndicator:Y(t,P)})),q,I))}function Ue(a,e,o,n="react-aria-ListBoxSection"){let d=l.useContext(L),{dragAndDropHooks:r,dropState:t}=l.useContext(T),{CollectionBranch:s}=l.useContext(N),[p,b]=ce();var c;let{headingProps:g,groupProps:i}=_e({heading:b,"aria-label":(c=a["aria-label"])!==null&&c!==void 0?c:void 0}),h=A({defaultClassName:n,className:a.className,style:a.style,values:{}});return f.createElement("section",{..._(a),...i,...h,ref:e},f.createElement(me.Provider,{value:{...g,ref:p}},f.createElement(s,{collection:d.collection,parent:o,renderDropIndicator:Y(r,t)})))}const nt=de("item",function(e,o,n){let d=R(o),r=l.useContext(L),{dragAndDropHooks:t,dragState:s,dropState:p}=l.useContext(T),{optionProps:b,labelProps:c,descriptionProps:g,...i}=Te({key:n.key,"aria-label":e==null?void 0:e["aria-label"]},r,d),{hoverProps:h,isHovered:v}=Z({isDisabled:!i.allowsSelection&&!i.hasAction,onHoverStart:n.props.onHoverStart,onHoverChange:n.props.onHoverChange,onHoverEnd:n.props.onHoverEnd}),m=null;s&&t&&(m=t.useDraggableItem({key:n.key},s));let $=null;p&&t&&($=t.useDroppableItem({target:{type:"item",key:n.key,dropPosition:"on"}},p,d));let x=s&&s.isDragging(n.key),S=A({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...i,isHovered:v,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!s,isDragging:x,isDropTarget:$==null?void 0:$.isDropTarget}});l.useEffect(()=>{n.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[n.textValue]);let k=e.href?"a":"div";return f.createElement(k,{...E(b,h,m==null?void 0:m.dragProps,$==null?void 0:$.dropProps),...S,ref:d,"data-allows-dragging":!!s||void 0,"data-selected":i.isSelected||void 0,"data-disabled":i.isDisabled||void 0,"data-hovered":v||void 0,"data-focused":i.isFocused||void 0,"data-focus-visible":i.isFocusVisible||void 0,"data-pressed":i.isPressed||void 0,"data-dragging":x||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},f.createElement(X,{values:[[ve,{slots:{[ue]:c,label:c,description:g}}]]},S.children))});function ze(a,e){e=R(e);let{dragAndDropHooks:o,dropState:n}=l.useContext(T),{dropIndicatorProps:d,isHidden:r,isDropTarget:t}=o.useDropIndicator(a,n,e);return r?null:f.createElement(Ne,{...a,dropIndicatorProps:d,isDropTarget:t,ref:e})}function Oe(a,e){let{dropIndicatorProps:o,isDropTarget:n,...d}=a,r=A({...d,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:n}});return f.createElement("div",{...o,...r,role:"option",ref:e,"data-drop-target":n||void 0})}const Ne=l.forwardRef(Oe);export{Ae as $,Te as a,_e as b,K as c,Ie as d,ee as e,L as f,ot as g,nt as h};
