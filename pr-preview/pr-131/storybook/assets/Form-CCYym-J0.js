import{v as p,j as k,D as q,q as L,G as w,c as Q,$ as M,m as _,f as G}from"./useFocusable-C6jNUHDg.js";import{r as o,R as u}from"./index-BwDkhjyp.js";import{a as Y}from"./useControlledState-DdsvHRJJ.js";import{a as z}from"./Hidden-BdIcpH7f.js";function $e(a,e,t){let i=o.useRef(e),n=p(()=>{t&&t(i.current)});o.useEffect(()=>{var l;let r=a==null||(l=a.current)===null||l===void 0?void 0:l.form;return r==null||r.addEventListener("reset",n),()=>{r==null||r.removeEventListener("reset",n)}},[a,n])}function be(a,e,t){let{validationBehavior:i,focus:n}=a;k(()=>{if(i==="native"&&(t!=null&&t.current)){let d=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(d),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(J(t.current))}});let l=p(()=>{e.resetValidation()}),r=p(d=>{var c;e.displayValidation.isInvalid||e.commitValidation();let v=t==null||(c=t.current)===null||c===void 0?void 0:c.form;if(!d.defaultPrevented&&t&&v&&K(v)===t.current){var $;n?n():($=t.current)===null||$===void 0||$.focus(),q("keyboard")}d.preventDefault()}),s=p(()=>{e.commitValidation()});o.useEffect(()=>{let d=t==null?void 0:t.current;if(!d)return;let c=d.form;return d.addEventListener("invalid",r),d.addEventListener("change",s),c==null||c.addEventListener("reset",l),()=>{d.removeEventListener("invalid",r),d.removeEventListener("change",s),c==null||c.removeEventListener("reset",l)}},[t,r,s,l,i])}function H(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function J(a){return{isInvalid:!a.validity.valid,validationDetails:H(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function K(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}const P={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},R={...P,customError:!0,valid:!1},b={isInvalid:!1,validationDetails:P,validationErrors:[]},A=o.createContext({}),D="__formValidationState"+Date.now();function me(a){if(a[D]){let{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:n,commitValidation:l}=a[D];return{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:n,commitValidation:l}}return W(a)}function W(a){let{isInvalid:e,validationState:t,name:i,value:n,builtinValidation:l,validate:r,validationBehavior:s="aria"}=a;t&&(e||(e=t==="invalid"));let d=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:R}:null,c=o.useMemo(()=>B(X(r,n)),[r,n]);l!=null&&l.validationDetails.valid&&(l=null);let v=o.useContext(A),$=o.useMemo(()=>i?Array.isArray(i)?i.flatMap(f=>I(v[f])):I(v[i]):[],[v,i]),[N,j]=o.useState(v),[S,E]=o.useState(!1);v!==N&&(j(v),E(!1));let V=o.useMemo(()=>B(S?[]:$),[S,$]),C=o.useRef(b),[y,x]=o.useState(b),m=o.useRef(b),O=()=>{if(!U)return;h(!1);let f=c||l||C.current;g(f,m.current)||(m.current=f,x(f))},[U,h]=o.useState(!1);return o.useEffect(O),{realtimeValidation:d||V||c||l||b,displayValidation:s==="native"?d||V||y:d||V||c||l||y,updateValidation(f){s==="aria"&&!g(y,f)?x(f):C.current=f},resetValidation(){let f=b;g(f,m.current)||(m.current=f,x(f)),s==="native"&&h(!1),E(!0)},commitValidation(){s==="native"&&h(!0),E(!0)}}}function I(a){return a?Array.isArray(a)?a:[a]:[]}function X(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return I(t)}return[]}function B(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:R}:null}function g(a,e){return a===e?!0:a&&e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,i)=>t===e.validationErrors[i])&&Object.entries(a.validationDetails).every(([t,i])=>e.validationDetails[t]===i)}function pe(...a){let e=new Set,t=!1,i={...P};for(let r of a){var n,l;for(let s of r.validationErrors)e.add(s);t||(t=r.isInvalid);for(let s in i)(n=i)[l=s]||(n[l]=r.validationDetails[s])}return i.valid=!t,{isInvalid:t,validationErrors:[...e],validationDetails:i}}function Z(a){let{id:e,label:t,"aria-labelledby":i,"aria-label":n,labelElementType:l="label"}=a;e=L(e);let r=L(),s={};t?(i=i?`${r} ${i}`:r,s={id:r,htmlFor:l==="label"?e:void 0}):!i&&!n&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let d=Y({id:e,"aria-label":n,"aria-labelledby":i});return{labelProps:s,fieldProps:d}}function Ee(a){let{description:e,errorMessage:t,isInvalid:i,validationState:n}=a,{labelProps:l,fieldProps:r}=Z(a),s=w([!!e,!!t,i,n]),d=w([!!e,!!t,i,n]);return r=Q(r,{"aria-describedby":[s,d,a["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:l,fieldProps:r,descriptionProps:{id:s},errorMessageProps:{id:d}}}const ee=o.createContext({});function ae(a,e){[a,e]=M(a,e,ee);let{elementType:t="label",...i}=a;return u.createElement(t,{className:"react-aria-Label",...i,ref:e})}const Ve=z(ae),te=o.createContext({});function ie(a,e){[a,e]=M(a,e,te);let{elementType:t="span",...i}=a;return u.createElement(t,{className:"react-aria-Text",...i,ref:e})}const re=o.forwardRef(ie),F=o.createContext(null);function le(a,e){let t=o.useContext(F);return t!=null&&t.isInvalid?u.createElement(ne,{...a,ref:e}):null}const ye=o.forwardRef(le),ne=o.forwardRef((a,e)=>{let t=o.useContext(F),i=_(a),n=G({...a,defaultClassName:"react-aria-FieldError",defaultChildren:t.validationErrors.length===0?void 0:t.validationErrors.join(" "),values:t});return n.children==null?null:u.createElement(re,{slot:"errorMessage",...i,...n,ref:e})}),T=o.createContext(null);function oe(a,e){[a,e]=M(a,e,T);let{validationErrors:t,validationBehavior:i="native",children:n,className:l,...r}=a;return u.createElement("form",{noValidate:i!=="native",...r,ref:e,className:l||"react-aria-Form"},u.createElement(T.Provider,{value:{...a,validationBehavior:i}},u.createElement(A.Provider,{value:t??{}},n)))}const xe=o.forwardRef(oe);export{xe as $,me as a,Ee as b,$e as c,be as d,T as e,ee as f,te as g,F as h,re as i,Ve as j,ye as k,b as l,D as m,pe as n,Z as o,P as p};
