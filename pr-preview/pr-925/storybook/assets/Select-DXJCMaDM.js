import{b as O,d as T}from"./Button-CQyRRKMW.js";import{b as B,e as N,l as U,$ as z,h as H,a as W,i as X,j as G,k as J}from"./utils-DSWzARDZ.js";import{$ as Q}from"./FieldError-D0HGPYoR.js";import{a as Y}from"./Form-DyQS-Rx8.js";import{$ as Z}from"./intlStrings-ZMTSFH_M.js";import{c as _,d as ee}from"./ListBox-nUQDNtxQ.js";import{e as le,f as te,g as ae}from"./Dialog-PD56cuDU.js";import{a as k}from"./Text-BZsBZWaE.js";import{a as ie}from"./Collection-CBg4ukBX.js";import{$ as re}from"./Hidden-DdX0U8LA.js";import{b as w,i as oe,a as ne}from"./useFocusRing-DAwt605V.js";import{$ as de}from"./useResizeObserver-zNonKEnh.js";import{b as se,r as o,e as P}from"./iframe-CwLkjgpT.js";import{$ as ce}from"./useLocalizedStringFormatter-4a_u7Il3.js";import{b as ue,c as fe,a as be}from"./useFormValidation-DYTV0QoP.js";import{$ as $e}from"./useListState-CC9-S_do.js";import{a as me}from"./OverlayArrow-Bj1Y5OAh.js";import{$ as ve}from"./useControlledState-aJ_MxFDE.js";import{$ as pe,a as ye}from"./ListKeyboardDelegate-CNEKZ9v2.js";import{d as ge}from"./SelectionManager-C1UZmZTF.js";import{$ as xe}from"./useField-Bu-u-nKx.js";import{a as he}from"./VisuallyHidden-DcUNvP8l.js";function Pe(e={}){let{locale:l}=se();return o.useMemo(()=>new Intl.ListFormat(l,e),[l,e])}const q=new WeakMap;function Me(e,l,n){let{keyboardDelegate:f,isDisabled:a,isRequired:m,name:v,form:i,validationBehavior:u="aria"}=e,b=pe({usage:"search",sensitivity:"base"}),r=o.useMemo(()=>f||new ye(l.collection,l.disabledKeys,n,b),[f,l.collection,l.disabledKeys,b,n]),{menuTriggerProps:d,menuProps:p}=le({isDisabled:a,type:"listbox"},l,n),y=$=>{if(l.selectionManager.selectionMode!=="multiple")switch($.key){case"ArrowLeft":{var C,F;$.preventDefault();let I=l.selectedKey!=null?(C=r.getKeyAbove)===null||C===void 0?void 0:C.call(r,l.selectedKey):(F=r.getFirstKey)===null||F===void 0?void 0:F.call(r);I&&l.setSelectedKey(I);break}case"ArrowRight":{var V,E;$.preventDefault();let I=l.selectedKey!=null?(V=r.getKeyBelow)===null||V===void 0?void 0:V.call(r,l.selectedKey):(E=r.getFirstKey)===null||E===void 0?void 0:E.call(r);I&&l.setSelectedKey(I);break}}},{typeSelectProps:s}=ge({keyboardDelegate:r,selectionManager:l.selectionManager,onTypeSelect($){l.setSelectedKey($)}}),{isInvalid:M,validationErrors:S,validationDetails:c}=l.displayValidation,{labelProps:g,fieldProps:h,descriptionProps:t,errorMessageProps:D}=xe({...e,labelElementType:"span",isInvalid:M,errorMessage:e.errorMessage||S});s.onKeyDown=s.onKeyDownCapture,delete s.onKeyDownCapture,l.selectionManager.selectionMode==="multiple"&&(s={});let R=w(e,{labelable:!0}),x=B(s,d,h),K=N();return q.set(l,{isDisabled:a,isRequired:m,name:v,form:i,validationBehavior:u}),{labelProps:{...g,onClick:()=>{if(!e.isDisabled){var $;($=n.current)===null||$===void 0||$.focus(),oe("keyboard")}}},triggerProps:B(R,{...x,isDisabled:a,onKeyDown:U(x.onKeyDown,y,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[K,x["aria-labelledby"],x["aria-label"]&&!x["aria-labelledby"]?x.id:null].filter(Boolean).join(" "),onFocus($){l.isFocused||(e.onFocus&&e.onFocus($),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur($){l.isOpen||(e.onBlur&&e.onBlur($),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:K},menuProps:{...p,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:$=>{$.currentTarget.contains($.relatedTarget)||(e.onBlur&&e.onBlur($),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[h["aria-labelledby"],x["aria-label"]&&!h["aria-labelledby"]?x.id:null].filter(Boolean).join(" ")},descriptionProps:t,errorMessageProps:D,isInvalid:M,validationErrors:S,validationDetails:c,hiddenSelectProps:{isDisabled:a,name:v,label:e.label,state:l,triggerRef:n,form:i}}}function Se(e,l,n){let f=q.get(l)||{},{autoComplete:a,name:m=f.name,form:v=f.form,isDisabled:i=f.isDisabled}=e,{validationBehavior:u,isRequired:b}=f,{visuallyHiddenProps:r}=he({style:{position:"fixed",top:0,left:0}});ue(e.selectRef,l.defaultValue,l.setValue),fe({validationBehavior:u,focus:()=>{var s;return(s=n.current)===null||s===void 0?void 0:s.focus()}},l,e.selectRef);let d=l.setValue,p=o.useCallback(s=>{s.target.multiple?d(Array.from(s.target.selectedOptions,M=>M.value)):d(s.currentTarget.value)},[d]);var y;return{containerProps:{...r,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:a,disabled:i,multiple:l.selectionManager.selectionMode==="multiple",required:u==="native"&&b,name:m,form:v,value:(y=l.value)!==null&&y!==void 0?y:"",onChange:p,onInput:p}}}function De(e){let{state:l,triggerRef:n,label:f,name:a,form:m,isDisabled:v}=e,i=o.useRef(null),u=o.useRef(null),{containerProps:b,selectProps:r}=Se({...e,selectRef:l.collection.size<=300?i:u},l,n);if(l.collection.size<=300)return P.createElement("div",{...b,"data-testid":"hidden-select-container"},P.createElement("label",null,f,P.createElement("select",{...r,ref:i},P.createElement("option",null),[...l.collection.getKeys()].map(d=>{let p=l.collection.getItem(d);if(p&&p.type==="item")return P.createElement("option",{key:p.key,value:p.key},p.textValue)}))));if(a){let d=q.get(l)||{},{validationBehavior:p}=d,y=Array.isArray(l.value)?l.value:[l.value];y.length===0&&(y=[null]);let s=y.map((M,S)=>{let c={type:"hidden",autoComplete:r.autoComplete,name:a,form:m,disabled:v,value:M??""};return p==="native"?P.createElement("input",{key:S,...c,ref:S===0?u:null,style:{display:"none"},type:"text",required:S===0?r.required:!1,onChange:()=>{}}):P.createElement("input",{key:S,...c,ref:S===0?u:null})});return P.createElement(P.Fragment,null,s)}return null}function Re(e){let{selectionMode:l="single"}=e,n=me(e),[f,a]=o.useState(null),m=o.useMemo(()=>{var t;return e.defaultValue!==void 0?e.defaultValue:l==="single"?(t=e.defaultSelectedKey)!==null&&t!==void 0?t:null:[]},[e.defaultValue,e.defaultSelectedKey,l]),v=o.useMemo(()=>e.value!==void 0?e.value:l==="single"?e.selectedKey:void 0,[e.value,e.selectedKey,l]),[i,u]=ve(v,m,e.onChange),b=l==="single"&&Array.isArray(i)?i[0]:i,r=t=>{if(l==="single"){var D,R;let x=Array.isArray(t)?(R=t[0])!==null&&R!==void 0?R:null:t;u(x),x!==b&&((D=e.onSelectionChange)===null||D===void 0||D.call(e,x))}else{let x=[];Array.isArray(t)?x=t:t!=null&&(x=[t]),u(x)}},d=$e({...e,selectionMode:l,disallowEmptySelection:l==="single",allowDuplicateSelectionEvents:!0,selectedKeys:o.useMemo(()=>Ce(b),[b]),onSelectionChange:t=>{if(t!=="all"){if(l==="single"){var D;let R=(D=t.values().next().value)!==null&&D!==void 0?D:null;r(R),n.close()}else r([...t]);s.commitValidation()}}}),p=d.selectionManager.firstSelectedKey,y=o.useMemo(()=>[...d.selectionManager.selectedKeys].map(t=>d.collection.getItem(t)).filter(t=>t!=null),[d.selectionManager.selectedKeys,d.collection]),s=be({...e,value:Array.isArray(b)&&b.length===0?null:b}),[M,S]=o.useState(!1),[c]=o.useState(b);var g,h;return{...s,...d,...n,value:b,defaultValue:m??c,setValue:r,selectedKey:p,setSelectedKey:r,selectedItem:(g=y[0])!==null&&g!==void 0?g:null,selectedItems:y,defaultSelectedKey:(h=e.defaultSelectedKey)!==null&&h!==void 0?h:e.selectionMode==="single"?c:null,focusStrategy:f,open(t=null){d.collection.size!==0&&(a(t),n.open())},toggle(t=null){d.collection.size!==0&&(a(t),n.toggle())},isFocused:M,setFocused:S}}function Ce(e){if(e!==void 0)return e===null?[]:Array.isArray(e)?e:[e]}function Fe(e){return e&&e.__esModule?e.default:e}const A=o.createContext(null),j=o.createContext(null),_e=o.forwardRef(function(l,n){[l,n]=z(l,n,A);let{children:f,isDisabled:a=!1,isInvalid:m=!1,isRequired:v=!1}=l,i=o.useMemo(()=>typeof f=="function"?f({isOpen:!1,isDisabled:a,isInvalid:m,isRequired:v,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):f,[f,a,m,v]);return P.createElement(ie,{content:i},u=>P.createElement(Ke,{props:l,collection:u,selectRef:n}))}),Ie=[O,T,k];function Ke({props:e,selectRef:l,collection:n}){let{validationBehavior:f}=H(Y)||{};var a,m;let v=(m=(a=e.validationBehavior)!==null&&a!==void 0?a:f)!==null&&m!==void 0?m:"native",i=Re({...e,collection:n,children:void 0,validationBehavior:v}),{isFocusVisible:u,focusProps:b}=ne({within:!0}),r=o.useRef(null),[d,p]=X(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:y,triggerProps:s,valueProps:M,menuProps:S,descriptionProps:c,errorMessageProps:g,hiddenSelectProps:h,...t}=Me({...G(e),label:p,validationBehavior:v},i,r),[D,R]=o.useState(null),x=o.useCallback(()=>{r.current&&R(r.current.offsetWidth+"px")},[r]);de({ref:r,onResize:x});let K=o.useMemo(()=>({isOpen:i.isOpen,isFocused:i.isFocused,isFocusVisible:u,isDisabled:e.isDisabled||!1,isInvalid:t.isInvalid||!1,isRequired:e.isRequired||!1}),[i.isOpen,i.isFocused,u,e.isDisabled,t.isInvalid,e.isRequired]),$=W({...e,values:K,defaultClassName:"react-aria-Select"}),C=w(e,{global:!0});delete C.id;let F=o.useRef(null);return P.createElement(J,{values:[[A,e],[j,i],[L,M],[O,{...y,ref:d,elementType:"span"}],[T,{...s,ref:r,isPressed:i.isOpen,autoFocus:e.autoFocus}],[te,i],[ae,{trigger:"Select",triggerRef:r,scrollRef:F,placement:"bottom start",style:{"--trigger-width":D},"aria-labelledby":S["aria-labelledby"],clearContexts:Ie}],[_,{...S,ref:F}],[ee,i],[k,{slots:{description:c,errorMessage:g}}],[Q,t]]},P.createElement("div",{...B(C,$,b),ref:l,slot:e.slot||void 0,"data-focused":i.isFocused||void 0,"data-focus-visible":u||void 0,"data-open":i.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":t.isInvalid||void 0,"data-required":e.isRequired||void 0},$.children,P.createElement(De,{...h,autoComplete:e.autoComplete})))}const L=o.createContext(null),el=re(function(l,n){var f;[l,n]=z(l,n,L);let a=o.useContext(j),{placeholder:m}=H(A),v=a.selectedItems.map(c=>{var g;let h=(g=c.props)===null||g===void 0?void 0:g.children;return typeof h=="function"&&(h=h({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"})),h}),i=Pe(),u=o.useMemo(()=>a.selectedItems.map(c=>c?.textValue),[a.selectedItems]),b=a.selectionManager.selectionMode,r=o.useMemo(()=>{var c;return b==="single"?(c=u[0])!==null&&c!==void 0?c:"":i.format(u)},[b,i,u]),d=o.useMemo(()=>{if(b==="single")return v[0];let c=i.formatToParts(u);if(c.length===0)return null;let g=0;return c.map(h=>h.type==="element"?P.createElement(o.Fragment,{key:g},v[g++]):h.value)},[b,i,u,v]),p=ce(Fe(Z),"react-aria-components");var y,s;let M=W({...l,defaultChildren:(y=d??m)!==null&&y!==void 0?y:p.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(s=(f=a.selectedItems[0])===null||f===void 0?void 0:f.value)!==null&&s!==void 0?s:null,selectedItems:o.useMemo(()=>a.selectedItems.map(c=>{var g;return(g=c.value)!==null&&g!==void 0?g:null}),[a.selectedItems]),selectedText:r,isPlaceholder:a.selectedItems.length===0,state:a}}),S=w(l,{global:!0});return P.createElement("span",{ref:n,...S,...M,"data-placeholder":a.selectedItems.length===0||void 0},P.createElement(k.Provider,{value:void 0},M.children))});export{j as $,_e as a,el as b};
