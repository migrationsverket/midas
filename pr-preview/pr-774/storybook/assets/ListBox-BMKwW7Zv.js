import{$ as Q,a as ie,b as re,c as de,d as z,e as ne}from"./Collection-DhfTE3E9.js";import{e as X,b as F,c as G,l as se,$ as ce,f as W,a as B,k as Y,m as ue,n as $e,i as fe}from"./utils-DgfIEZ2l.js";import{$ as T,a as be,b as Z,c as ve,d as pe}from"./DragAndDrop-ISs4gArs.js";import{$ as ge,a as me,b as xe,c as he,d as Pe}from"./Separator-DPfAiPIW.js";import{$ as De}from"./Text-B2aZuF7F.js";import{c as L,e as ye,z as Se,A as Ee,$ as ee,B as J,w as Ce,a as Fe}from"./useFocusRing-CCdMQ_TW.js";import{$ as Me}from"./inertValue-Cbfo9opA.js";import{r as n,e as c,c as ke}from"./iframe-y3zUiO1J.js";import{d as we}from"./SelectionManager-D6gO8XHw.js";import{a as Ie}from"./Button-CzVrwDkD.js";import{a as Be,$ as Le}from"./useListState-D6x91dYx.js";import{$ as _e,a as Ve}from"./ListKeyboardDelegate-DVZN-xzJ.js";import{a as He}from"./FocusScope-Ybh16f8F.js";const R=new WeakMap;function Ae(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function Oe(t,e){let l=R.get(t);if(!l)throw new Error("Unknown list");return`${l.id}-option-${Ae(e)}`}function Ue(t,e,l){let i=L(t,{labelable:!0}),r=t.selectionBehavior||"toggle",d=t.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&d==="action"&&(d="override");let{listProps:o}=ge({...t,ref:l,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:d}),{focusWithinProps:a}=ye({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),$=X(t.id);R.set(e,{id:$,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:d});let{labelProps:p,fieldProps:s}=Ie({...t,id:$,labelElementType:"span"});return{labelProps:p,listBoxProps:F(i,a,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...F(s,o)})}}function ze(t,e,l){var i,r;let{key:d}=t,o=R.get(e);var a;let $=(a=t.isDisabled)!==null&&a!==void 0?a:e.selectionManager.isDisabled(d);var p;let s=(p=t.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(d);var b;let u=(b=t.shouldSelectOnPressUp)!==null&&b!==void 0?b:o==null?void 0:o.shouldSelectOnPressUp;var v;let x=(v=t.shouldFocusOnHover)!==null&&v!==void 0?v:o==null?void 0:o.shouldFocusOnHover;var m;let g=(m=t.shouldUseVirtualFocus)!==null&&m!==void 0?m:o==null?void 0:o.shouldUseVirtualFocus;var h;let D=(h=t.isVirtualized)!==null&&h!==void 0?h:o==null?void 0:o.isVirtualized,C=G(),M=G(),y={role:"option","aria-disabled":$||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?s:void 0};Se()&&Ee()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=C,y["aria-describedby"]=M);let f=e.collection.getItem(d);if(D){let P=Number(f==null?void 0:f.index);y["aria-posinset"]=Number.isNaN(P)?void 0:P+1,y["aria-setsize"]=me(e.collection)}let k=o!=null&&o.onAction?()=>{var P;return o==null||(P=o.onAction)===null||P===void 0?void 0:P.call(o,d)}:void 0,V=Oe(e,d),{itemProps:w,isPressed:S,isFocused:E,hasAction:I,allowsSelection:H}=we({selectionManager:e.selectionManager,key:d,ref:l,shouldSelectOnPressUp:u,allowsDifferentPressOrigin:u&&x,isVirtualized:D,shouldUseVirtualFocus:g,isDisabled:$,onAction:k||!(f==null||(i=f.props)===null||i===void 0)&&i.onAction?se(f==null||(r=f.props)===null||r===void 0?void 0:r.onAction,k):void 0,linkBehavior:o==null?void 0:o.linkBehavior,id:V}),{hoverProps:A}=ee({isDisabled:$||!x,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(d))}}),O=L(f==null?void 0:f.props);delete O.id;let U=Ce(f==null?void 0:f.props);return{optionProps:{...y,...F(O,w,A,U),id:V},labelProps:{id:C},descriptionProps:{id:M},isFocused:E,isFocusVisible:E&&e.selectionManager.isFocused&&J(),isSelected:s,isDisabled:$,isPressed:S,allowsSelection:H,hasAction:I}}function Te(t){let{heading:e,"aria-label":l}=t,i=X();return{itemProps:{role:"presentation"},headingProps:e?{id:i,role:"presentation"}:{},groupProps:{role:"group","aria-label":l,"aria-labelledby":e?i:void 0}}}const te=n.createContext(null),_=n.createContext(null),it=n.forwardRef(function(e,l){[e,l]=ce(e,l,te);let i=n.useContext(_);return i?c.createElement(oe,{state:i,props:e,listBoxRef:l}):c.createElement(ie,{content:c.createElement(re,e)},r=>c.createElement(Ne,{props:e,listBoxRef:l,collection:r}))});function Ne({props:t,listBoxRef:e,collection:l}){t={...t,collection:l,children:null,items:null};let{layoutDelegate:i}=n.useContext(z),r=Le({...t,layoutDelegate:i});return c.createElement(oe,{state:r,props:t,listBoxRef:e})}function oe({state:t,props:e,listBoxRef:l}){var i;let{filter:r,collectionProps:d,collectionRef:o}=n.useContext(xe)||{};e=n.useMemo(()=>d?{...e,...d}:e,[e,d]);let{dragAndDropHooks:a,layout:$="stack",orientation:p="vertical"}=e;l=W(n.useMemo(()=>$e(l,o!==void 0?o:null),[o,l]));let s=Be(t,r),{collection:b,selectionManager:u}=s,v=!!(a!=null&&a.useDraggableCollectionState),x=!!(a!=null&&a.useDroppableCollectionState),{direction:m}=ke(),{disabledBehavior:g,disabledKeys:h}=u,D=_e({usage:"search",sensitivity:"base"}),{isVirtualized:C,layoutDelegate:M,dropTargetDelegate:y,CollectionRoot:f}=n.useContext(z),k=n.useMemo(()=>e.keyboardDelegate||new Ve({collection:b,collator:D,ref:l,disabledKeys:h,disabledBehavior:g,layout:$,orientation:p,direction:m,layoutDelegate:M}),[b,D,l,g,h,p,m,e.keyboardDelegate,$,M]),{listBoxProps:V}=Ue({...e,shouldSelectOnPressUp:v||e.shouldSelectOnPressUp,keyboardDelegate:k,isVirtualized:C},s,l);n.useRef(v),n.useRef(x),n.useEffect(()=>{},[v,x]);let w,S,E,I=!1,H=null,A=n.useRef(null);if(v&&a){w=a.useDraggableCollectionState({collection:b,selectionManager:u,preview:a.renderDragPreview?A:void 0}),a.useDraggableCollection({},w,l);let K=a.DragPreview;H=a.renderDragPreview?c.createElement(K,{ref:A},a.renderDragPreview):null}if(x&&a){S=a.useDroppableCollectionState({collection:b,selectionManager:u});let K=a.dropTargetDelegate||y||new a.ListDropTargetDelegate(b,l,{orientation:p,layout:$,direction:m});E=a.useDroppableCollection({keyboardDelegate:k,dropTargetDelegate:K},S,l),I=S.isDropTarget({type:"root"})}let{focusProps:O,isFocused:U,isFocusVisible:P}=Fe(),N=s.collection.size===0||s.collection.size===1&&((i=s.collection.getItem(s.collection.getFirstKey()))===null||i===void 0?void 0:i.type)==="loader",j={isDropTarget:I,isEmpty:N,isFocused:U,isFocusVisible:P,layout:e.layout||"stack",state:s},le=B({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:j}),q=null;return N&&e.renderEmptyState&&(q=c.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(j))),c.createElement(He,null,c.createElement("div",{...L(e),...F(V,O,E==null?void 0:E.collectionProps),...le,ref:l,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":I||void 0,"data-empty":N||void 0,"data-focused":U||void 0,"data-focus-visible":P||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},c.createElement(Y,{values:[[te,e],[_,s],[T,{dragAndDropHooks:a,dragState:w,dropState:S}],[he,{elementType:"div"}],[be,{render:Ke}],[ne,{name:"ListBoxSection",render:ae}]]},c.createElement(f,{collection:b,scrollRef:l,persistedKeys:ve(u,a,S),renderDropIndicator:Z(a,S)})),q,H))}function ae(t,e,l,i="react-aria-ListBoxSection"){let r=n.useContext(_),{dragAndDropHooks:d,dropState:o}=n.useContext(T),{CollectionBranch:a}=n.useContext(z),[$,p]=fe();var s;let{headingProps:b,groupProps:u}=Te({heading:p,"aria-label":(s=t["aria-label"])!==null&&s!==void 0?s:void 0}),v=B({defaultClassName:i,className:t.className,style:t.style,values:{}});return c.createElement("section",{...L(t),...u,...v,ref:e},c.createElement(Pe.Provider,{value:{...b,ref:$}},c.createElement(a,{collection:r.collection,parent:l,renderDropIndicator:Z(d,o)})))}const rt=de("section",ae),dt=Q("item",function(e,l,i){let r=W(l),d=n.useContext(_),{dragAndDropHooks:o,dragState:a,dropState:$}=n.useContext(T),{optionProps:p,labelProps:s,descriptionProps:b,...u}=ze({key:i.key,"aria-label":e==null?void 0:e["aria-label"]},d,r),{hoverProps:v,isHovered:x}=ee({isDisabled:!u.allowsSelection&&!u.hasAction,onHoverStart:i.props.onHoverStart,onHoverChange:i.props.onHoverChange,onHoverEnd:i.props.onHoverEnd}),m=null;a&&o&&(m=o.useDraggableItem({key:i.key},a));let g=null;$&&o&&(g=o.useDroppableItem({target:{type:"item",key:i.key,dropPosition:"on"}},$,r));let h=a&&a.isDragging(i.key),D=B({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...u,isHovered:x,selectionMode:d.selectionManager.selectionMode,selectionBehavior:d.selectionManager.selectionBehavior,allowsDragging:!!a,isDragging:h,isDropTarget:g==null?void 0:g.isDropTarget}});n.useEffect(()=>{i.textValue},[i.textValue]);let C=e.href?"a":"div";return c.createElement(C,{...F(p,v,m==null?void 0:m.dragProps,g==null?void 0:g.dropProps),...D,ref:r,"data-allows-dragging":!!a||void 0,"data-selected":u.isSelected||void 0,"data-disabled":u.isDisabled||void 0,"data-hovered":x||void 0,"data-focused":u.isFocused||void 0,"data-focus-visible":u.isFocusVisible||void 0,"data-pressed":u.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":(g==null?void 0:g.isDropTarget)||void 0,"data-selection-mode":d.selectionManager.selectionMode==="none"?void 0:d.selectionManager.selectionMode},c.createElement(Y,{values:[[De,{slots:{[ue]:s,label:s,description:b}}]]},D.children))});function Ke(t,e){e=W(e);let{dragAndDropHooks:l,dropState:i}=n.useContext(T),{dropIndicatorProps:r,isHidden:d,isDropTarget:o}=l.useDropIndicator(t,i,e);return d?null:c.createElement(Re,{...t,dropIndicatorProps:r,isDropTarget:o,ref:e})}function We(t,e){let{dropIndicatorProps:l,isDropTarget:i,...r}=t,d=B({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:i}});return c.createElement("div",{...l,...d,role:"option",ref:e,"data-drop-target":i||void 0})}const Re=n.forwardRef(We);Q("loader",function(e,l,i){let r=n.useContext(_),{isVirtualized:d}=n.useContext(z),{isLoading:o,onLoadMore:a,scrollOffset:$,...p}=e,s=n.useRef(null),b=n.useMemo(()=>({onLoadMore:a,collection:r==null?void 0:r.collection,sentinelRef:s,scrollOffset:$}),[a,$,r==null?void 0:r.collection]);pe(b,s);let u=B({...p,id:void 0,children:i.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),v={tabIndex:-1};return d&&(v["aria-posinset"]=i.index+1,v["aria-setsize"]=r.collection.size),c.createElement(c.Fragment,null,c.createElement("div",{style:{position:"relative",width:0,height:0},inert:Me(!0)},c.createElement("div",{"data-testid":"loadMoreSentinel",ref:s,style:{position:"absolute",height:1,width:1}})),o&&u.children&&c.createElement("div",{...F(L(e),v),...u,role:"option",ref:l},u.children))});export{it as $,dt as a,rt as b,R as c,Oe as d,te as e,_ as f};
