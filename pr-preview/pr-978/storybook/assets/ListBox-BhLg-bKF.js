import{f as q,b as M,c as K,k as le,d as G,a as I,j as J,l as re,$ as Q,h as ie}from"./utils-DzUH-LiJ.js";import{a as X,b as de,c as ne,d as se,$ as ce,e as ue,f as fe,g as z,h as $e}from"./Collection-DNXXbKi1.js";import{$ as T,a as be,b as ve,c as Y,d as pe}from"./DragAndDrop-Dc91Ja6C.js";import{a as ge,b as me,c as xe,d as he}from"./Separator-CMgRjzDZ.js";import{b as Pe}from"./RSPContexts-DpwWeNGS.js";import{a as De,b as ye,c as Se}from"./SelectionIndicator-1ZSNCFY8.js";import{a as Ee}from"./Text-I1JxsJhT.js";import{e as k,f as Be,y as Ce,z as Me,$ as Z,A as j,l as Fe,B as ke,a as Le}from"./useFocusRing-DktvivXH.js";import{$ as we}from"./inertValue-B8Xd1nSX.js";import{r as s,R as d,b as Ie}from"./iframe-Bbu1_rOe.js";import{d as Ae}from"./SelectionManager-DTdXD_WL.js";import{$ as _e}from"./Button-BfBJNH2a.js";import{a as Ue,$ as Ve}from"./useListState-BkydktXf.js";import{$ as Oe,a as Te}from"./ListKeyboardDelegate-BHKEotvc.js";const R=new WeakMap;function He(a){return typeof a=="string"?a.replace(/\s*/g,""):""+a}function Ne(a,e){let l=R.get(a);if(!l)throw new Error("Unknown list");return`${l.id}-option-${He(e)}`}function ze(a,e,l){let t=k(a,{labelable:!0}),r=a.selectionBehavior||"toggle",i=a.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&i==="action"&&(i="override");let{listProps:o}=ge({...a,ref:l,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:i}),{focusWithinProps:n}=Be({onFocusWithin:a.onFocus,onBlurWithin:a.onBlur,onFocusWithinChange:a.onFocusChange}),c=q(a.id);R.set(e,{id:c,shouldUseVirtualFocus:a.shouldUseVirtualFocus,shouldSelectOnPressUp:a.shouldSelectOnPressUp,shouldFocusOnHover:a.shouldFocusOnHover,isVirtualized:a.isVirtualized,onAction:a.onAction,linkBehavior:i,UNSTABLE_itemBehavior:a.UNSTABLE_itemBehavior});let{labelProps:f,fieldProps:b}=_e({...a,id:c,labelElementType:"span"});return{labelProps:f,listBoxProps:M(t,n,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...M(b,o)})}}function Re(a,e,l){var t,r;let{key:i}=a,o=R.get(e);var n;let c=(n=a.isDisabled)!==null&&n!==void 0?n:e.selectionManager.isDisabled(i);var f;let b=(f=a.isSelected)!==null&&f!==void 0?f:e.selectionManager.isSelected(i);var p;let u=(p=a.shouldSelectOnPressUp)!==null&&p!==void 0?p:o?.shouldSelectOnPressUp;var x;let m=(x=a.shouldFocusOnHover)!==null&&x!==void 0?x:o?.shouldFocusOnHover;var P;let D=(P=a.shouldUseVirtualFocus)!==null&&P!==void 0?P:o?.shouldUseVirtualFocus;var v;let E=(v=a.isVirtualized)!==null&&v!==void 0?v:o?.isVirtualized,B=K(),y=K(),g={role:"option","aria-disabled":c||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?b:void 0};Ce()&&Me()||(g["aria-label"]=a["aria-label"],g["aria-labelledby"]=B,g["aria-describedby"]=y);let $=e.collection.getItem(i);if(E){let S=Number($?.index);g["aria-posinset"]=Number.isNaN(S)?void 0:S+1,g["aria-setsize"]=me(e.collection)}let h=o?.onAction?()=>{var S;return o==null||(S=o.onAction)===null||S===void 0?void 0:S.call(o,i)}:void 0,C=Ne(e,i),{itemProps:L,isPressed:_,isFocused:w,hasAction:H,allowsSelection:U}=Ae({selectionManager:e.selectionManager,key:i,ref:l,shouldSelectOnPressUp:u,allowsDifferentPressOrigin:u&&m,isVirtualized:E,shouldUseVirtualFocus:D,isDisabled:c,onAction:h||!($==null||(t=$.props)===null||t===void 0)&&t.onAction?le($==null||(r=$.props)===null||r===void 0?void 0:r.onAction,h):void 0,linkBehavior:o?.linkBehavior,UNSTABLE_itemBehavior:o?.UNSTABLE_itemBehavior,id:C}),{hoverProps:V}=Z({isDisabled:c||!m,onHoverStart(){j()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(i))}}),F=k($?.props);delete F.id;let O=Fe($?.props);return{optionProps:{...g,...M(F,L,V,O),id:C},labelProps:{id:B},descriptionProps:{id:y},isFocused:w,isFocusVisible:w&&e.selectionManager.isFocused&&j(),isSelected:b,isDisabled:c,isPressed:_,allowsSelection:U,hasAction:H}}function We(a){let{heading:e,"aria-label":l}=a,t=q();return{itemProps:{role:"presentation"},headingProps:e?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":l,"aria-labelledby":e?t:void 0}}}const ee=s.createContext(null),A=s.createContext(null),st=s.forwardRef(function(e,l){[e,l]=Q(e,l,ee);let t=s.useContext(A);return t?d.createElement(te,{state:t,props:e,listBoxRef:l}):d.createElement(se,{content:d.createElement(ce,e)},r=>d.createElement(Ke,{props:e,listBoxRef:l,collection:r}))});function Ke({props:a,listBoxRef:e,collection:l}){a={...a,collection:l,children:null,items:null};let{layoutDelegate:t}=s.useContext(z),r=Ve({...a,layoutDelegate:t});return d.createElement(te,{state:r,props:a,listBoxRef:e})}function te({state:a,props:e,listBoxRef:l}){[e,l]=Q(e,l,Pe);let{dragAndDropHooks:t,layout:r="stack",orientation:i="vertical",filter:o}=e,n=Ue(a,o),{collection:c,selectionManager:f}=n,b=!!t?.useDraggableCollectionState,p=!!t?.useDroppableCollectionState,{direction:u}=Ie(),{disabledBehavior:x,disabledKeys:m}=f,P=Oe({usage:"search",sensitivity:"base"}),{isVirtualized:D,layoutDelegate:v,dropTargetDelegate:E,CollectionRoot:B}=s.useContext(z),y=s.useMemo(()=>e.keyboardDelegate||new Te({collection:c,collator:P,ref:l,disabledKeys:m,disabledBehavior:x,layout:r,orientation:i,direction:u,layoutDelegate:v}),[c,P,l,x,m,i,u,e.keyboardDelegate,r,v]),{listBoxProps:g}=ze({...e,shouldSelectOnPressUp:b||e.shouldSelectOnPressUp,keyboardDelegate:y,isVirtualized:D},n,l);s.useRef(b),s.useRef(p),s.useEffect(()=>{},[b,p]);let $,h,C,L=!1,_=null,w=s.useRef(null);if(b&&t){$=t.useDraggableCollectionState({collection:c,selectionManager:f,preview:t.renderDragPreview?w:void 0}),t.useDraggableCollection({},$,l);let N=t.DragPreview;_=t.renderDragPreview?d.createElement(N,{ref:w},t.renderDragPreview):null}if(p&&t){h=t.useDroppableCollectionState({collection:c,selectionManager:f});let N=t.dropTargetDelegate||E||new t.ListDropTargetDelegate(c,l,{orientation:i,layout:r,direction:u});C=t.useDroppableCollection({keyboardDelegate:y,dropTargetDelegate:N},h,l),L=h.isDropTarget({type:"root"})}let{focusProps:H,isFocused:U,isFocusVisible:V}=Le(),F=n.collection.size===0,O={isDropTarget:L,isEmpty:F,isFocused:U,isFocusVisible:V,layout:e.layout||"stack",state:n},S=I({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:O}),W=null;F&&e.renderEmptyState&&(W=d.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(O)));let oe=k(e,{global:!0});return d.createElement(ye,null,d.createElement("div",{...M(oe,S,g,H,C?.collectionProps),ref:l,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":L||void 0,"data-empty":F||void 0,"data-focused":U||void 0,"data-focus-visible":V||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},d.createElement(J,{values:[[ee,e],[A,n],[T,{dragAndDropHooks:t,dragState:$,dropState:h}],[xe,{elementType:"div"}],[ve,{render:je}],[$e,{name:"ListBoxSection",render:ae}]]},d.createElement(Se,null,d.createElement(B,{collection:c,scrollRef:l,persistedKeys:pe(f,t,h),renderDropIndicator:Y(t,h)}))),W,_))}function ae(a,e,l,t="react-aria-ListBoxSection"){let r=s.useContext(A),{dragAndDropHooks:i,dropState:o}=s.useContext(T),{CollectionBranch:n}=s.useContext(z),[c,f]=ie();var b;let{headingProps:p,groupProps:u}=We({heading:f,"aria-label":(b=a["aria-label"])!==null&&b!==void 0?b:void 0}),x=I({defaultClassName:t,className:a.className,style:a.style,values:{}}),m=k(a,{global:!0});return delete m.id,d.createElement("section",{...M(m,x,u),ref:e},d.createElement(he.Provider,{value:{...p,ref:c}},d.createElement(n,{collection:r.collection,parent:l,renderDropIndicator:Y(i,o)})))}const ct=de(ue,ae),ut=X(ne,function(e,l,t){let r=G(l),i=s.useContext(A),{dragAndDropHooks:o,dragState:n,dropState:c}=s.useContext(T),{optionProps:f,labelProps:b,descriptionProps:p,...u}=Re({key:t.key,"aria-label":e?.["aria-label"]},i,r),{hoverProps:x,isHovered:m}=Z({isDisabled:!u.allowsSelection&&!u.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),{focusProps:P}=ke(e),D=null;n&&o&&(D=o.useDraggableItem({key:t.key,hasAction:u.hasAction},n));let v=null;c&&o&&(v=o.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},c,r));let E=n&&n.isDragging(t.key),B=I({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...u,isHovered:m,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!n,isDragging:E,isDropTarget:v?.isDropTarget}});s.useEffect(()=>{t.textValue},[t.textValue]);let y=e.href?"a":"div",g=k(e,{global:!0});return delete g.id,delete g.onClick,y==="a"&&f.tabIndex==null&&(f.tabIndex=-1),d.createElement(y,{...M(g,B,f,x,P,D?.dragProps,v?.dropProps),ref:r,"data-allows-dragging":!!n||void 0,"data-selected":u.isSelected||void 0,"data-disabled":u.isDisabled||void 0,"data-hovered":m||void 0,"data-focused":u.isFocused||void 0,"data-focus-visible":u.isFocusVisible||void 0,"data-pressed":u.isPressed||void 0,"data-dragging":E||void 0,"data-drop-target":v?.isDropTarget||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},d.createElement(J,{values:[[Ee,{slots:{[re]:b,label:b,description:p}}],[De,{isSelected:u.isSelected}]]},B.children))});function je(a,e){e=G(e);let{dragAndDropHooks:l,dropState:t}=s.useContext(T),{dropIndicatorProps:r,isHidden:i,isDropTarget:o}=l.useDropIndicator(a,t,e);return i?null:d.createElement(Ge,{...a,dropIndicatorProps:r,isDropTarget:o,ref:e})}function qe(a,e){let{dropIndicatorProps:l,isDropTarget:t,...r}=a,i=I({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return d.createElement("div",{...l,...i,role:"option",ref:e,"data-drop-target":t||void 0})}const Ge=s.forwardRef(qe),ft=X(fe,function(e,l,t){let r=s.useContext(A),{isLoading:i,onLoadMore:o,scrollOffset:n,...c}=e,f=s.useRef(null),b=s.useMemo(()=>({onLoadMore:o,collection:r?.collection,sentinelRef:f,scrollOffset:n}),[o,n,r?.collection]);be(b,f);let p=I({...c,id:void 0,children:t.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),u={tabIndex:-1};return d.createElement(d.Fragment,null,d.createElement("div",{style:{position:"relative",width:0,height:0},inert:we(!0)},d.createElement("div",{"data-testid":"loadMoreSentinel",ref:f,style:{position:"absolute",height:1,width:1}})),i&&p.children&&d.createElement("div",{...M(k(e,{global:!0}),u),...p,role:"option",ref:l},p.children))});export{ct as $,st as a,ut as b,ee as c,A as d,R as e,Ne as f,ft as g};
