import{$ as Z,a as ee,b as oe,c as N,d as te}from"./Collection-DVrKtIZX.js";import{p as A,f as ae,j as q,d as E,D as W,F as re,G as le,H as ie,a as G,I as j,r as de,$ as ne,b as se,c as T,C as J,h as R,J as ce,A as ue}from"./useFocusable-B8HhqQIl.js";import{$ as _,a as fe,b as Q,c as pe}from"./DragAndDrop-Bfvg-Q35.js";import{$ as be,a as $e,b as ge,c as ve,d as he}from"./Separator-CNfBi8L5.js";import{$ as xe}from"./Text-Bxg5Zhzp.js";import{r as d,R as u}from"./index-B-o1Wr-g.js";import{$ as me}from"./context-e_uznqlg.js";import{$ as De,a as Pe}from"./ListKeyboardDelegate-JdsgzHfV.js";import{c as ye}from"./useField-Dt29Lb0W.js";import{d as Se}from"./SelectionManager-BrHtouv1.js";import{a as ke}from"./FocusScope-hGcwqkni.js";import{$ as Fe}from"./useListState-DzqfRXv-.js";const K=new WeakMap;function Ce(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function we(o,e){let r=K.get(o);if(!r)throw new Error("Unknown list");return`${r.id}-option-${Ce(e)}`}function He(o,e,r){let t=A(o,{labelable:!0}),i=o.selectionBehavior||"toggle",l=o.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&l==="action"&&(l="override");let{listProps:a}=be({...o,ref:r,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:l}),{focusWithinProps:n}=ae({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),s=q(o.id);K.set(e,{id:s,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:l});let{labelProps:p,fieldProps:b}=ye({...o,id:s,labelElementType:"span"});return{labelProps:p,listBoxProps:E(t,n,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...E(b,a)})}}function Ee(o,e,r){var t,i;let{key:l}=o,a=K.get(e);var n;let s=(n=o.isDisabled)!==null&&n!==void 0?n:e.selectionManager.isDisabled(l);var p;let b=(p=o.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(l);var v;let f=(v=o.shouldSelectOnPressUp)!==null&&v!==void 0?v:a==null?void 0:a.shouldSelectOnPressUp;var h;let S=(h=o.shouldFocusOnHover)!==null&&h!==void 0?h:a==null?void 0:a.shouldFocusOnHover;var g;let $=(g=o.shouldUseVirtualFocus)!==null&&g!==void 0?g:a==null?void 0:a.shouldUseVirtualFocus;var D;let P=(D=o.isVirtualized)!==null&&D!==void 0?D:a==null?void 0:a.isVirtualized,F=W(),B=W(),y={role:"option","aria-disabled":s||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?b:void 0};re()&&le()||(y["aria-label"]=o["aria-label"],y["aria-labelledby"]=F,y["aria-describedby"]=B);let c=e.collection.getItem(l);if(P){let m=Number(c==null?void 0:c.index);y["aria-posinset"]=Number.isNaN(m)?void 0:m+1,y["aria-setsize"]=$e(e.collection)}let x=a!=null&&a.onAction?()=>{var m;return a==null||(m=a.onAction)===null||m===void 0?void 0:m.call(a,l)}:void 0,k=we(e,l),{itemProps:C,isPressed:M,isFocused:w,hasAction:U,allowsSelection:I}=Se({selectionManager:e.selectionManager,key:l,ref:r,shouldSelectOnPressUp:f,allowsDifferentPressOrigin:f&&S,isVirtualized:P,shouldUseVirtualFocus:$,isDisabled:s,onAction:x||!(c==null||(t=c.props)===null||t===void 0)&&t.onAction?ie(c==null||(i=c.props)===null||i===void 0?void 0:i.onAction,x):void 0,linkBehavior:a==null?void 0:a.linkBehavior,id:k}),{hoverProps:V}=G({isDisabled:s||!S,onHoverStart(){j()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(l))}}),H=A(c==null?void 0:c.props);delete H.id;let O=de(c==null?void 0:c.props);return{optionProps:{...y,...E(H,C,V,O),id:k},labelProps:{id:F},descriptionProps:{id:B},isFocused:w,isFocusVisible:w&&j(),isSelected:b,isDisabled:s,isPressed:M,allowsSelection:I,hasAction:U}}function Be(o){let{heading:e,"aria-label":r}=o,t=q();return{itemProps:{role:"presentation"},headingProps:e?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":r,"aria-labelledby":e?t:void 0}}}const X=d.createContext(null),L=d.createContext(null),Je=d.forwardRef(function(e,r){[e,r]=ne(e,r,X);let t=d.useContext(L);return t?u.createElement(Y,{state:t,props:e,listBoxRef:r}):u.createElement(Z,{content:u.createElement(ee,e)},i=>u.createElement(Me,{props:e,listBoxRef:r,collection:i}))});function Me({props:o,listBoxRef:e,collection:r}){o={...o,collection:r,children:null,items:null};let{layoutDelegate:t}=d.useContext(N),{filterFn:i,collectionProps:l,collectionRef:a}=d.useContext(ve)||{};e=R(d.useMemo(()=>ce(e,a!==void 0?a:null),[a,e]));let n=d.useMemo(()=>i?r.filter(i):r,[r,i]),s=Fe({...o,collection:n,layoutDelegate:t});return u.createElement(Y,{state:s,props:{...o,...l},listBoxRef:e})}function Y({state:o,props:e,listBoxRef:r}){let{dragAndDropHooks:t,layout:i="stack",orientation:l="vertical"}=e,{collection:a,selectionManager:n}=o,s=!!(t!=null&&t.useDraggableCollectionState),p=!!(t!=null&&t.useDroppableCollectionState),{direction:b}=me(),{disabledBehavior:v,disabledKeys:f}=n,h=De({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:g,dropTargetDelegate:$,CollectionRoot:D}=d.useContext(N),P=d.useMemo(()=>e.keyboardDelegate||new Pe({collection:a,collator:h,ref:r,disabledKeys:f,disabledBehavior:v,layout:i,orientation:l,direction:b,layoutDelegate:g}),[a,h,r,v,f,l,b,e.keyboardDelegate,i,g]),{listBoxProps:F}=He({...e,shouldSelectOnPressUp:s||e.shouldSelectOnPressUp,keyboardDelegate:P,isVirtualized:S},o,r),B=d.useRef(s),y=d.useRef(p);d.useEffect(()=>{B.current!==s&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),y.current!==p&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[s,p]);let c,x,k,C=!1,M=null,w=d.useRef(null);if(s&&t){c=t.useDraggableCollectionState({collection:a,selectionManager:n,preview:t.renderDragPreview?w:void 0}),t.useDraggableCollection({},c,r);let z=t.DragPreview;M=t.renderDragPreview?u.createElement(z,{ref:w},t.renderDragPreview):null}if(p&&t){x=t.useDroppableCollectionState({collection:a,selectionManager:n});let z=t.dropTargetDelegate||$||new t.ListDropTargetDelegate(a,r,{orientation:l,layout:i,direction:b});k=t.useDroppableCollection({keyboardDelegate:P,dropTargetDelegate:z},x,r),C=x.isDropTarget({type:"root"})}let{focusProps:U,isFocused:I,isFocusVisible:V}=se(),H={isDropTarget:C,isEmpty:o.collection.size===0,isFocused:I,isFocusVisible:V,layout:e.layout||"stack",state:o},O=T({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:H}),m=null;return o.collection.size===0&&e.renderEmptyState&&(m=u.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(H))),u.createElement(ke,null,u.createElement("div",{...A(e),...E(F,U,k==null?void 0:k.collectionProps),...O,ref:r,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":C||void 0,"data-empty":o.collection.size===0||void 0,"data-focused":I||void 0,"data-focus-visible":V||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},u.createElement(J,{values:[[X,e],[L,o],[_,{dragAndDropHooks:t,dragState:c,dropState:x}],[ge,{elementType:"div"}],[fe,{render:Ve}],[te,{name:"ListBoxSection",render:Ie}]]},u.createElement(D,{collection:a,scrollRef:r,persistedKeys:pe(n,t,x),renderDropIndicator:Q(t,x)})),m,M))}function Ie(o,e,r,t="react-aria-ListBoxSection"){let i=d.useContext(L),{dragAndDropHooks:l,dropState:a}=d.useContext(_),{CollectionBranch:n}=d.useContext(N),[s,p]=ue();var b;let{headingProps:v,groupProps:f}=Be({heading:p,"aria-label":(b=o["aria-label"])!==null&&b!==void 0?b:void 0}),h=T({defaultClassName:t,className:o.className,style:o.style,values:{}});return u.createElement("section",{...A(o),...f,...h,ref:e},u.createElement(he.Provider,{value:{...v,ref:s}},u.createElement(n,{collection:i.collection,parent:r,renderDropIndicator:Q(l,a)})))}const Qe=oe("item",function(e,r,t){let i=R(r),l=d.useContext(L),{dragAndDropHooks:a,dragState:n,dropState:s}=d.useContext(_),{optionProps:p,labelProps:b,descriptionProps:v,...f}=Ee({key:t.key,"aria-label":e==null?void 0:e["aria-label"]},l,i),{hoverProps:h,isHovered:S}=G({isDisabled:!f.allowsSelection&&!f.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),g=null;n&&a&&(g=a.useDraggableItem({key:t.key},n));let $=null;s&&a&&($=a.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},s,i));let D=n&&n.isDragging(t.key),P=T({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...f,isHovered:S,selectionMode:l.selectionManager.selectionMode,selectionBehavior:l.selectionManager.selectionBehavior,allowsDragging:!!n,isDragging:D,isDropTarget:$==null?void 0:$.isDropTarget}});d.useEffect(()=>{t.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[t.textValue]);let F=e.href?"a":"div";return u.createElement(F,{...E(p,h,g==null?void 0:g.dragProps,$==null?void 0:$.dropProps),...P,ref:i,"data-allows-dragging":!!n||void 0,"data-selected":f.isSelected||void 0,"data-disabled":f.isDisabled||void 0,"data-hovered":S||void 0,"data-focused":f.isFocused||void 0,"data-focus-visible":f.isFocusVisible||void 0,"data-pressed":f.isPressed||void 0,"data-dragging":D||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":l.selectionManager.selectionMode==="none"?void 0:l.selectionManager.selectionMode},u.createElement(J,{values:[[xe,{slots:{label:b,description:v}}]]},P.children))});function Ve(o,e){e=R(e);let{dragAndDropHooks:r,dropState:t}=d.useContext(_),{dropIndicatorProps:i,isHidden:l,isDropTarget:a}=r.useDropIndicator(o,t,e);return l?null:u.createElement(Te,{...o,dropIndicatorProps:i,isDropTarget:a,ref:e})}function Ae(o,e){let{dropIndicatorProps:r,isDropTarget:t,...i}=o,l=T({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return u.createElement("div",{...r,...l,role:"option",ref:e,"data-drop-target":t||void 0})}const Te=d.forwardRef(Ae);export{X as $,L as a,Je as b,Qe as c,K as d,we as e};
