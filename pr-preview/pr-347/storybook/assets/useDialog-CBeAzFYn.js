import{e as S,n as w,c as F,d as N}from"./utils-BhWkjeqE.js";import{$ as y}from"./getScrollParent-CrrBdd7g.js";import{u as M,h as T}from"./useFocusRing-BFo6eXxS.js";import{$ as A}from"./filterDOMProps-BSfnXAP7.js";import{r as m,R as h}from"./index-BbAIUH2N.js";import{$ as I}from"./PressResponder-Drl0S6l1.js";import{a as W}from"./FocusScope-CVReLJeH.js";import{$ as H}from"./index-cpIEhwLo.js";const g=typeof document<"u"&&window.visualViewport,_=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let E=0,x;function Q(e={}){let{isDisabled:t}=e;S(()=>{if(!t)return E++,E===1&&(M()?x=k():x=P()),()=>{E--,E===0&&x()}},[t])}function P(){return w($(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),$(document.documentElement,"overflow","hidden"))}function k(){let e,t,o=c=>{e=y(c.target,!0),!(e===document.documentElement&&e===document.body)&&e instanceof HTMLElement&&window.getComputedStyle(e).overscrollBehavior==="auto"&&(t=$(e,"overscrollBehavior","contain"))},r=c=>{if(!e||e===document.documentElement||e===document.body){c.preventDefault();return}e.scrollHeight===e.clientHeight&&e.scrollWidth===e.clientWidth&&c.preventDefault()},i=()=>{t&&t()},a=c=>{let n=c.target;O(n)&&(f(),n.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{n.style.transform="",g&&(g.height<window.innerHeight?requestAnimationFrame(()=>{C(n)}):g.addEventListener("resize",()=>C(n),{once:!0}))}))},d=null,f=()=>{if(d)return;let c=()=>{window.scrollTo(0,0)},n=window.pageXOffset,b=window.pageYOffset;d=w(p(window,"scroll",c),$(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),$(document.documentElement,"overflow","hidden"),$(document.body,"marginTop",`-${b}px`),()=>{window.scrollTo(n,b)}),window.scrollTo(0,0)},l=w(p(document,"touchstart",o,{passive:!1,capture:!0}),p(document,"touchmove",r,{passive:!1,capture:!0}),p(document,"touchend",i,{passive:!1,capture:!0}),p(document,"focus",a,!0));return()=>{t==null||t(),d==null||d(),l()}}function $(e,t,o){let r=e.style[t];return e.style[t]=o,()=>{e.style[t]=r}}function p(e,t,o,r){return e.addEventListener(t,o,r),()=>{e.removeEventListener(t,o,r)}}function C(e){let t=document.scrollingElement||document.documentElement,o=e;for(;o&&o!==t;){let r=y(o);if(r!==document.documentElement&&r!==document.body&&r!==o){let i=r.getBoundingClientRect().top,a=o.getBoundingClientRect().top;a>i+o.clientHeight&&(r.scrollTop+=a-i)}o=r.parentElement}}function O(e){return e instanceof HTMLInputElement&&!_.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}let v=new WeakMap,u=[];function U(e,t=document.body){let o=new Set(e),r=new Set,i=l=>{for(let s of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))o.add(s);let c=s=>{if(o.has(s)||s.parentElement&&r.has(s.parentElement)&&s.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let R of o)if(s.contains(R))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},n=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),b=c(l);if(b===NodeFilter.FILTER_ACCEPT&&a(l),b!==NodeFilter.FILTER_REJECT){let s=n.nextNode();for(;s!=null;)a(s),s=n.nextNode()}},a=l=>{var c;let n=(c=v.get(l))!==null&&c!==void 0?c:0;l.getAttribute("aria-hidden")==="true"&&n===0||(n===0&&l.setAttribute("aria-hidden","true"),r.add(l),v.set(l,n+1))};u.length&&u[u.length-1].disconnect(),i(t);let d=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...o,...r].some(n=>n.contains(c.target))){for(let n of c.removedNodes)n instanceof Element&&(o.delete(n),r.delete(n));for(let n of c.addedNodes)(n instanceof HTMLElement||n instanceof SVGElement)&&(n.dataset.liveAnnouncer==="true"||n.dataset.reactAriaTopLayer==="true")?o.add(n):n instanceof Element&&i(n)}});d.observe(t,{childList:!0,subtree:!0});let f={observe(){d.observe(t,{childList:!0,subtree:!0})},disconnect(){d.disconnect()}};return u.push(f),()=>{d.disconnect();for(let l of r){let c=v.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),v.delete(l)):v.set(l,c-1))}f===u[u.length-1]?(u.pop(),u.length&&u[u.length-1].observe()):u.splice(u.indexOf(f),1)}}const B=m.createContext({});function V(){var e;return(e=m.useContext(B))!==null&&e!==void 0?e:{}}const L=h.createContext(null);function Z(e){let t=F(),{portalContainer:o=t?null:document.body,isExiting:r}=e,[i,a]=m.useState(!1),d=m.useMemo(()=>({contain:i,setContain:a}),[i,a]),{getContainer:f}=V();if(!e.portalContainer&&f&&(o=f()),!o)return null;let l=e.children;return e.disableFocusManagement||(l=h.createElement(W,{restoreFocus:!0,contain:i&&!r},l)),l=h.createElement(L.Provider,{value:d},h.createElement(I,null,l)),H.createPortal(l,o)}function D(){let e=m.useContext(L),t=e==null?void 0:e.setContain;S(()=>{t==null||t(!0)},[t])}function ee(e,t){let{role:o="dialog"}=e,r=N();r=e["aria-label"]?void 0:r;let i=m.useRef(!1);return m.useEffect(()=>{if(t.current&&!t.current.contains(document.activeElement)){T(t.current);let a=setTimeout(()=>{document.activeElement===t.current&&(i.current=!0,t.current&&(t.current.blur(),T(t.current)),i.current=!1)},500);return()=>{clearTimeout(a)}}},[t]),D(),{dialogProps:{...A(e,{labelable:!0}),role:o,tabIndex:-1,"aria-labelledby":e["aria-labelledby"]||r,onBlur:a=>{i.current&&a.stopPropagation()}},titleProps:{id:r}}}export{Q as $,U as a,Z as b,ee as c,D as d};
