import{z as pt,e as ut}from"./useFocusRing-BRQN0HVs.js";import{d as G}from"./Button--lRgnSCB.js";import{r as R,b as mt,R as gt}from"./iframe-D7pn65HD.js";import{e as q,$ as vt,a as $t}from"./utils-gkLu2Q80.js";import{$ as D}from"./useResizeObserver-2EUM9m3y.js";import{$ as ht}from"./useControlledState-DyV8n_wu.js";const S={top:"top",bottom:"top",left:"left",right:"left"},j={top:"bottom",bottom:"top",left:"right",right:"left"},bt={top:"left",left:"top"},J={top:"height",left:"width"},nt={width:"totalWidth",height:"totalHeight"},Z={};let xt=()=>typeof document<"u"?window.visualViewport:null;function V(e,t){let l=0,r=0,o=0,n=0,c=0,f=0,p={};var s;let u=((s=t?.scale)!==null&&s!==void 0?s:1)>1;if(e.tagName==="BODY"||e.tagName==="HTML"){let $=document.documentElement;o=$.clientWidth,n=$.clientHeight;var h;l=(h=t?.width)!==null&&h!==void 0?h:o;var v;r=(v=t?.height)!==null&&v!==void 0?v:n,p.top=$.scrollTop||e.scrollTop,p.left=$.scrollLeft||e.scrollLeft,t&&(c=t.offsetTop,f=t.offsetLeft)}else({width:l,height:r,top:c,left:f}=Y(e,!1)),p.top=e.scrollTop,p.left=e.scrollLeft,o=l,n=r;if(pt()&&(e.tagName==="BODY"||e.tagName==="HTML")&&u){p.top=0,p.left=0;var m;c=(m=t?.pageTop)!==null&&m!==void 0?m:0;var a;f=(a=t?.pageLeft)!==null&&a!==void 0?a:0}return{width:l,height:r,totalWidth:o,totalHeight:n,scroll:p,top:c,left:f}}function Et(e){return{top:e.scrollTop,left:e.scrollLeft,width:e.scrollWidth,height:e.scrollHeight}}function tt(e,t,l,r,o,n,c){var f;let p=(f=o.scroll[e])!==null&&f!==void 0?f:0,s=r[J[e]],u=c[e]+r.scroll[S[e]]+n,h=c[e]+r.scroll[S[e]]+s-n,v=t-p+r.scroll[S[e]]+c[e]-r[S[e]],m=t-p+l+r.scroll[S[e]]+c[e]-r[S[e]];return v<u?u-v:m>h?Math.max(h-m,u-v):0}function Pt(e){let t=window.getComputedStyle(e);return{top:parseInt(t.marginTop,10)||0,bottom:parseInt(t.marginBottom,10)||0,left:parseInt(t.marginLeft,10)||0,right:parseInt(t.marginRight,10)||0}}function et(e){if(Z[e])return Z[e];let[t,l]=e.split(" "),r=S[t]||"right",o=bt[r];S[l]||(l="center");let n=J[r],c=J[o];return Z[e]={placement:t,crossPlacement:l,axis:r,crossAxis:o,size:n,crossSize:c},Z[e]}function B(e,t,l,r,o,n,c,f,p,s,u){let{placement:h,crossPlacement:v,axis:m,crossAxis:a,size:$,crossSize:x}=r,P={};var i;P[a]=(i=e[a])!==null&&i!==void 0?i:0;var L,d,b,g;v==="center"?P[a]+=(((L=e[x])!==null&&L!==void 0?L:0)-((d=l[x])!==null&&d!==void 0?d:0))/2:v!==a&&(P[a]+=((b=e[x])!==null&&b!==void 0?b:0)-((g=l[x])!==null&&g!==void 0?g:0)),P[a]+=n;const T=e[a]-l[x]+p+s,C=e[a]+e[x]-p-s;if(P[a]=G(P[a],T,C),h===m){let z=f?u[$]:u[nt[$]];P[j[m]]=Math.floor(z-e[m]+o)}else P[m]=Math.floor(e[m]+e[$]+o);return P}function Ct(e,t,l,r,o,n,c,f,p,s,u){var h,v;let m=(e.top!=null?e.top:p[nt.height]-((h=e.bottom)!==null&&h!==void 0?h:0)-c)-((v=p.scroll.top)!==null&&v!==void 0?v:0),a=s?l.top:0;var $,x,P;let i={top:Math.max(t.top+a,(($=u?.offsetTop)!==null&&$!==void 0?$:t.top)+a),bottom:Math.min(t.top+t.height+a,((x=u?.offsetTop)!==null&&x!==void 0?x:0)+((P=u?.height)!==null&&P!==void 0?P:0))};var L,d,b,g;return f!=="top"?Math.max(0,i.bottom-m-(((L=o.top)!==null&&L!==void 0?L:0)+((d=o.bottom)!==null&&d!==void 0?d:0)+n)):Math.max(0,m+c-i.top-(((b=o.top)!==null&&b!==void 0?b:0)+((g=o.bottom)!==null&&g!==void 0?g:0)+n))}function lt(e,t,l,r,o,n,c,f){let{placement:p,axis:s,size:u}=n;var h,v;if(p===s)return Math.max(0,l[s]-((h=c.scroll[s])!==null&&h!==void 0?h:0)-(e[s]+(f?t[s]:0))-((v=r[s])!==null&&v!==void 0?v:0)-r[j[s]]-o);var m,a;return Math.max(0,e[u]+e[s]+(f?t[s]:0)-l[s]-l[u]+((m=c.scroll[s])!==null&&m!==void 0?m:0)-((a=r[s])!==null&&a!==void 0?a:0)-r[j[s]]-o)}function Tt(e,t,l,r,o,n,c,f,p,s,u,h,v,m,a,$,x,P){let i=et(e),{size:L,crossAxis:d,crossSize:b,placement:g,crossPlacement:T}=i,C=B(t,f,l,i,u,h,s,v,a,$,p),z=u,F=lt(f,s,t,o,n+u,i,p,x);if(c&&l[L]>F){let W=et(`${j[g]} ${T}`),dt=B(t,f,l,W,u,h,s,v,a,$,p);lt(f,s,t,o,n+u,W,p,x)>F&&(i=W,C=dt,z=u)}let y="bottom";i.axis==="top"?i.placement==="top"?y="top":i.placement==="bottom"&&(y="bottom"):i.crossAxis==="top"&&(i.crossPlacement==="top"?y="bottom":i.crossPlacement==="bottom"&&(y="top"));let _=tt(d,C[d],l[b],f,p,n,s);C[d]+=_;let H=Ct(C,f,s,v,o,n,l.height,y,p,x,P);m&&m<H&&(H=m),l.height=Math.min(l.height,H),C=B(t,f,l,i,z,h,s,v,a,$,p),_=tt(d,C[d],l[b],f,p,n,s),C[d]+=_;let A={},M=t[d]-C[d]-o[S[d]],I=M+.5*t[b];const X=a/2+$;var N,k,w,O;const U=S[d]==="left"?((N=o.left)!==null&&N!==void 0?N:0)+((k=o.right)!==null&&k!==void 0?k:0):((w=o.top)!==null&&w!==void 0?w:0)+((O=o.bottom)!==null&&O!==void 0?O:0),it=l[b]-U-a/2-$,at=t[d]+a/2-(C[d]+o[S[d]]),ct=t[d]+t[b]-a/2-(C[d]+o[S[d]]),st=G(I,at,ct);A[d]=G(st,X,it),{placement:g,crossPlacement:T}=i,a?M=A[d]:T==="right"?M+=t[b]:T==="center"&&(M+=t[b]/2);let Q=g==="left"||g==="top"?l[L]:0,ft={x:g==="top"||g==="bottom"?M:Q,y:g==="left"||g==="right"?M:Q};return{position:C,maxHeight:H,arrowOffsetLeft:A.left,arrowOffsetTop:A.top,placement:g,triggerAnchorPoint:ft}}function _t(e){let{placement:t,targetNode:l,overlayNode:r,scrollNode:o,padding:n,shouldFlip:c,boundaryElement:f,offset:p,crossOffset:s,maxHeight:u,arrowSize:h=0,arrowBoundaryOffset:v=0}=e,m=xt(),a=r instanceof HTMLElement?Lt(r):document.documentElement,$=a===document.documentElement;const x=window.getComputedStyle(a).position;let P=!!x&&x!=="static",i=$?Y(l,!1):ot(l,a,!1);if(!$){let{marginTop:A,marginLeft:M}=window.getComputedStyle(l);i.top+=parseInt(A,10)||0,i.left+=parseInt(M,10)||0}let L=Y(r,!0),d=Pt(r);var b,g;L.width+=((b=d.left)!==null&&b!==void 0?b:0)+((g=d.right)!==null&&g!==void 0?g:0);var T,C;L.height+=((T=d.top)!==null&&T!==void 0?T:0)+((C=d.bottom)!==null&&C!==void 0?C:0);let z=Et(o),F=V(f,m),y=V(a,m),_=ot(f,a,!1),H=f.contains(a);return Tt(t,i,L,z,d,n,c,F,y,_,p,s,P,u,h,v,H,m)}function K(e,t){let{top:l,left:r,width:o,height:n}=e.getBoundingClientRect();return t&&e instanceof e.ownerDocument.defaultView.HTMLElement&&(o=e.offsetWidth,n=e.offsetHeight),{top:l,left:r,width:o,height:n}}function Y(e,t){let{top:l,left:r,width:o,height:n}=K(e,t),{scrollTop:c,scrollLeft:f,clientTop:p,clientLeft:s}=document.documentElement;return{top:l+c-p,left:r+f-s,width:o,height:n}}function ot(e,t,l){let r=window.getComputedStyle(e),o;if(r.position==="fixed")o=K(e,l);else{o=Y(e,l);let n=Y(t,l),c=window.getComputedStyle(t);n.top+=(parseInt(c.borderTopWidth,10)||0)-t.scrollTop,n.left+=(parseInt(c.borderLeftWidth,10)||0)-t.scrollLeft,o.top-=n.top,o.left-=n.left}return o.top-=parseInt(r.marginTop,10)||0,o.left-=parseInt(r.marginLeft,10)||0,o}function Lt(e){let t=e.offsetParent;if(t&&t===document.body&&window.getComputedStyle(t).position==="static"&&!rt(t)&&(t=document.documentElement),t==null)for(t=e.parentElement;t&&!rt(t);)t=t.parentElement;return t||document.documentElement}function rt(e){let t=window.getComputedStyle(e);return t.transform!=="none"||/transform|perspective/.test(t.willChange)||t.filter!=="none"||t.contain==="paint"||"backdropFilter"in t&&t.backdropFilter!=="none"||"WebkitBackdropFilter"in t&&t.WebkitBackdropFilter!=="none"}const wt=new WeakMap;function Ht(e){let{triggerRef:t,isOpen:l,onClose:r}=e;R.useEffect(()=>{if(!l||r===null)return;let o=n=>{let c=n.target;if(!t.current||c instanceof Node&&!c.contains(t.current)||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement)return;let f=r||wt.get(t.current);f&&f()};return window.addEventListener("scroll",o,!0),()=>{window.removeEventListener("scroll",o,!0)}},[l,r,t])}let E=typeof document<"u"?window.visualViewport:null;function Xt(e){let{direction:t}=mt(),{arrowSize:l,targetRef:r,overlayRef:o,arrowRef:n,scrollRef:c=o,placement:f="bottom",containerPadding:p=12,shouldFlip:s=!0,boundaryElement:u=typeof document<"u"?document.body:null,offset:h=0,crossOffset:v=0,shouldUpdatePosition:m=!0,isOpen:a=!0,onClose:$,maxHeight:x,arrowBoundaryOffset:P=0}=e,[i,L]=R.useState(null),d=[m,f,o.current,r.current,n?.current,c.current,p,s,u,h,v,a,t,x,P,l],b=R.useRef(E?.scale);R.useEffect(()=>{a&&(b.current=E?.scale)},[a]);let g=R.useCallback(()=>{if(m===!1||!a||!o.current||!r.current||!u||E?.scale!==b.current)return;let _=null;if(c.current&&c.current.contains(document.activeElement)){var H;let w=(H=document.activeElement)===null||H===void 0?void 0:H.getBoundingClientRect(),O=c.current.getBoundingClientRect();var A;if(_={type:"top",offset:((A=w?.top)!==null&&A!==void 0?A:0)-O.top},_.offset>O.height/2){_.type="bottom";var M;_.offset=((M=w?.bottom)!==null&&M!==void 0?M:0)-O.bottom}}let I=o.current;if(!x&&o.current){var X;I.style.top="0px",I.style.bottom="";var N;I.style.maxHeight=((N=(X=window.visualViewport)===null||X===void 0?void 0:X.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let k=_t({placement:At(f,t),overlayNode:o.current,targetNode:r.current,scrollNode:c.current||o.current,padding:p,shouldFlip:s,boundaryElement:u,offset:h,crossOffset:v,maxHeight:x,arrowSize:l??(n?.current?K(n.current,!0).width:0),arrowBoundaryOffset:P});if(k.position){if(I.style.top="",I.style.bottom="",I.style.left="",I.style.right="",Object.keys(k.position).forEach(w=>I.style[w]=k.position[w]+"px"),I.style.maxHeight=k.maxHeight!=null?k.maxHeight+"px":"",_&&document.activeElement&&c.current){let w=document.activeElement.getBoundingClientRect(),O=c.current.getBoundingClientRect(),U=w[_.type]-O[_.type];c.current.scrollTop+=U-_.offset}L(k)}},d);q(g,d),Rt(g),D({ref:o,onResize:g}),D({ref:r,onResize:g});let T=R.useRef(!1);q(()=>{let _,H=()=>{T.current=!0,clearTimeout(_),_=setTimeout(()=>{T.current=!1},500),g()},A=()=>{T.current&&H()};return E?.addEventListener("resize",H),E?.addEventListener("scroll",A),()=>{E?.removeEventListener("resize",H),E?.removeEventListener("scroll",A)}},[g]);let C=R.useCallback(()=>{T.current||$?.()},[$,T]);Ht({triggerRef:r,isOpen:a,onClose:$&&C});var z,F,y;return{overlayProps:{style:{position:i?"absolute":"fixed",top:i?void 0:0,left:i?void 0:0,zIndex:1e5,...i?.position,maxHeight:(z=i?.maxHeight)!==null&&z!==void 0?z:"100vh"}},placement:(F=i?.placement)!==null&&F!==void 0?F:null,triggerAnchorPoint:(y=i?.triggerAnchorPoint)!==null&&y!==void 0?y:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:i?.arrowOffsetLeft,top:i?.arrowOffsetTop}},updatePosition:g}}function Rt(e){q(()=>(window.addEventListener("resize",e,!1),()=>{window.removeEventListener("resize",e,!1)}),[e])}function At(e,t){return t==="rtl"?e.replace("start","right").replace("end","left"):e.replace("start","left").replace("end","right")}const Mt=R.createContext({});function Yt(){var e;return(e=R.useContext(Mt))!==null&&e!==void 0?e:{}}function Zt(e){let[t,l]=ht(e.isOpen,e.defaultOpen||!1,e.onOpenChange);const r=R.useCallback(()=>{l(!0)},[l]),o=R.useCallback(()=>{l(!1)},[l]),n=R.useCallback(()=>{l(!t)},[l,t]);return{isOpen:t,setOpen:l,open:r,close:o,toggle:n}}const St=R.createContext({placement:"bottom"}),jt=R.forwardRef(function(t,l){[t,l]=vt(t,l,St);let r=t.placement,o={position:"absolute",transform:r==="top"||r==="bottom"?"translateX(-50%)":"translateY(-50%)"};r!=null&&(o[r]="100%");let n=$t({...t,defaultClassName:"react-aria-OverlayArrow",values:{placement:r}});n.style&&Object.keys(n.style).forEach(f=>n.style[f]===void 0&&delete n.style[f]);let c=ut(t);return gt.createElement("div",{...c,...n,style:{...o,...n.style},ref:l,"data-placement":r})});export{jt as $,Yt as a,Zt as b,Xt as c,St as d,wt as e};
