import{y as ae}from"./useFocusRing-BODiw1iP.js";import{b as G}from"./ProgressBar-B2jw0c1b.js";import{r as _}from"./index-B-o1Wr-g.js";import{e as q}from"./utils-CyugoGNF.js";import{$ as se}from"./context-BwmME58u.js";import{$ as ce}from"./useControlledState-BgxdDqm0.js";function fe(){return typeof window.ResizeObserver<"u"}function K(t){const{ref:e,box:o,onResize:r}=t;_.useEffect(()=>{let l=e==null?void 0:e.current;if(l)if(fe()){const i=new window.ResizeObserver(s=>{s.length&&r()});return i.observe(l,{box:o}),()=>{l&&i.unobserve(l)}}else return window.addEventListener("resize",r,!1),()=>{window.removeEventListener("resize",r,!1)}},[r,e,o])}const y={top:"top",bottom:"top",left:"left",right:"left"},X={top:"bottom",bottom:"top",left:"right",right:"left"},de={top:"left",left:"top"},J={top:"height",left:"width"},le={width:"totalWidth",height:"totalHeight"},Y={};let C=typeof document<"u"?window.visualViewport:null;function Q(t){let e=0,o=0,r=0,l=0,i=0,s=0,n={};var $;let f=(($=C==null?void 0:C.scale)!==null&&$!==void 0?$:1)>1;if(t.tagName==="BODY"){let d=document.documentElement;r=d.clientWidth,l=d.clientHeight;var p;e=(p=C==null?void 0:C.width)!==null&&p!==void 0?p:r;var g;o=(g=C==null?void 0:C.height)!==null&&g!==void 0?g:l,n.top=d.scrollTop||t.scrollTop,n.left=d.scrollLeft||t.scrollLeft,C&&(i=C.offsetTop,s=C.offsetLeft)}else({width:e,height:o,top:i,left:s}=B(t)),n.top=t.scrollTop,n.left=t.scrollLeft,r=e,l=o;if(ae()&&(t.tagName==="BODY"||t.tagName==="HTML")&&f){n.top=0,n.left=0;var u;i=(u=C==null?void 0:C.pageTop)!==null&&u!==void 0?u:0;var a;s=(a=C==null?void 0:C.pageLeft)!==null&&a!==void 0?a:0}return{width:e,height:o,totalWidth:r,totalHeight:l,scroll:n,top:i,left:s}}function pe(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function W(t,e,o,r,l,i,s){var n;let $=(n=l.scroll[t])!==null&&n!==void 0?n:0,f=r[J[t]],p=r.scroll[y[t]]+i,g=f+r.scroll[y[t]]-i,u=e-$+s[t]-r[y[t]],a=e-$+o+s[t]-r[y[t]];return u<p?p-u:a>g?Math.max(g-a,p-u):0}function ue(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function V(t){if(Y[t])return Y[t];let[e,o]=t.split(" "),r=y[e]||"right",l=de[r];y[o]||(o="center");let i=J[r],s=J[l];return Y[t]={placement:e,crossPlacement:o,axis:r,crossAxis:l,size:i,crossSize:s},Y[t]}function j(t,e,o,r,l,i,s,n,$,f){let{placement:p,crossPlacement:g,axis:u,crossAxis:a,size:d,crossSize:h}=r,c={};var m;c[a]=(m=t[a])!==null&&m!==void 0?m:0;var v,E,R,L;g==="center"?c[a]+=(((v=t[h])!==null&&v!==void 0?v:0)-((E=o[h])!==null&&E!==void 0?E:0))/2:g!==a&&(c[a]+=((R=t[h])!==null&&R!==void 0?R:0)-((L=o[h])!==null&&L!==void 0?L:0)),c[a]+=i;const b=t[a]-o[h]+$+f,I=t[a]+t[h]-$-f;if(c[a]=G(c[a],b,I),p===u){const M=n?s[d]:e[le[d]];c[X[u]]=Math.floor(M-t[u]+l)}else c[u]=Math.floor(t[u]+t[d]+l);return c}function me(t,e,o,r,l,i,s,n){const $=r?o.height:e[le.height];var f;let p=t.top!=null?o.top+t.top:o.top+($-((f=t.bottom)!==null&&f!==void 0?f:0)-s);var g,u,a,d,h,c;let m=n!=="top"?Math.max(0,e.height+e.top+((g=e.scroll.top)!==null&&g!==void 0?g:0)-p-(((u=l.top)!==null&&u!==void 0?u:0)+((a=l.bottom)!==null&&a!==void 0?a:0)+i)):Math.max(0,p+s-(e.top+((d=e.scroll.top)!==null&&d!==void 0?d:0))-(((h=l.top)!==null&&h!==void 0?h:0)+((c=l.bottom)!==null&&c!==void 0?c:0)+i));return Math.min(e.height-i*2,m)}function D(t,e,o,r,l,i){let{placement:s,axis:n,size:$}=i;var f,p;if(s===n)return Math.max(0,o[n]-t[n]-((f=t.scroll[n])!==null&&f!==void 0?f:0)+e[n]-((p=r[n])!==null&&p!==void 0?p:0)-r[X[n]]-l);var g;return Math.max(0,t[$]+t[n]+t.scroll[n]-e[n]-o[n]-o[$]-((g=r[n])!==null&&g!==void 0?g:0)-r[X[n]]-l)}function ve(t,e,o,r,l,i,s,n,$,f,p,g,u,a,d,h){let c=V(t),{size:m,crossAxis:v,crossSize:E,placement:R,crossPlacement:L}=c,b=j(e,n,o,c,p,g,f,u,d,h),I=p,M=D(n,f,e,l,i+p,c);if(s&&r[m]>M){let U=V(`${X[R]} ${L}`),ie=j(e,n,o,U,p,g,f,u,d,h);D(n,f,e,l,i+p,U)>M&&(c=U,b=ie,I=p)}let H="bottom";c.axis==="top"?c.placement==="top"?H="top":c.placement==="bottom"&&(H="bottom"):c.crossAxis==="top"&&(c.crossPlacement==="top"?H="bottom":c.crossPlacement==="bottom"&&(H="top"));let w=W(v,b[v],o[E],n,$,i,f);b[v]+=w;let T=me(b,n,f,u,l,i,o.height,H);a&&a<T&&(T=a),o.height=Math.min(o.height,T),b=j(e,n,o,c,I,g,f,u,d,h),w=W(v,b[v],o[E],n,$,i,f),b[v]+=w;let z={},O=e[v]+.5*e[E]-b[v]-l[y[v]];const S=d/2+h;var k,N,A,P;const F=y[v]==="left"?((k=l.left)!==null&&k!==void 0?k:0)+((N=l.right)!==null&&N!==void 0?N:0):((A=l.top)!==null&&A!==void 0?A:0)+((P=l.bottom)!==null&&P!==void 0?P:0),Z=o[E]-F-d/2-h,oe=e[v]+d/2-(b[v]+l[y[v]]),re=e[v]+e[E]-d/2-(b[v]+l[y[v]]),ne=G(O,oe,re);return z[v]=G(ne,S,Z),{position:b,maxHeight:T,arrowOffsetLeft:z.left,arrowOffsetTop:z.top,placement:c.placement}}function ge(t){let{placement:e,targetNode:o,overlayNode:r,scrollNode:l,padding:i,shouldFlip:s,boundaryElement:n,offset:$,crossOffset:f,maxHeight:p,arrowSize:g=0,arrowBoundaryOffset:u=0}=t,a=r instanceof HTMLElement?$e(r):document.documentElement,d=a===document.documentElement;const h=window.getComputedStyle(a).position;let c=!!h&&h!=="static",m=d?B(o):ee(o,a);if(!d){let{marginTop:z,marginLeft:O}=window.getComputedStyle(o);m.top+=parseInt(z,10)||0,m.left+=parseInt(O,10)||0}let v=B(r),E=ue(r);var R,L;v.width+=((R=E.left)!==null&&R!==void 0?R:0)+((L=E.right)!==null&&L!==void 0?L:0);var b,I;v.height+=((b=E.top)!==null&&b!==void 0?b:0)+((I=E.bottom)!==null&&I!==void 0?I:0);let M=pe(l),H=Q(n),w=Q(a),T=n.tagName==="BODY"?B(a):ee(a,n);return a.tagName==="HTML"&&n.tagName==="BODY"&&(w.scroll.top=0,w.scroll.left=0),ve(e,m,v,M,E,i,s,H,w,T,$,f,c,p,g,u)}function B(t){let{top:e,left:o,width:r,height:l}=t.getBoundingClientRect(),{scrollTop:i,scrollLeft:s,clientTop:n,clientLeft:$}=document.documentElement;return{top:e+i-n,left:o+s-$,width:r,height:l}}function ee(t,e){let o=window.getComputedStyle(t),r;if(o.position==="fixed"){let{top:l,left:i,width:s,height:n}=t.getBoundingClientRect();r={top:l,left:i,width:s,height:n}}else{r=B(t);let l=B(e),i=window.getComputedStyle(e);l.top+=(parseInt(i.borderTopWidth,10)||0)-e.scrollTop,l.left+=(parseInt(i.borderLeftWidth,10)||0)-e.scrollLeft,r.top-=l.top,r.left-=l.left}return r.top-=parseInt(o.marginTop,10)||0,r.left-=parseInt(o.marginLeft,10)||0,r}function $e(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!te(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!te(e);)e=e.parentElement;return e||document.documentElement}function te(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const he=new WeakMap;function be(t){let{triggerRef:e,isOpen:o,onClose:r}=t;_.useEffect(()=>{if(!o||r===null)return;let l=i=>{let s=i.target;if(!e.current||s instanceof Node&&!s.contains(e.current)||i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement)return;let n=r||he.get(e.current);n&&n()};return window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("scroll",l,!0)}},[o,r,e])}let x=typeof document<"u"?window.visualViewport:null;function He(t){let{direction:e}=se(),{arrowSize:o=0,targetRef:r,overlayRef:l,scrollRef:i=l,placement:s="bottom",containerPadding:n=12,shouldFlip:$=!0,boundaryElement:f=typeof document<"u"?document.body:null,offset:p=0,crossOffset:g=0,shouldUpdatePosition:u=!0,isOpen:a=!0,onClose:d,maxHeight:h,arrowBoundaryOffset:c=0}=t,[m,v]=_.useState(null),E=[u,s,l.current,r.current,i.current,n,$,f,p,g,a,e,h,c,o],R=_.useRef(x==null?void 0:x.scale);_.useEffect(()=>{a&&(R.current=x==null?void 0:x.scale)},[a]);let L=_.useCallback(()=>{if(u===!1||!a||!l.current||!r.current||!f||(x==null?void 0:x.scale)!==R.current)return;let w=null;if(i.current&&i.current.contains(document.activeElement)){var T;let P=(T=document.activeElement)===null||T===void 0?void 0:T.getBoundingClientRect(),F=i.current.getBoundingClientRect();var z;if(w={type:"top",offset:((z=P==null?void 0:P.top)!==null&&z!==void 0?z:0)-F.top},w.offset>F.height/2){w.type="bottom";var O;w.offset=((O=P==null?void 0:P.bottom)!==null&&O!==void 0?O:0)-F.bottom}}let S=l.current;if(!h&&l.current){var k;S.style.top="0px",S.style.bottom="";var N;S.style.maxHeight=((N=(k=window.visualViewport)===null||k===void 0?void 0:k.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let A=ge({placement:we(s,e),overlayNode:l.current,targetNode:r.current,scrollNode:i.current||l.current,padding:n,shouldFlip:$,boundaryElement:f,offset:p,crossOffset:g,maxHeight:h,arrowSize:o,arrowBoundaryOffset:c});if(A.position){if(S.style.top="",S.style.bottom="",S.style.left="",S.style.right="",Object.keys(A.position).forEach(P=>S.style[P]=A.position[P]+"px"),S.style.maxHeight=A.maxHeight!=null?A.maxHeight+"px":"",w&&document.activeElement&&i.current){let P=document.activeElement.getBoundingClientRect(),F=i.current.getBoundingClientRect(),Z=P[w.type]-F[w.type];i.current.scrollTop+=Z-w.offset}v(A)}},E);q(L,E),xe(L),K({ref:l,onResize:L}),K({ref:r,onResize:L});let b=_.useRef(!1);q(()=>{let w,T=()=>{b.current=!0,clearTimeout(w),w=setTimeout(()=>{b.current=!1},500),L()},z=()=>{b.current&&T()};return x==null||x.addEventListener("resize",T),x==null||x.addEventListener("scroll",z),()=>{x==null||x.removeEventListener("resize",T),x==null||x.removeEventListener("scroll",z)}},[L]);let I=_.useCallback(()=>{b.current||d==null||d()},[d,b]);be({triggerRef:r,isOpen:a,onClose:d&&I});var M,H;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...m==null?void 0:m.position,maxHeight:(M=m==null?void 0:m.maxHeight)!==null&&M!==void 0?M:"100vh"}},placement:(H=m==null?void 0:m.placement)!==null&&H!==void 0?H:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:m==null?void 0:m.arrowOffsetLeft,top:m==null?void 0:m.arrowOffsetTop}},updatePosition:L}}function xe(t){q(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function we(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function Se(t){let[e,o]=ce(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const r=_.useCallback(()=>{o(!0)},[o]),l=_.useCallback(()=>{o(!1)},[o]),i=_.useCallback(()=>{o(!e)},[o,e]);return{isOpen:e,setOpen:o,open:r,close:l,toggle:i}}export{Se as $,He as a,K as b,he as c};
