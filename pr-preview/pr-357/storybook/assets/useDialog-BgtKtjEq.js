import{e as S,n as w,c as R,d as F}from"./utils-CyugoGNF.js";import{$ as y}from"./getScrollParent-CvodOSaS.js";import{A as M,m as T}from"./useFocusRing-BODiw1iP.js";import{$ as A}from"./filterDOMProps-CeZl_uWj.js";import{r as $,R as h}from"./index-B-o1Wr-g.js";import{$ as I}from"./PressResponder-BjRG4CYk.js";import{a as W}from"./FocusScope-Ded37Rd9.js";import{$ as H}from"./index-BAyGJXOV.js";const g=typeof document<"u"&&window.visualViewport,_=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let E=0,x;function Q(e={}){let{isDisabled:t}=e;S(()=>{if(!t)return E++,E===1&&(M()?x=k():x=P()),()=>{E--,E===0&&x()}},[t])}function P(){return w(m(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),m(document.documentElement,"overflow","hidden"))}function k(){let e,t,n=c=>{e=y(c.target,!0),!(e===document.documentElement&&e===document.body)&&e instanceof HTMLElement&&window.getComputedStyle(e).overscrollBehavior==="auto"&&(t=m(e,"overscrollBehavior","contain"))},r=c=>{if(!e||e===document.documentElement||e===document.body){c.preventDefault();return}e.scrollHeight===e.clientHeight&&e.scrollWidth===e.clientWidth&&c.preventDefault()},i=()=>{t&&t()},a=c=>{let o=c.target;O(o)&&(f(),o.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{o.style.transform="",g&&(g.height<window.innerHeight?requestAnimationFrame(()=>{C(o)}):g.addEventListener("resize",()=>C(o),{once:!0}))}))},u=null,f=()=>{if(u)return;let c=()=>{window.scrollTo(0,0)},o=window.pageXOffset,b=window.pageYOffset;u=w(p(window,"scroll",c),m(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),m(document.documentElement,"overflow","hidden"),m(document.body,"marginTop",`-${b}px`),()=>{window.scrollTo(o,b)}),window.scrollTo(0,0)},l=w(p(document,"touchstart",n,{passive:!1,capture:!0}),p(document,"touchmove",r,{passive:!1,capture:!0}),p(document,"touchend",i,{passive:!1,capture:!0}),p(document,"focus",a,!0));return()=>{t==null||t(),u==null||u(),l()}}function m(e,t,n){let r=e.style[t];return e.style[t]=n,()=>{e.style[t]=r}}function p(e,t,n,r){return e.addEventListener(t,n,r),()=>{e.removeEventListener(t,n,r)}}function C(e){let t=document.scrollingElement||document.documentElement,n=e;for(;n&&n!==t;){let r=y(n);if(r!==document.documentElement&&r!==document.body&&r!==n){let i=r.getBoundingClientRect().top,a=n.getBoundingClientRect().top;a>i+n.clientHeight&&(r.scrollTop+=a-i)}n=r.parentElement}}function O(e){return e instanceof HTMLInputElement&&!_.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}let v=new WeakMap,d=[];function U(e,t=document.body){let n=new Set(e),r=new Set,i=l=>{for(let s of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(s);let c=s=>{if(n.has(s)||s.parentElement&&r.has(s.parentElement)&&s.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let L of n)if(s.contains(L))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},o=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),b=c(l);if(b===NodeFilter.FILTER_ACCEPT&&a(l),b!==NodeFilter.FILTER_REJECT){let s=o.nextNode();for(;s!=null;)a(s),s=o.nextNode()}},a=l=>{var c;let o=(c=v.get(l))!==null&&c!==void 0?c:0;l.getAttribute("aria-hidden")==="true"&&o===0||(o===0&&l.setAttribute("aria-hidden","true"),r.add(l),v.set(l,o+1))};d.length&&d[d.length-1].disconnect(),i(t);let u=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...n,...r].some(o=>o.contains(c.target))){for(let o of c.removedNodes)o instanceof Element&&(n.delete(o),r.delete(o));for(let o of c.addedNodes)(o instanceof HTMLElement||o instanceof SVGElement)&&(o.dataset.liveAnnouncer==="true"||o.dataset.reactAriaTopLayer==="true")?n.add(o):o instanceof Element&&i(o)}});u.observe(t,{childList:!0,subtree:!0});let f={visibleNodes:n,hiddenNodes:r,observe(){u.observe(t,{childList:!0,subtree:!0})},disconnect(){u.disconnect()}};return d.push(f),()=>{u.disconnect();for(let l of r){let c=v.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),v.delete(l)):v.set(l,c-1))}f===d[d.length-1]?(d.pop(),d.length&&d[d.length-1].observe()):d.splice(d.indexOf(f),1)}}function Z(e){let t=d[d.length-1];if(t&&!t.visibleNodes.has(e))return t.visibleNodes.add(e),()=>{t.visibleNodes.delete(e)}}const B=$.createContext({});function V(){var e;return(e=$.useContext(B))!==null&&e!==void 0?e:{}}const N=h.createContext(null);function ee(e){let t=R(),{portalContainer:n=t?null:document.body,isExiting:r}=e,[i,a]=$.useState(!1),u=$.useMemo(()=>({contain:i,setContain:a}),[i,a]),{getContainer:f}=V();if(!e.portalContainer&&f&&(n=f()),!n)return null;let l=e.children;return e.disableFocusManagement||(l=h.createElement(W,{restoreFocus:!0,contain:(e.shouldContainFocus||i)&&!r},l)),l=h.createElement(N.Provider,{value:u},h.createElement(I,null,l)),H.createPortal(l,n)}function D(){let e=$.useContext(N),t=e==null?void 0:e.setContain;S(()=>{t==null||t(!0)},[t])}function te(e,t){let{role:n="dialog"}=e,r=F();r=e["aria-label"]?void 0:r;let i=$.useRef(!1);return $.useEffect(()=>{if(t.current&&!t.current.contains(document.activeElement)){T(t.current);let a=setTimeout(()=>{document.activeElement===t.current&&(i.current=!0,t.current&&(t.current.blur(),T(t.current)),i.current=!1)},500);return()=>{clearTimeout(a)}}},[t]),D(),{dialogProps:{...A(e,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":e["aria-labelledby"]||r,onBlur:a=>{i.current&&a.stopPropagation()}},titleProps:{id:r}}}export{Q as $,Z as a,U as b,ee as c,te as d,D as e};
