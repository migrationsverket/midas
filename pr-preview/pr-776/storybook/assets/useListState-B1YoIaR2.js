import{$ as x,a as M,b as m}from"./SelectionManager-BJUqwE0x.js";import{r as v}from"./iframe-Cg0ufsuZ.js";class ${*[Symbol.iterator](){yield*this.iterable}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(l){let e=this.keyMap.get(l);var t;return e&&(t=e.prevKey)!==null&&t!==void 0?t:null}getKeyAfter(l){let e=this.keyMap.get(l);var t;return e&&(t=e.nextKey)!==null&&t!==void 0?t:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(l){var e;return(e=this.keyMap.get(l))!==null&&e!==void 0?e:null}at(l){const e=[...this.getKeys()];return this.getItem(e[l])}getChildren(l){let e=this.keyMap.get(l);return(e==null?void 0:e.childNodes)||[]}constructor(l){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=l;let e=n=>{if(this.keyMap.set(n.key,n),n.childNodes&&n.type==="section")for(let o of n.childNodes)e(o)};for(let n of l)e(n);let t=null,c=0,a=0;for(let[n,o]of this.keyMap)t?(t.nextKey=n,o.prevKey=t.key):(this.firstKey=n,o.prevKey=void 0),o.type==="item"&&(o.index=c++),(o.type==="section"||o.type==="item")&&a++,t=o,t.nextKey=void 0;this._size=a;var u;this.lastKey=(u=t==null?void 0:t.key)!==null&&u!==void 0?u:null}}function z(i){let{filter:l,layoutDelegate:e}=i,t=x(i),c=v.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),a=v.useCallback(K=>l?new $(l(K)):new $(K),[l]),u=v.useMemo(()=>({suppressTextValueWarning:i.suppressTextValueWarning}),[i.suppressTextValueWarning]),n=M(i,a,u),o=v.useMemo(()=>new m(n,t,{layoutDelegate:e}),[n,t,e]);return k(n,o),{collection:n,disabledKeys:c,selectionManager:o}}function C(i,l){let e=v.useMemo(()=>l?i.collection.filter(l):i.collection,[i.collection,l]),t=i.selectionManager.withCollection(e);return k(e,t),{collection:e,selectionManager:t,disabledKeys:i.disabledKeys}}function k(i,l){const e=v.useRef(null);v.useEffect(()=>{if(l.focusedKey!=null&&!i.getItem(l.focusedKey)&&e.current){const s=e.current.getItem(l.focusedKey),h=[...e.current.getKeys()].map(f=>{const r=e.current.getItem(f);return(r==null?void 0:r.type)==="item"?r:null}).filter(f=>f!==null),d=[...i.getKeys()].map(f=>{const r=i.getItem(f);return(r==null?void 0:r.type)==="item"?r:null}).filter(f=>f!==null);var t,c;const g=((t=h==null?void 0:h.length)!==null&&t!==void 0?t:0)-((c=d==null?void 0:d.length)!==null&&c!==void 0?c:0);var a,u,n;let y=Math.min(g>1?Math.max(((a=s==null?void 0:s.index)!==null&&a!==void 0?a:0)-g+1,0):(u=s==null?void 0:s.index)!==null&&u!==void 0?u:0,((n=d==null?void 0:d.length)!==null&&n!==void 0?n:0)-1),b=null,p=!1;for(;y>=0;){if(!l.isDisabled(d[y].key)){b=d[y];break}if(y<d.length-1&&!p)y++;else{p=!0;var o,K;y>((o=s==null?void 0:s.index)!==null&&o!==void 0?o:0)&&(y=(K=s==null?void 0:s.index)!==null&&K!==void 0?K:0),y--}}l.setFocusedKey(b?b.key:null)}e.current=i},[i,l])}export{z as $,C as a,$ as b};
