import{w as E,j as O,x as T,n as U,f as Q,a as _}from"./useFocusable-CI7IKKVh.js";import{r as l,R as m}from"./index-ClcD9ViR.js";import{$ as k}from"./Text-B5xeh108.js";function ie(t,e,a){let i=l.useRef(e),n=E(()=>{a&&a(i.current)});l.useEffect(()=>{var r;let o=t==null||(r=t.current)===null||r===void 0?void 0:r.form;return o==null||o.addEventListener("reset",n),()=>{o==null||o.removeEventListener("reset",n)}},[t,n])}const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},R={...M,customError:!0,valid:!1},$={isInvalid:!1,validationDetails:M,validationErrors:[]},A=l.createContext({}),L="__formValidationState"+Date.now();function re(t){if(t[L]){let{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:n,commitValidation:r}=t[L];return{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:n,commitValidation:r}}return q(t)}function q(t){let{isInvalid:e,validationState:a,name:i,value:n,builtinValidation:r,validate:o,validationBehavior:c="aria"}=t;a&&(e||(e=a==="invalid"));let d=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:R}:null,v=l.useMemo(()=>{if(!o||n==null)return null;let s=Y(o,n);return w(s)},[o,n]);r!=null&&r.validationDetails.valid&&(r=void 0);let u=l.useContext(A),f=l.useMemo(()=>i?Array.isArray(i)?i.flatMap(s=>I(u[s])):I(u[i]):[],[u,i]),[F,P]=l.useState(u),[S,V]=l.useState(!1);u!==F&&(P(u),V(!1));let p=l.useMemo(()=>w(S?[]:f),[S,f]),C=l.useRef($),[h,g]=l.useState($),b=l.useRef($),j=()=>{if(!N)return;x(!1);let s=v||r||C.current;y(s,b.current)||(b.current=s,g(s))},[N,x]=l.useState(!1);return l.useEffect(j),{realtimeValidation:d||p||v||r||$,displayValidation:c==="native"?d||p||h:d||p||v||r||h,updateValidation(s){c==="aria"&&!y(h,s)?g(s):C.current=s},resetValidation(){let s=$;y(s,b.current)||(b.current=s,g(s)),c==="native"&&x(!1),V(!0)},commitValidation(){c==="native"&&x(!0),V(!0)}}}function I(t){return t?Array.isArray(t)?t:[t]:[]}function Y(t,e){if(typeof t=="function"){let a=t(e);if(a&&typeof a!="boolean")return I(a)}return[]}function w(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:R}:null}function y(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((a,i)=>a===e.validationErrors[i])&&Object.entries(t.validationDetails).every(([a,i])=>e.validationDetails[a]===i)}function le(...t){let e=new Set,a=!1,i={...M};for(let o of t){var n,r;for(let c of o.validationErrors)e.add(c);a||(a=o.isInvalid);for(let c in i)(n=i)[r=c]||(n[r]=o.validationDetails[c])}return i.valid=!a,{isInvalid:a,validationErrors:[...e],validationDetails:i}}function ne(t,e,a){let{validationBehavior:i,focus:n}=t;O(()=>{if(i==="native"&&(a!=null&&a.current)){let d=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(d),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(G(a.current))}});let r=E(()=>{e.resetValidation()}),o=E(d=>{var v;e.displayValidation.isInvalid||e.commitValidation();let u=a==null||(v=a.current)===null||v===void 0?void 0:v.form;if(!d.defaultPrevented&&a&&u&&H(u)===a.current){var f;n?n():(f=a.current)===null||f===void 0||f.focus(),T("keyboard")}d.preventDefault()}),c=E(()=>{e.commitValidation()});l.useEffect(()=>{let d=a==null?void 0:a.current;if(!d)return;let v=d.form;return d.addEventListener("invalid",o),d.addEventListener("change",c),v==null||v.addEventListener("reset",r),()=>{d.removeEventListener("invalid",o),d.removeEventListener("change",c),v==null||v.removeEventListener("reset",r)}},[a,o,c,r,i])}function z(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function G(t){return{isInvalid:!t.validity.valid,validationDetails:z(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function H(t){for(let e=0;e<t.elements.length;e++){let a=t.elements[e];if(!a.validity.valid)return a}return null}const B=l.createContext(null);function J(t,e){let a=l.useContext(B);return a!=null&&a.isInvalid?m.createElement(K,{...t,ref:e}):null}const oe=l.forwardRef(J),K=l.forwardRef((t,e)=>{let a=l.useContext(B),i=U(t),n=Q({...t,defaultClassName:"react-aria-FieldError",defaultChildren:a.validationErrors.length===0?void 0:a.validationErrors.join(" "),values:a});return n.children==null?null:m.createElement(k,{slot:"errorMessage",...i,...n,ref:e})}),D=l.createContext(null);function W(t,e){[t,e]=_(t,e,D);let{validationErrors:a,validationBehavior:i="native",children:n,className:r,...o}=t;return m.createElement("form",{noValidate:i!=="native",...o,ref:e,className:r||"react-aria-Form"},m.createElement(D.Provider,{value:{...t,validationBehavior:i}},m.createElement(A.Provider,{value:a??{}},n)))}const de=l.forwardRef(W);export{de as $,re as a,ie as b,ne as c,D as d,B as e,oe as f,L as g,$ as h,le as i,M as j};
