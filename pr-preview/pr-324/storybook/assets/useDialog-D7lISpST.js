import{j as S,L as F,I as w,e as N,E as M,r as T,g as A}from"./useFocusable-eIx-4jzq.js";import{a as y}from"./useCollator-ACgtK5l-.js";import{r as $,R as h}from"./index-BbAIUH2N.js";import{$ as I}from"./PressResponder-gYjP6mWM.js";import{a as W}from"./FocusScope-BYskV0RP.js";import{$ as H}from"./index-cpIEhwLo.js";const g=typeof document<"u"&&window.visualViewport,_=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let E=0,x;function z(e={}){let{isDisabled:t}=e;S(()=>{if(!t)return E++,E===1&&(F()?x=k():x=P()),()=>{E--,E===0&&x()}},[t])}function P(){return w(m(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),m(document.documentElement,"overflow","hidden"))}function k(){let e,t,r=c=>{e=y(c.target,!0),!(e===document.documentElement&&e===document.body)&&e instanceof HTMLElement&&window.getComputedStyle(e).overscrollBehavior==="auto"&&(t=m(e,"overscrollBehavior","contain"))},o=c=>{if(!e||e===document.documentElement||e===document.body){c.preventDefault();return}e.scrollHeight===e.clientHeight&&e.scrollWidth===e.clientWidth&&c.preventDefault()},i=()=>{t&&t()},a=c=>{let n=c.target;O(n)&&(f(),n.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{n.style.transform="",g&&(g.height<window.innerHeight?requestAnimationFrame(()=>{C(n)}):g.addEventListener("resize",()=>C(n),{once:!0}))}))},d=null,f=()=>{if(d)return;let c=()=>{window.scrollTo(0,0)},n=window.pageXOffset,b=window.pageYOffset;d=w(p(window,"scroll",c),m(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),m(document.documentElement,"overflow","hidden"),m(document.body,"marginTop",`-${b}px`),()=>{window.scrollTo(n,b)}),window.scrollTo(0,0)},l=w(p(document,"touchstart",r,{passive:!1,capture:!0}),p(document,"touchmove",o,{passive:!1,capture:!0}),p(document,"touchend",i,{passive:!1,capture:!0}),p(document,"focus",a,!0));return()=>{t==null||t(),d==null||d(),l()}}function m(e,t,r){let o=e.style[t];return e.style[t]=r,()=>{e.style[t]=o}}function p(e,t,r,o){return e.addEventListener(t,r,o),()=>{e.removeEventListener(t,r,o)}}function C(e){let t=document.scrollingElement||document.documentElement,r=e;for(;r&&r!==t;){let o=y(r);if(o!==document.documentElement&&o!==document.body&&o!==r){let i=o.getBoundingClientRect().top,a=r.getBoundingClientRect().top;a>i+r.clientHeight&&(o.scrollTop+=a-i)}r=o.parentElement}}function O(e){return e instanceof HTMLInputElement&&!_.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}let v=new WeakMap,u=[];function G(e,t=document.body){let r=new Set(e),o=new Set,i=l=>{for(let s of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))r.add(s);let c=s=>{if(r.has(s)||s.parentElement&&o.has(s.parentElement)&&s.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let R of r)if(s.contains(R))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},n=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),b=c(l);if(b===NodeFilter.FILTER_ACCEPT&&a(l),b!==NodeFilter.FILTER_REJECT){let s=n.nextNode();for(;s!=null;)a(s),s=n.nextNode()}},a=l=>{var c;let n=(c=v.get(l))!==null&&c!==void 0?c:0;l.getAttribute("aria-hidden")==="true"&&n===0||(n===0&&l.setAttribute("aria-hidden","true"),o.add(l),v.set(l,n+1))};u.length&&u[u.length-1].disconnect(),i(t);let d=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...r,...o].some(n=>n.contains(c.target))){for(let n of c.removedNodes)n instanceof Element&&(r.delete(n),o.delete(n));for(let n of c.addedNodes)(n instanceof HTMLElement||n instanceof SVGElement)&&(n.dataset.liveAnnouncer==="true"||n.dataset.reactAriaTopLayer==="true")?r.add(n):n instanceof Element&&i(n)}});d.observe(t,{childList:!0,subtree:!0});let f={observe(){d.observe(t,{childList:!0,subtree:!0})},disconnect(){d.disconnect()}};return u.push(f),()=>{d.disconnect();for(let l of o){let c=v.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),v.delete(l)):v.set(l,c-1))}f===u[u.length-1]?(u.pop(),u.length&&u[u.length-1].observe()):u.splice(u.indexOf(f),1)}}const B=$.createContext({});function V(){var e;return(e=$.useContext(B))!==null&&e!==void 0?e:{}}const L=h.createContext(null);function Q(e){let t=N(),{portalContainer:r=t?null:document.body,isExiting:o}=e,[i,a]=$.useState(!1),d=$.useMemo(()=>({contain:i,setContain:a}),[i,a]),{getContainer:f}=V();if(!e.portalContainer&&f&&(r=f()),!r)return null;let l=e.children;return e.disableFocusManagement||(l=h.createElement(W,{restoreFocus:!0,contain:i&&!o},l)),l=h.createElement(L.Provider,{value:d},h.createElement(I,null,l)),H.createPortal(l,r)}function D(){let e=$.useContext(L),t=e==null?void 0:e.setContain;S(()=>{t==null||t(!0)},[t])}function U(e,t){let{role:r="dialog"}=e,o=M();o=e["aria-label"]?void 0:o;let i=$.useRef(!1);return $.useEffect(()=>{if(t.current&&!t.current.contains(document.activeElement)){T(t.current);let a=setTimeout(()=>{document.activeElement===t.current&&(i.current=!0,t.current&&(t.current.blur(),T(t.current)),i.current=!1)},500);return()=>{clearTimeout(a)}}},[t]),D(),{dialogProps:{...A(e,{labelable:!0}),role:r,tabIndex:-1,"aria-labelledby":e["aria-labelledby"]||o,onBlur:a=>{i.current&&a.stopPropagation()}},titleProps:{id:o}}}export{z as $,G as a,Q as b,U as c,D as d};
